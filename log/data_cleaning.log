2024-12-02 09:27:43,852 - WARNING - Progress file progress.json not found. Starting from the beginning.
2024-12-02 09:27:43,934 - INFO - Loaded data from row 0.
2024-12-02 09:27:43,934 - INFO - Columns in DataFrame: ['record_number', 'region', 'residence_type', 'family_composition', 'sex', 'age', 'marital_status', 'student', 'country_of_birth', 'health', 'ethnic_group', 'religion', 'economic_activity', 'occupation', 'industry', 'hours_worked_per_week', 'approximate_social_grade']
2024-12-02 09:43:11,459 - WARNING - Progress file progress.json not found. Starting from the beginning.
2024-12-02 09:43:11,525 - INFO - Loaded data from row 0.
2024-12-02 09:43:11,525 - INFO - Columns in DataFrame: ['record_number', 'region', 'residence_type', 'family_composition', 'sex', 'age', 'marital_status', 'student', 'country_of_birth', 'health', 'ethnic_group', 'religion', 'economic_activity', 'occupation', 'industry', 'hours_worked_per_week', 'approximate_social_grade']
2024-12-02 09:46:05,389 - WARNING - Progress file progress.json not found. Starting from the beginning.
2024-12-02 09:46:05,458 - INFO - Loaded data from row 0.
2024-12-02 09:46:05,458 - INFO - Columns in DataFrame: ['record_number', 'region', 'residence_type', 'family_composition', 'sex', 'age', 'marital_status', 'student', 'country_of_birth', 'health', 'ethnic_group', 'religion', 'economic_activity', 'occupation', 'industry', 'hours_worked_per_week', 'approximate_social_grade']
2024-12-02 09:48:14,373 - WARNING - Progress file progress.json not found. Starting from the beginning.
2024-12-02 09:48:14,454 - INFO - Loaded data from row 0.
2024-12-02 09:48:14,454 - INFO - Columns in DataFrame: ['record_number', 'region', 'residence_type', 'family_composition', 'sex', 'age', 'marital_status', 'student', 'country_of_birth', 'health', 'ethnic_group', 'religion', 'economic_activity', 'occupation', 'industry', 'hours_worked_per_week', 'approximate_social_grade']
2024-12-02 09:51:45,723 - WARNING - Progress file progress.json not found. Starting from the beginning.
2024-12-02 09:51:45,791 - INFO - Loaded data from row 0.
2024-12-02 09:51:45,791 - INFO - Columns in DataFrame: ['record_number', 'region', 'residence_type', 'family_composition', 'sex', 'age', 'marital_status', 'student', 'country_of_birth', 'health', 'ethnic_group', 'religion', 'economic_activity', 'occupation', 'industry', 'hours_worked_per_week', 'approximate_social_grade']
2024-12-02 09:54:27,085 - WARNING - Progress file progress.json not found. Starting from the beginning.
2024-12-02 09:54:27,150 - INFO - Loaded data from row 0.
2024-12-02 09:54:27,150 - INFO - Columns in DataFrame: ['record_number', 'region', 'residence_type', 'family_composition', 'sex', 'age', 'marital_status', 'student', 'country_of_birth', 'health', 'ethnic_group', 'religion', 'economic_activity', 'occupation', 'industry', 'hours_worked_per_week', 'approximate_social_grade']
2024-12-02 09:58:53,676 - WARNING - Progress file progress.json not found. Starting from the beginning.
2024-12-02 09:58:53,754 - INFO - Loaded data from row 0.
2024-12-02 09:58:53,754 - INFO - Columns in DataFrame: ['record_number', 'region', 'residence_type', 'family_composition', 'sex', 'age', 'marital_status', 'student', 'country_of_birth', 'health', 'ethnic_group', 'religion', 'economic_activity', 'occupation', 'industry', 'hours_worked_per_week', 'approximate_social_grade']
2024-12-02 09:58:53,754 - WARNING - Progress file progress.json not found. Starting from the beginning.
2024-12-02 09:58:53,808 - INFO - =====Checking data types:=====
2024-12-02 09:58:53,830 - INFO - Batch info:
None
2024-12-02 09:58:54,087 - INFO - =====Checking for missing value:=====
2024-12-02 09:58:54,105 - WARNING - Missing values detected:
Record_Number               0
Region                      0
RESIDENCE_TYPE              0
Family_Composition          0
sex                         0
age                         0
Marital_Status              0
student                     0
Country_Of_Birth            0
health                      0
Ethnic_Group                0
religion                    0
Economic_Activity           0
Occupation                  0
industry                    0
Hours_Worked_Per_Week       0
Approximate_Social_Grade    5
dtype: int64
2024-12-02 09:58:54,124 - WARNING - Column 'approximate_social_grade': missing values at indices [1, 27, 29, 42273, 42441]
2024-12-02 09:58:54,143 - INFO - Rows to drop:
       record_number     region residence_type family_composition  sex  age  marital_status  student  country_of_birth  health  ethnic_group  religion economic_activity occupation industry hours_worked_per_week approximate_social_grade
1                  2  S92000003              P                  0    1    3               1        2                 1       2             1         1                 1          1        8                     3                      NaN
27                27  S92000003              P                  1    2    4               2        2                 1       2             2         2                 1          6       11                     4                      NaN
29                29  S92000003              P                  2    6    2               2        1                 2       1             2         1                 6          4        2                     3                      NaN
42273          42273  S92000003              C                  X    1    6               1        2                 1       3             1         2                 X          X        X                     X                      NaN
42441          42441  S92000003              C                  X    2    8               5        1                 2       1             9         5                 X          X        X                     X                      NaN
2024-12-02 09:58:54,143 - INFO - =====Checking for duplicate rows:=====
2024-12-02 09:58:54,166 - ERROR - Failed! 1 duplicate rows detected.
2024-12-02 09:58:54,166 - INFO - 
Duplicate rows:
2024-12-02 09:58:54,191 - INFO -    record_number     region residence_type family_composition  sex  age  marital_status  student  country_of_birth  health  ethnic_group  religion economic_activity occupation industry hours_worked_per_week approximate_social_grade
5              5  S92000003              P                  4    2    4               4        2                 1       2             1         1                 1          3       11                     3                        2
2024-12-02 09:58:54,191 - INFO - =====Verifying 'record_number' uniqueness:=====
2024-12-02 09:58:54,191 - INFO - Columns in batch: ['record_number', 'region', 'residence_type', 'family_composition', 'sex', 'age', 'marital_status', 'student', 'country_of_birth', 'health', 'ethnic_group', 'religion', 'economic_activity', 'occupation', 'industry', 'hours_worked_per_week', 'approximate_social_grade']
2024-12-02 09:58:54,193 - ERROR - Failed! 'record_number' is not unique. Duplicate record numbers: [5]
2024-12-02 09:58:54,193 - INFO - 
Duplicate rows:
2024-12-02 09:58:54,196 - INFO -    record_number     region residence_type family_composition  sex  age  marital_status  student  country_of_birth  health  ethnic_group  religion economic_activity occupation industry hours_worked_per_week approximate_social_grade
5              5  S92000003              P                  4    2    4               4        2                 1       2             1         1                 1          3       11                     3                        2
2024-12-02 09:58:54,196 - INFO - =====validate_data_ranges:=====
2024-12-02 09:58:54,280 - INFO - 
Broken records in column 'sex':
2024-12-02 09:58:54,280 - INFO -     sex
29    6
2024-12-02 09:58:54,281 - ERROR - Failed! Column 'sex' contains invalid values: [6]
2024-12-02 09:58:54,523 - INFO - 
Broken records in column 'ethnic_group':
2024-12-02 09:58:54,524 - INFO -        ethnic_group
42441             9
2024-12-02 09:58:54,525 - ERROR - Failed! Column 'ethnic_group' contains invalid values: [9]
2024-12-02 09:58:54,672 - INFO - 
Broken records in column 'approximate_social_grade':
2024-12-02 09:58:54,673 - INFO -       approximate_social_grade
0                           11
1                          NaN
27                         NaN
29                         NaN
42273                      NaN
42441                      NaN
2024-12-02 09:58:54,673 - ERROR - Failed! Column 'approximate_social_grade' contains invalid values: ['11', nan]
2024-12-02 09:58:54,674 - INFO - 
Unique categories and counts per column:
2024-12-02 09:58:54,674 - INFO - residence_type: ['P', 'C'] (Total unique: 2)
2024-12-02 09:58:54,674 - INFO - family_composition: ['5', '2', '3', '4', 'X', '1', '0'] (Total unique: 7)
2024-12-02 09:58:54,674 - INFO - sex: [1, 2, 6] (Total unique: 3)
2024-12-02 09:58:54,674 - INFO - age: [1, 2, 3, 4, 5, 6, 7, 8] (Total unique: 8)
2024-12-02 09:58:54,674 - INFO - marital_status: [1, 2, 3, 4, 5] (Total unique: 5)
2024-12-02 09:58:54,674 - INFO - student: [1, 2] (Total unique: 2)
2024-12-02 09:58:54,674 - INFO - country_of_birth: [1, 2] (Total unique: 2)
2024-12-02 09:58:54,674 - INFO - health: [1, 2, 3, 4, 5] (Total unique: 5)
2024-12-02 09:58:54,674 - INFO - ethnic_group: [1, 2, 3, 4, 5, 6, 9] (Total unique: 7)
2024-12-02 09:58:54,674 - INFO - religion: [1, 2, 3, 4, 5, 6, 7, 8, 9] (Total unique: 9)
2024-12-02 09:58:54,674 - INFO - economic_activity: ['6', '7', '5', '2', '8', '9', '3', '4', 'X', '1'] (Total unique: 10)
2024-12-02 09:58:54,674 - INFO - occupation: ['6', '7', '5', '2', '8', '3', '9', '4', 'X', '1'] (Total unique: 10)
2024-12-02 09:58:54,674 - INFO - industry: ['6', '7', '8', '5', '2', '11', '10', '9', '3', '13', '4', 'X', '12', '1'] (Total unique: 14)
2024-12-02 09:58:54,674 - INFO - hours_worked_per_week: ['2', '3', '4', 'X', '1'] (Total unique: 5)
2024-12-02 09:58:54,674 - INFO - approximate_social_grade: ['2', '11', '3', '4', 'X', '1'] (Total unique: 6)
2024-12-02 09:58:54,674 - INFO - Starting data cleaning process...
2024-12-02 09:58:54,730 - INFO - Processing batch 1...
2024-12-02 09:58:54,730 - INFO - =====Checking for duplicate rows:=====
2024-12-02 09:58:54,761 - ERROR - Failed! 1 duplicate rows detected.
2024-12-02 09:58:54,761 - INFO - 
Duplicate rows:
2024-12-02 09:58:54,787 - INFO -    record_number     region residence_type family_composition  sex  age  marital_status  student  country_of_birth  health  ethnic_group  religion economic_activity occupation industry hours_worked_per_week approximate_social_grade
5              5  S92000003              P                  4    2    4               4        2                 1       2             1         1                 1          3       11                     3                        2
2024-12-02 09:58:54,796 - INFO - Total rows in file: 63390
2024-12-02 09:58:54,811 - INFO - llllllllllll        record_number     region residence_type family_composition  ...  occupation  industry  hours_worked_per_week  approximate_social_grade
21                21  S92000003              P                  5  ...           X         X                      X                         2
29                29  S92000003              P                  2  ...           4         2                      3                       NaN
48                48  S92000003              P                  0  ...           X         X                      X                         2
49                49  S92000003              P                  0  ...           2         8                      X                         2
86                86  S92000003              P                  1  ...           X         X                      X                         1
...              ...        ...            ...                ...  ...         ...       ...                    ...                       ...
63296          63296  S92000003              P                  1  ...           7         4                      X                         2
63318          63318  S92000003              P                  0  ...           X         X                      X                         2
63351          63351  S92000003              P                  1  ...           X         X                      X                         4
63367          63367  S92000003              P                  4  ...           X         X                      X                         2
63384          63384  S92000003              P                  1  ...           X         X                      X                         3

[2600 rows x 17 columns]
2024-12-02 09:58:54,824 - INFO - Rule 1: Found 2600 rows to delete, saved to data/rule_1_deleted_data.csv
2024-12-02 09:58:54,830 - INFO - Rule 2: No rows to delete
2024-12-02 09:58:54,948 - INFO - Rule 3: Found 842 rows to delete, saved to data/rule_3_deleted_data.csv
2024-12-02 09:58:54,985 - INFO - Rule 4: Found 2362 rows to delete, saved to data/rule_4_deleted_data.csv
2024-12-02 09:58:54,991 - INFO - Rule 5: No rows to delete
2024-12-02 09:58:55,004 - INFO - Rule 6: Found 842 rows to delete, saved to data/rule_6_deleted_data.csv
2024-12-02 09:58:55,016 - INFO - 'record_number' column reset.
2024-12-02 09:58:55,206 - INFO - Progress saved to /cs/home/sz92/Documents/CS5002/P3/code/progress.json.
2024-12-02 09:58:55,207 - INFO - Data cleaning process completed. Total rows processed: 63389
2024-12-02 09:58:55,207 - INFO - Rows to drop: 5299
2024-12-02 09:58:55,207 - INFO - Cleaned data saved to ../data/output.csv
2024-12-02 09:58:55,207 - INFO - Progress file removed. Data processing complete.
2024-12-02 10:59:33,733 - WARNING - Progress file progress.json not found. Starting from the beginning.
2024-12-02 10:59:33,807 - INFO - Loaded data from row 0.
2024-12-02 10:59:33,807 - INFO - Columns in DataFrame: ['record_number', 'region', 'residence_type', 'family_composition', 'sex', 'age', 'marital_status', 'student', 'country_of_birth', 'health', 'ethnic_group', 'religion', 'economic_activity', 'occupation', 'industry', 'hours_worked_per_week', 'approximate_social_grade']
2024-12-02 10:59:33,819 - INFO - =====Checking data types:=====
2024-12-02 10:59:33,835 - INFO - Batch info:
None
2024-12-02 10:59:33,885 - INFO - =====Checking for missing value:=====
2024-12-02 10:59:33,890 - WARNING - Missing values detected:
Record_Number               0
Region                      0
RESIDENCE_TYPE              0
Family_Composition          0
sex                         0
age                         0
Marital_Status              0
student                     0
Country_Of_Birth            0
health                      0
Ethnic_Group                0
religion                    0
Economic_Activity           0
Occupation                  0
industry                    0
Hours_Worked_Per_Week       0
Approximate_Social_Grade    3
dtype: int64
2024-12-02 10:59:33,895 - WARNING - Column 'approximate_social_grade': missing values at indices [1, 27, 29]
2024-12-02 10:59:33,902 - INFO - Rows to drop:
    record_number     region residence_type family_composition  sex  age  marital_status  student  country_of_birth  health  ethnic_group  religion economic_activity occupation industry hours_worked_per_week approximate_social_grade
1               2  S92000003              P                  0    1    3               1        2                 1       2             1         1                 1          1        8                     3                      NaN
27             27  S92000003              P                  1    2    4               2        2                 1       2             2         2                 1          6       11                     4                      NaN
29             29  S92000003              P                  2    6    2               2        1                 2       1             2         1                 6          4        2                     3                      NaN
2024-12-02 10:59:33,911 - INFO - =====Checking for duplicate rows:=====
2024-12-02 10:59:33,917 - ERROR - Failed! 1 duplicate rows detected.
2024-12-02 10:59:33,917 - INFO - 
Duplicate rows:
2024-12-02 10:59:33,923 - INFO -    record_number     region residence_type family_composition  sex  age  marital_status  student  country_of_birth  health  ethnic_group  religion economic_activity occupation industry hours_worked_per_week approximate_social_grade
5              5  S92000003              P                  4    2    4               4        2                 1       2             1         1                 1          3       11                     3                        2
2024-12-02 10:59:33,932 - INFO - =====Verifying 'record_number' uniqueness:=====
2024-12-02 10:59:33,932 - INFO - Columns in batch: ['record_number', 'region', 'residence_type', 'family_composition', 'sex', 'age', 'marital_status', 'student', 'country_of_birth', 'health', 'ethnic_group', 'religion', 'economic_activity', 'occupation', 'industry', 'hours_worked_per_week', 'approximate_social_grade']
2024-12-02 10:59:33,935 - ERROR - Failed! 'record_number' is not unique. Duplicate record numbers: [5]
2024-12-02 10:59:33,935 - INFO - 
Duplicate rows:
2024-12-02 10:59:33,938 - INFO -    record_number     region residence_type family_composition  sex  age  marital_status  student  country_of_birth  health  ethnic_group  religion economic_activity occupation industry hours_worked_per_week approximate_social_grade
5              5  S92000003              P                  4    2    4               4        2                 1       2             1         1                 1          3       11                     3                        2
2024-12-02 10:59:33,946 - INFO - =====validate_data_ranges:=====
2024-12-02 10:59:33,962 - INFO - 
Broken records in column 'sex':
2024-12-02 10:59:33,963 - INFO -     sex
29    6
2024-12-02 10:59:33,963 - ERROR - Failed! Column 'sex' contains invalid values: [6]
2024-12-02 10:59:34,021 - INFO - 
Broken records in column 'approximate_social_grade':
2024-12-02 10:59:34,022 - INFO -    approximate_social_grade
0                        11
1                       NaN
27                      NaN
29                      NaN
2024-12-02 10:59:34,022 - ERROR - Failed! Column 'approximate_social_grade' contains invalid values: ['11', nan]
2024-12-02 10:59:34,022 - INFO - 
Unique categories and counts per column:
2024-12-02 10:59:34,022 - INFO - residence_type: ['C', 'P'] (Total unique: 2)
2024-12-02 10:59:34,022 - INFO - family_composition: ['5', '2', 'X', '4', '1', '0', '3'] (Total unique: 7)
2024-12-02 10:59:34,022 - INFO - sex: [1, 2, 6] (Total unique: 3)
2024-12-02 10:59:34,022 - INFO - age: [1, 2, 3, 4, 5, 6, 7, 8] (Total unique: 8)
2024-12-02 10:59:34,022 - INFO - marital_status: [1, 2, 3, 4, 5] (Total unique: 5)
2024-12-02 10:59:34,022 - INFO - student: [1, 2] (Total unique: 2)
2024-12-02 10:59:34,022 - INFO - country_of_birth: [1, 2] (Total unique: 2)
2024-12-02 10:59:34,022 - INFO - health: [1, 2, 3, 4, 5] (Total unique: 5)
2024-12-02 10:59:34,022 - INFO - ethnic_group: [1, 2, 3, 4, 5, 6] (Total unique: 6)
2024-12-02 10:59:34,022 - INFO - religion: [1, 2, 3, 4, 5, 6, 7, 8, 9] (Total unique: 9)
2024-12-02 10:59:34,022 - INFO - economic_activity: ['7', '8', '9', '5', '6', '2', 'X', '4', '1', '3'] (Total unique: 10)
2024-12-02 10:59:34,022 - INFO - occupation: ['7', '8', '9', '5', '6', '2', 'X', '4', '1', '3'] (Total unique: 10)
2024-12-02 10:59:34,022 - INFO - industry: ['10', '7', '11', '8', '13', '9', '5', '6', '2', 'X', '4', '12', '1', '3'] (Total unique: 14)
2024-12-02 10:59:34,022 - INFO - hours_worked_per_week: ['2', 'X', '4', '1', '3'] (Total unique: 5)
2024-12-02 10:59:34,022 - INFO - approximate_social_grade: ['11', '2', 'X', '4', '1', '3'] (Total unique: 6)
2024-12-02 10:59:34,037 - INFO - llllllllllll       record_number     region residence_type family_composition  sex  age  \
21               21  S92000003              P                  5    2    2   
29               29  S92000003              P                  2    6    2   
48               48  S92000003              P                  0    1    2   
49               49  S92000003              P                  0    1    3   
86               86  S92000003              P                  1    1    2   
...             ...        ...            ...                ...  ...  ...   
8819           8819  S92000003              P                  1    2    2   
8876           8876  S92000003              P                  1    2    2   
8887           8887  S92000003              P                  4    2    2   
8907           8907  S92000003              P                  4    1    2   
8931           8931  S92000003              P                  1    1    2   

      marital_status  student  country_of_birth  health  ethnic_group  \
21                 1        1                 2       2             1   
29                 2        1                 2       1             2   
48                 1        1                 2       1             1   
49                 2        1                 2       1             4   
86                 1        1                 2       1             1   
...              ...      ...               ...     ...           ...   
8819               1        1                 1       1             1   
8876               1        1                 2       1             1   
8887               1        1                 1       1             1   
8907               1        1                 1       1             1   
8931               1        1                 1       1             1   

      religion economic_activity occupation industry hours_worked_per_week  \
21           2                 6          X        X                     X   
29           1                 6          4        2                     3   
48           1                 6          X        X                     X   
49           2                 6          2        8                     X   
86           2                 6          X        X                     X   
...        ...               ...        ...      ...                   ...   
8819         2                 6          X        X                     X   
8876         1                 6          X        X                     X   
8887         1                 6          X        X                     X   
8907         2                 6          X        X                     X   
8931         1                 6          7        4                     X   

     approximate_social_grade  
21                          2  
29                        NaN  
48                          2  
49                          2  
86                          1  
...                       ...  
8819                        4  
8876                        2  
8887                        1  
8907                        4  
8931                        2  

[373 rows x 17 columns]
2024-12-02 10:59:34,042 - INFO - Rule 1: Found 373 rows to delete, saved to data/rule_1_deleted_data.csv
2024-12-02 10:59:34,044 - INFO - Rule 2: No rows to delete
2024-12-02 10:59:34,049 - INFO - Rule 3: Found 123 rows to delete, saved to data/rule_3_deleted_data.csv
2024-12-02 10:59:34,055 - INFO - Rule 4: Found 326 rows to delete, saved to data/rule_4_deleted_data.csv
2024-12-02 10:59:34,059 - INFO - Rule 5: No rows to delete
2024-12-02 10:59:34,067 - INFO - Rule 6: Found 123 rows to delete, saved to data/rule_6_deleted_data.csv
2024-12-02 10:59:34,085 - INFO - Starting data cleaning process...
2024-12-02 10:59:34,144 - INFO - Processing batch 1...
2024-12-02 10:59:34,144 - INFO - =====Checking for duplicate rows:=====
2024-12-02 10:59:34,170 - ERROR - Failed! 1 duplicate rows detected.
2024-12-02 10:59:34,170 - INFO - 
Duplicate rows:
2024-12-02 10:59:34,196 - INFO -    record_number     region residence_type family_composition  sex  age  marital_status  student  country_of_birth  health  ethnic_group  religion economic_activity occupation industry hours_worked_per_week approximate_social_grade
5              5  S92000003              P                  4    2    4               4        2                 1       2             1         1                 1          3       11                     3                        2
2024-12-02 10:59:34,205 - INFO - Total rows in file: 63390
2024-12-02 10:59:34,212 - INFO - llllllllllll        record_number     region residence_type family_composition  sex  age  \
21                21  S92000003              P                  5    2    2   
29                29  S92000003              P                  2    6    2   
48                48  S92000003              P                  0    1    2   
49                49  S92000003              P                  0    1    3   
86                86  S92000003              P                  1    1    2   
...              ...        ...            ...                ...  ...  ...   
63296          63296  S92000003              P                  1    1    2   
63318          63318  S92000003              P                  0    2    2   
63351          63351  S92000003              P                  1    1    2   
63367          63367  S92000003              P                  4    2    2   
63384          63384  S92000003              P                  1    1    2   

       marital_status  student  country_of_birth  health  ethnic_group  \
21                  1        1                 2       2             1   
29                  2        1                 2       1             2   
48                  1        1                 2       1             1   
49                  2        1                 2       1             4   
86                  1        1                 2       1             1   
...               ...      ...               ...     ...           ...   
63296               1        1                 1       1             1   
63318               1        1                 2       2             3   
63351               1        1                 1       1             1   
63367               1        1                 1       1             1   
63384               1        1                 1       1             1   

       religion economic_activity occupation industry hours_worked_per_week  \
21            2                 6          X        X                     X   
29            1                 6          4        2                     3   
48            1                 6          X        X                     X   
49            2                 6          2        8                     X   
86            2                 6          X        X                     X   
...         ...               ...        ...      ...                   ...   
63296         2                 6          7        4                     X   
63318         1                 6          X        X                     X   
63351         1                 6          X        X                     X   
63367         1                 6          X        X                     X   
63384         2                 6          X        X                     X   

      approximate_social_grade  
21                           2  
29                         NaN  
48                           2  
49                           2  
86                           1  
...                        ...  
63296                        2  
63318                        2  
63351                        4  
63367                        2  
63384                        3  

[2600 rows x 17 columns]
2024-12-02 10:59:34,249 - INFO - Rule 1: Found 2600 rows to delete, saved to data/rule_1_deleted_data.csv
2024-12-02 10:59:34,271 - INFO - Rule 2: No rows to delete
2024-12-02 10:59:34,290 - INFO - Rule 3: Found 842 rows to delete, saved to data/rule_3_deleted_data.csv
2024-12-02 10:59:34,308 - INFO - Rule 4: Found 2362 rows to delete, saved to data/rule_4_deleted_data.csv
2024-12-02 10:59:34,319 - INFO - Rule 5: No rows to delete
2024-12-02 10:59:34,335 - INFO - Rule 6: Found 842 rows to delete, saved to data/rule_6_deleted_data.csv
2024-12-02 10:59:34,351 - INFO - 'record_number' column reset.
2024-12-02 10:59:34,524 - INFO - Progress saved to /cs/home/sz92/Documents/CS5002/P3/notebooks/progress.json.
2024-12-02 10:59:34,524 - INFO - Data cleaning process completed. Total rows processed: 63389
2024-12-02 10:59:34,524 - INFO - Rows to drop: 5299
2024-12-02 10:59:34,525 - INFO - Cleaned data saved to ../data/output.csv
2024-12-02 10:59:34,525 - INFO - Progress file removed. Data processing complete.
2024-12-02 11:02:16,459 - WARNING - Progress file progress.json not found. Starting from the beginning.
2024-12-02 11:02:16,538 - INFO - Loaded data from row 0.
2024-12-02 11:02:16,538 - INFO - Columns in DataFrame: ['record_number', 'region', 'residence_type', 'family_composition', 'sex', 'age', 'marital_status', 'student', 'country_of_birth', 'health', 'ethnic_group', 'religion', 'economic_activity', 'occupation', 'industry', 'hours_worked_per_week', 'approximate_social_grade']
2024-12-02 11:02:16,538 - WARNING - Progress file progress.json not found. Starting from the beginning.
2024-12-02 11:02:16,593 - INFO - =====Checking data types:=====
2024-12-02 11:02:16,614 - INFO - Batch info:
None
2024-12-02 11:02:16,872 - INFO - =====Checking for missing value:=====
2024-12-02 11:02:16,891 - WARNING - Missing values detected:
Record_Number               0
Region                      0
RESIDENCE_TYPE              0
Family_Composition          0
sex                         0
age                         0
Marital_Status              0
student                     0
Country_Of_Birth            0
health                      0
Ethnic_Group                0
religion                    0
Economic_Activity           0
Occupation                  0
industry                    0
Hours_Worked_Per_Week       0
Approximate_Social_Grade    5
dtype: int64
2024-12-02 11:02:16,911 - WARNING - Column 'approximate_social_grade': missing values at indices [1, 27, 29, 42273, 42441]
2024-12-02 11:02:16,930 - INFO - Rows to drop:
       record_number     region residence_type family_composition  sex  age  marital_status  student  country_of_birth  health  ethnic_group  religion economic_activity occupation industry hours_worked_per_week approximate_social_grade
1                  2  S92000003              P                  0    1    3               1        2                 1       2             1         1                 1          1        8                     3                      NaN
27                27  S92000003              P                  1    2    4               2        2                 1       2             2         2                 1          6       11                     4                      NaN
29                29  S92000003              P                  2    6    2               2        1                 2       1             2         1                 6          4        2                     3                      NaN
42273          42273  S92000003              C                  X    1    6               1        2                 1       3             1         2                 X          X        X                     X                      NaN
42441          42441  S92000003              C                  X    2    8               5        1                 2       1             9         5                 X          X        X                     X                      NaN
2024-12-02 11:02:16,930 - INFO - =====Checking for duplicate rows:=====
2024-12-02 11:02:16,953 - ERROR - Failed! 1 duplicate rows detected.
2024-12-02 11:02:16,953 - INFO - 
Duplicate rows:
2024-12-02 11:02:16,979 - INFO -    record_number     region residence_type family_composition  sex  age  marital_status  student  country_of_birth  health  ethnic_group  religion economic_activity occupation industry hours_worked_per_week approximate_social_grade
5              5  S92000003              P                  4    2    4               4        2                 1       2             1         1                 1          3       11                     3                        2
2024-12-02 11:02:16,979 - INFO - =====Verifying 'record_number' uniqueness:=====
2024-12-02 11:02:16,979 - INFO - Columns in batch: ['record_number', 'region', 'residence_type', 'family_composition', 'sex', 'age', 'marital_status', 'student', 'country_of_birth', 'health', 'ethnic_group', 'religion', 'economic_activity', 'occupation', 'industry', 'hours_worked_per_week', 'approximate_social_grade']
2024-12-02 11:02:16,981 - ERROR - Failed! 'record_number' is not unique. Duplicate record numbers: [5]
2024-12-02 11:02:16,981 - INFO - 
Duplicate rows:
2024-12-02 11:02:16,984 - INFO -    record_number     region residence_type family_composition  sex  age  marital_status  student  country_of_birth  health  ethnic_group  religion economic_activity occupation industry hours_worked_per_week approximate_social_grade
5              5  S92000003              P                  4    2    4               4        2                 1       2             1         1                 1          3       11                     3                        2
2024-12-02 11:02:16,984 - INFO - =====validate_data_ranges:=====
2024-12-02 11:02:17,067 - INFO - 
Broken records in column 'sex':
2024-12-02 11:02:17,068 - INFO -     sex
29    6
2024-12-02 11:02:17,068 - ERROR - Failed! Column 'sex' contains invalid values: [6]
2024-12-02 11:02:17,323 - INFO - 
Broken records in column 'ethnic_group':
2024-12-02 11:02:17,324 - INFO -        ethnic_group
42441             9
2024-12-02 11:02:17,324 - ERROR - Failed! Column 'ethnic_group' contains invalid values: [9]
2024-12-02 11:02:17,478 - INFO - 
Broken records in column 'approximate_social_grade':
2024-12-02 11:02:17,479 - INFO -       approximate_social_grade
0                           11
1                          NaN
27                         NaN
29                         NaN
42273                      NaN
42441                      NaN
2024-12-02 11:02:17,480 - ERROR - Failed! Column 'approximate_social_grade' contains invalid values: ['11', nan]
2024-12-02 11:02:17,480 - INFO - 
Unique categories and counts per column:
2024-12-02 11:02:17,480 - INFO - residence_type: ['C', 'P'] (Total unique: 2)
2024-12-02 11:02:17,480 - INFO - family_composition: ['3', '0', '4', '1', 'X', '5', '2'] (Total unique: 7)
2024-12-02 11:02:17,480 - INFO - sex: [1, 2, 6] (Total unique: 3)
2024-12-02 11:02:17,480 - INFO - age: [1, 2, 3, 4, 5, 6, 7, 8] (Total unique: 8)
2024-12-02 11:02:17,480 - INFO - marital_status: [1, 2, 3, 4, 5] (Total unique: 5)
2024-12-02 11:02:17,480 - INFO - student: [1, 2] (Total unique: 2)
2024-12-02 11:02:17,480 - INFO - country_of_birth: [1, 2] (Total unique: 2)
2024-12-02 11:02:17,480 - INFO - health: [1, 2, 3, 4, 5] (Total unique: 5)
2024-12-02 11:02:17,480 - INFO - ethnic_group: [1, 2, 3, 4, 5, 6, 9] (Total unique: 7)
2024-12-02 11:02:17,480 - INFO - religion: [1, 2, 3, 4, 5, 6, 7, 8, 9] (Total unique: 9)
2024-12-02 11:02:17,480 - INFO - economic_activity: ['3', '2', '7', '8', '4', '1', 'X', '9', '5', '6'] (Total unique: 10)
2024-12-02 11:02:17,480 - INFO - occupation: ['3', '7', '8', '4', '6', '1', 'X', '9', '5', '2'] (Total unique: 10)
2024-12-02 11:02:17,480 - INFO - industry: ['11', '3', '13', '12', '7', '8', '4', '6', '1', 'X', '9', '10', '5', '2'] (Total unique: 14)
2024-12-02 11:02:17,480 - INFO - hours_worked_per_week: ['3', '4', '1', 'X', '2'] (Total unique: 5)
2024-12-02 11:02:17,480 - INFO - approximate_social_grade: ['11', '3', '4', '1', 'X', '2'] (Total unique: 6)
2024-12-02 11:02:17,480 - INFO - Starting data cleaning process...
2024-12-02 11:02:17,539 - INFO - Processing batch 1...
2024-12-02 11:02:17,539 - INFO - =====Checking for duplicate rows:=====
2024-12-02 11:02:17,571 - ERROR - Failed! 1 duplicate rows detected.
2024-12-02 11:02:17,571 - INFO - 
Duplicate rows:
2024-12-02 11:02:17,597 - INFO -    record_number     region residence_type family_composition  sex  age  marital_status  student  country_of_birth  health  ethnic_group  religion economic_activity occupation industry hours_worked_per_week approximate_social_grade
5              5  S92000003              P                  4    2    4               4        2                 1       2             1         1                 1          3       11                     3                        2
2024-12-02 11:02:17,606 - INFO - Total rows in file: 63390
2024-12-02 11:02:17,622 - INFO - llllllllllll        record_number     region  ... hours_worked_per_week approximate_social_grade
21                21  S92000003  ...                     X                        2
29                29  S92000003  ...                     3                      NaN
48                48  S92000003  ...                     X                        2
49                49  S92000003  ...                     X                        2
86                86  S92000003  ...                     X                        1
...              ...        ...  ...                   ...                      ...
63296          63296  S92000003  ...                     X                        2
63318          63318  S92000003  ...                     X                        2
63351          63351  S92000003  ...                     X                        4
63367          63367  S92000003  ...                     X                        2
63384          63384  S92000003  ...                     X                        3

[2600 rows x 17 columns]
2024-12-02 11:02:17,633 - INFO - Rule 1: Found 2600 rows to delete, saved to data/rule_1_deleted_data.csv
2024-12-02 11:02:17,640 - INFO - Rule 2: No rows to delete
2024-12-02 11:02:17,651 - INFO - Rule 3: Found 842 rows to delete, saved to data/rule_3_deleted_data.csv
2024-12-02 11:02:17,667 - INFO - Rule 4: Found 2362 rows to delete, saved to data/rule_4_deleted_data.csv
2024-12-02 11:02:17,673 - INFO - Rule 5: No rows to delete
2024-12-02 11:02:17,684 - INFO - Rule 6: Found 842 rows to delete, saved to data/rule_6_deleted_data.csv
2024-12-02 11:02:17,699 - INFO - 'record_number' column reset.
2024-12-02 11:02:17,893 - INFO - Progress saved to /cs/home/sz92/Documents/CS5002/P3/code/progress.json.
2024-12-02 11:02:17,894 - INFO - Data cleaning process completed. Total rows processed: 63389
2024-12-02 11:02:17,894 - INFO - Rows to drop: 5299
2024-12-02 11:02:17,894 - INFO - Cleaned data saved to ../data/output.csv
2024-12-02 11:02:17,894 - INFO - Progress file removed. Data processing complete.
2024-12-02 11:12:51,588 - WARNING - Progress file progress.json not found. Starting from the beginning.
2024-12-02 11:12:51,667 - INFO - Loaded data from row 0.
2024-12-02 11:12:51,667 - INFO - Columns in DataFrame: ['record_number', 'region', 'residence_type', 'family_composition', 'sex', 'age', 'marital_status', 'student', 'country_of_birth', 'health', 'ethnic_group', 'religion', 'economic_activity', 'occupation', 'industry', 'hours_worked_per_week', 'approximate_social_grade']
2024-12-02 11:12:51,667 - WARNING - Progress file progress.json not found. Starting from the beginning.
2024-12-02 11:12:51,721 - INFO - =====Checking data types:=====
2024-12-02 11:12:51,742 - INFO - Batch info:
None
2024-12-02 11:12:51,997 - INFO - =====Checking for missing value:=====
2024-12-02 11:12:52,016 - WARNING - Missing values detected:
Record_Number               0
Region                      0
RESIDENCE_TYPE              0
Family_Composition          0
sex                         0
age                         0
Marital_Status              0
student                     0
Country_Of_Birth            0
health                      0
Ethnic_Group                0
religion                    0
Economic_Activity           0
Occupation                  0
industry                    0
Hours_Worked_Per_Week       0
Approximate_Social_Grade    5
dtype: int64
2024-12-02 11:12:52,036 - WARNING - Column 'approximate_social_grade': missing values at indices [1, 27, 29, 42273, 42441]
2024-12-02 11:12:52,055 - INFO - Rows to drop:
       record_number     region residence_type family_composition  sex  age  marital_status  student  country_of_birth  health  ethnic_group  religion economic_activity occupation industry hours_worked_per_week approximate_social_grade
1                  2  S92000003              P                  0    1    3               1        2                 1       2             1         1                 1          1        8                     3                      NaN
27                27  S92000003              P                  1    2    4               2        2                 1       2             2         2                 1          6       11                     4                      NaN
29                29  S92000003              P                  2    6    2               2        1                 2       1             2         1                 6          4        2                     3                      NaN
42273          42273  S92000003              C                  X    1    6               1        2                 1       3             1         2                 X          X        X                     X                      NaN
42441          42441  S92000003              C                  X    2    8               5        1                 2       1             9         5                 X          X        X                     X                      NaN
2024-12-02 11:12:52,055 - INFO - =====Checking for duplicate rows:=====
2024-12-02 11:12:52,079 - ERROR - Failed! 1 duplicate rows detected.
2024-12-02 11:12:52,079 - INFO - 
Duplicate rows:
2024-12-02 11:12:52,105 - INFO -    record_number     region residence_type family_composition  sex  age  marital_status  student  country_of_birth  health  ethnic_group  religion economic_activity occupation industry hours_worked_per_week approximate_social_grade
5              5  S92000003              P                  4    2    4               4        2                 1       2             1         1                 1          3       11                     3                        2
2024-12-02 11:12:52,106 - INFO - =====Verifying 'record_number' uniqueness:=====
2024-12-02 11:12:52,106 - INFO - Columns in batch: ['record_number', 'region', 'residence_type', 'family_composition', 'sex', 'age', 'marital_status', 'student', 'country_of_birth', 'health', 'ethnic_group', 'religion', 'economic_activity', 'occupation', 'industry', 'hours_worked_per_week', 'approximate_social_grade']
2024-12-02 11:12:52,108 - ERROR - Failed! 'record_number' is not unique. Duplicate record numbers: [5]
2024-12-02 11:12:52,108 - INFO - 
Duplicate rows:
2024-12-02 11:12:52,111 - INFO -    record_number     region residence_type family_composition  sex  age  marital_status  student  country_of_birth  health  ethnic_group  religion economic_activity occupation industry hours_worked_per_week approximate_social_grade
5              5  S92000003              P                  4    2    4               4        2                 1       2             1         1                 1          3       11                     3                        2
2024-12-02 11:12:52,111 - INFO - =====validate_data_ranges:=====
2024-12-02 11:12:52,194 - INFO - 
Broken records in column 'sex':
2024-12-02 11:12:52,195 - INFO -     sex
29    6
2024-12-02 11:12:52,196 - ERROR - Failed! Column 'sex' contains invalid values: [6]
2024-12-02 11:12:52,441 - INFO - 
Broken records in column 'ethnic_group':
2024-12-02 11:12:52,442 - INFO -        ethnic_group
42441             9
2024-12-02 11:12:52,442 - ERROR - Failed! Column 'ethnic_group' contains invalid values: [9]
2024-12-02 11:12:52,592 - INFO - 
Broken records in column 'approximate_social_grade':
2024-12-02 11:12:52,593 - INFO -       approximate_social_grade
0                           11
1                          NaN
27                         NaN
29                         NaN
42273                      NaN
42441                      NaN
2024-12-02 11:12:52,593 - ERROR - Failed! Column 'approximate_social_grade' contains invalid values: ['11', nan]
2024-12-02 11:12:52,593 - INFO - 
Unique categories and counts per column:
2024-12-02 11:12:52,593 - INFO - residence_type: ['P', 'C'] (Total unique: 2)
2024-12-02 11:12:52,593 - INFO - family_composition: ['4', '5', '1', 'X', '0', '2', '3'] (Total unique: 7)
2024-12-02 11:12:52,593 - INFO - sex: [1, 2, 6] (Total unique: 3)
2024-12-02 11:12:52,593 - INFO - age: [1, 2, 3, 4, 5, 6, 7, 8] (Total unique: 8)
2024-12-02 11:12:52,593 - INFO - marital_status: [1, 2, 3, 4, 5] (Total unique: 5)
2024-12-02 11:12:52,593 - INFO - student: [1, 2] (Total unique: 2)
2024-12-02 11:12:52,594 - INFO - country_of_birth: [1, 2] (Total unique: 2)
2024-12-02 11:12:52,594 - INFO - health: [1, 2, 3, 4, 5] (Total unique: 5)
2024-12-02 11:12:52,594 - INFO - ethnic_group: [1, 2, 3, 4, 5, 6, 9] (Total unique: 7)
2024-12-02 11:12:52,594 - INFO - religion: [1, 2, 3, 4, 5, 6, 7, 8, 9] (Total unique: 9)
2024-12-02 11:12:52,594 - INFO - economic_activity: ['4', '5', '6', '2', '7', '8', '1', 'X', '9', '3'] (Total unique: 10)
2024-12-02 11:12:52,594 - INFO - occupation: ['4', '9', '5', '6', '7', '8', '1', 'X', '2', '3'] (Total unique: 10)
2024-12-02 11:12:52,594 - INFO - industry: ['4', '5', '11', '2', '6', '7', '13', '10', '8', '12', '1', 'X', '9', '3'] (Total unique: 14)
2024-12-02 11:12:52,594 - INFO - hours_worked_per_week: ['4', '1', 'X', '2', '3'] (Total unique: 5)
2024-12-02 11:12:52,594 - INFO - approximate_social_grade: ['4', '11', '1', 'X', '2', '3'] (Total unique: 6)
2024-12-02 11:12:52,594 - INFO - Starting data cleaning process...
2024-12-02 11:12:52,650 - INFO - Processing batch 1...
2024-12-02 11:12:52,650 - INFO - =====Checking for duplicate rows:=====
2024-12-02 11:12:52,680 - ERROR - Failed! 1 duplicate rows detected.
2024-12-02 11:12:52,680 - INFO - 
Duplicate rows:
2024-12-02 11:12:52,706 - INFO -    record_number     region residence_type family_composition  sex  age  marital_status  student  country_of_birth  health  ethnic_group  religion economic_activity occupation industry hours_worked_per_week approximate_social_grade
5              5  S92000003              P                  4    2    4               4        2                 1       2             1         1                 1          3       11                     3                        2
2024-12-02 11:12:52,714 - INFO - Total rows in file: 63390
2024-12-02 11:12:52,730 - INFO -        record_number     region  ... hours_worked_per_week approximate_social_grade
21                21  S92000003  ...                     X                        2
29                29  S92000003  ...                     3                      NaN
48                48  S92000003  ...                     X                        2
49                49  S92000003  ...                     X                        2
86                86  S92000003  ...                     X                        1
...              ...        ...  ...                   ...                      ...
63296          63296  S92000003  ...                     X                        2
63318          63318  S92000003  ...                     X                        2
63351          63351  S92000003  ...                     X                        4
63367          63367  S92000003  ...                     X                        2
63384          63384  S92000003  ...                     X                        3

[2600 rows x 17 columns]
2024-12-02 11:12:52,741 - INFO - Rule 1: Found 2600 rows to delete, saved to data/rule_1_deleted_data.csv
2024-12-02 11:12:52,748 - INFO - Rule 2: No rows to delete
2024-12-02 11:12:52,759 - INFO - Rule 3: Found 842 rows to delete, saved to data/rule_3_deleted_data.csv
2024-12-02 11:12:52,775 - INFO - Rule 4: Found 2362 rows to delete, saved to data/rule_4_deleted_data.csv
2024-12-02 11:12:52,781 - INFO - Rule 5: No rows to delete
2024-12-02 11:12:52,792 - INFO - Rule 6: Found 842 rows to delete, saved to data/rule_6_deleted_data.csv
2024-12-02 11:12:52,804 - INFO - 'record_number' column reset.
2024-12-02 11:12:52,981 - INFO - Progress saved to /cs/home/sz92/Documents/CS5002/P3/code/progress.json.
2024-12-02 11:12:52,981 - INFO - Data cleaning process completed. Total rows processed: 63389
2024-12-02 11:12:52,982 - INFO - Rows to drop: 5299
2024-12-02 11:12:52,982 - INFO - Cleaned data saved to ../data/output.csv
2024-12-02 11:12:52,982 - INFO - Progress file removed. Data processing complete.
2024-12-02 11:12:53,544 - INFO - Data clean code test pass. Congratulation!
2024-12-02 11:16:58,160 - WARNING - Progress file progress.json not found. Starting from the beginning.
2024-12-02 11:16:58,234 - INFO - Loaded data from row 0.
2024-12-02 11:16:58,234 - INFO - Columns in DataFrame: ['record_number', 'region', 'residence_type', 'family_composition', 'sex', 'age', 'marital_status', 'student', 'country_of_birth', 'health', 'ethnic_group', 'religion', 'economic_activity', 'occupation', 'industry', 'hours_worked_per_week', 'approximate_social_grade']
2024-12-02 11:16:58,246 - INFO - =====Checking data types:=====
2024-12-02 11:16:58,253 - INFO - Batch info:
None
2024-12-02 11:16:58,296 - INFO - =====Checking for missing value:=====
2024-12-02 11:16:58,300 - WARNING - Missing values detected:
Record_Number               0
Region                      0
RESIDENCE_TYPE              0
Family_Composition          0
sex                         0
age                         0
Marital_Status              0
student                     0
Country_Of_Birth            0
health                      0
Ethnic_Group                0
religion                    0
Economic_Activity           0
Occupation                  0
industry                    0
Hours_Worked_Per_Week       0
Approximate_Social_Grade    3
dtype: int64
2024-12-02 11:16:58,304 - WARNING - Column 'approximate_social_grade': missing values at indices [1, 27, 29]
2024-12-02 11:16:58,315 - INFO - Rows to drop:
    record_number     region residence_type family_composition  sex  age  marital_status  student  country_of_birth  health  ethnic_group  religion economic_activity occupation industry hours_worked_per_week approximate_social_grade
1               2  S92000003              P                  0    1    3               1        2                 1       2             1         1                 1          1        8                     3                      NaN
27             27  S92000003              P                  1    2    4               2        2                 1       2             2         2                 1          6       11                     4                      NaN
29             29  S92000003              P                  2    6    2               2        1                 2       1             2         1                 6          4        2                     3                      NaN
2024-12-02 11:16:58,324 - INFO - =====Checking for duplicate rows:=====
2024-12-02 11:16:58,330 - ERROR - Failed! 1 duplicate rows detected.
2024-12-02 11:16:58,330 - INFO - 
Duplicate rows:
2024-12-02 11:16:58,337 - INFO -    record_number     region residence_type family_composition  sex  age  marital_status  student  country_of_birth  health  ethnic_group  religion economic_activity occupation industry hours_worked_per_week approximate_social_grade
5              5  S92000003              P                  4    2    4               4        2                 1       2             1         1                 1          3       11                     3                        2
2024-12-02 11:16:58,344 - INFO - =====Verifying 'record_number' uniqueness:=====
2024-12-02 11:16:58,344 - INFO - Columns in batch: ['record_number', 'region', 'residence_type', 'family_composition', 'sex', 'age', 'marital_status', 'student', 'country_of_birth', 'health', 'ethnic_group', 'religion', 'economic_activity', 'occupation', 'industry', 'hours_worked_per_week', 'approximate_social_grade']
2024-12-02 11:16:58,345 - ERROR - Failed! 'record_number' is not unique. Duplicate record numbers: [5]
2024-12-02 11:16:58,346 - INFO - 
Duplicate rows:
2024-12-02 11:16:58,348 - INFO -    record_number     region residence_type family_composition  sex  age  marital_status  student  country_of_birth  health  ethnic_group  religion economic_activity occupation industry hours_worked_per_week approximate_social_grade
5              5  S92000003              P                  4    2    4               4        2                 1       2             1         1                 1          3       11                     3                        2
2024-12-02 11:16:58,356 - INFO - =====validate_data_ranges:=====
2024-12-02 11:16:58,371 - INFO - 
Broken records in column 'sex':
2024-12-02 11:16:58,372 - INFO -     sex
29    6
2024-12-02 11:16:58,372 - ERROR - Failed! Column 'sex' contains invalid values: [6]
2024-12-02 11:16:58,431 - INFO - 
Broken records in column 'approximate_social_grade':
2024-12-02 11:16:58,432 - INFO -    approximate_social_grade
0                        11
1                       NaN
27                      NaN
29                      NaN
2024-12-02 11:16:58,432 - ERROR - Failed! Column 'approximate_social_grade' contains invalid values: ['11', nan]
2024-12-02 11:16:58,432 - INFO - 
Unique categories and counts per column:
2024-12-02 11:16:58,432 - INFO - residence_type: ['C', 'P'] (Total unique: 2)
2024-12-02 11:16:58,432 - INFO - family_composition: ['X', '4', '1', '2', '3', '5', '0'] (Total unique: 7)
2024-12-02 11:16:58,432 - INFO - sex: [1, 2, 6] (Total unique: 3)
2024-12-02 11:16:58,432 - INFO - age: [1, 2, 3, 4, 5, 6, 7, 8] (Total unique: 8)
2024-12-02 11:16:58,432 - INFO - marital_status: [1, 2, 3, 4, 5] (Total unique: 5)
2024-12-02 11:16:58,432 - INFO - student: [1, 2] (Total unique: 2)
2024-12-02 11:16:58,432 - INFO - country_of_birth: [1, 2] (Total unique: 2)
2024-12-02 11:16:58,432 - INFO - health: [1, 2, 3, 4, 5] (Total unique: 5)
2024-12-02 11:16:58,432 - INFO - ethnic_group: [1, 2, 3, 4, 5, 6] (Total unique: 6)
2024-12-02 11:16:58,433 - INFO - religion: [1, 2, 3, 4, 5, 6, 7, 8, 9] (Total unique: 9)
2024-12-02 11:16:58,433 - INFO - economic_activity: ['X', '1', '6', '2', '3', '5', '7', '9', '8', '4'] (Total unique: 10)
2024-12-02 11:16:58,433 - INFO - occupation: ['X', '1', '6', '2', '3', '5', '7', '9', '8', '4'] (Total unique: 10)
2024-12-02 11:16:58,433 - INFO - industry: ['X', '1', '12', '6', '13', '2', '3', '5', '7', '9', '10', '8', '11', '4'] (Total unique: 14)
2024-12-02 11:16:58,433 - INFO - hours_worked_per_week: ['X', '1', '2', '3', '4'] (Total unique: 5)
2024-12-02 11:16:58,433 - INFO - approximate_social_grade: ['X', '1', '2', '3', '11', '4'] (Total unique: 6)
2024-12-02 11:16:58,446 - INFO -       record_number     region residence_type family_composition  sex  age  \
21               21  S92000003              P                  5    2    2   
29               29  S92000003              P                  2    6    2   
48               48  S92000003              P                  0    1    2   
49               49  S92000003              P                  0    1    3   
86               86  S92000003              P                  1    1    2   
...             ...        ...            ...                ...  ...  ...   
8819           8819  S92000003              P                  1    2    2   
8876           8876  S92000003              P                  1    2    2   
8887           8887  S92000003              P                  4    2    2   
8907           8907  S92000003              P                  4    1    2   
8931           8931  S92000003              P                  1    1    2   

      marital_status  student  country_of_birth  health  ethnic_group  \
21                 1        1                 2       2             1   
29                 2        1                 2       1             2   
48                 1        1                 2       1             1   
49                 2        1                 2       1             4   
86                 1        1                 2       1             1   
...              ...      ...               ...     ...           ...   
8819               1        1                 1       1             1   
8876               1        1                 2       1             1   
8887               1        1                 1       1             1   
8907               1        1                 1       1             1   
8931               1        1                 1       1             1   

      religion economic_activity occupation industry hours_worked_per_week  \
21           2                 6          X        X                     X   
29           1                 6          4        2                     3   
48           1                 6          X        X                     X   
49           2                 6          2        8                     X   
86           2                 6          X        X                     X   
...        ...               ...        ...      ...                   ...   
8819         2                 6          X        X                     X   
8876         1                 6          X        X                     X   
8887         1                 6          X        X                     X   
8907         2                 6          X        X                     X   
8931         1                 6          7        4                     X   

     approximate_social_grade  
21                          2  
29                        NaN  
48                          2  
49                          2  
86                          1  
...                       ...  
8819                        4  
8876                        2  
8887                        1  
8907                        4  
8931                        2  

[373 rows x 17 columns]
2024-12-02 11:16:58,451 - INFO - Rule 1: Found 373 rows to delete, saved to data/rule_1_deleted_data.csv
2024-12-02 11:16:58,453 - INFO - Rule 2: No rows to delete
2024-12-02 11:16:58,457 - INFO - Rule 3: Found 123 rows to delete, saved to data/rule_3_deleted_data.csv
2024-12-02 11:16:58,462 - INFO - Rule 4: Found 326 rows to delete, saved to data/rule_4_deleted_data.csv
2024-12-02 11:16:58,464 - INFO - Rule 5: No rows to delete
2024-12-02 11:16:58,469 - INFO - Rule 6: Found 123 rows to delete, saved to data/rule_6_deleted_data.csv
2024-12-02 11:16:58,481 - INFO - Starting data cleaning process...
2024-12-02 11:16:58,540 - INFO - Processing batch 1...
2024-12-02 11:16:58,540 - INFO - =====Checking for duplicate rows:=====
2024-12-02 11:16:58,565 - ERROR - Failed! 1 duplicate rows detected.
2024-12-02 11:16:58,565 - INFO - 
Duplicate rows:
2024-12-02 11:16:58,591 - INFO -    record_number     region residence_type family_composition  sex  age  marital_status  student  country_of_birth  health  ethnic_group  religion economic_activity occupation industry hours_worked_per_week approximate_social_grade
5              5  S92000003              P                  4    2    4               4        2                 1       2             1         1                 1          3       11                     3                        2
2024-12-02 11:16:58,600 - INFO - Total rows in file: 63390
2024-12-02 11:16:58,608 - INFO -        record_number     region residence_type family_composition  sex  age  \
21                21  S92000003              P                  5    2    2   
29                29  S92000003              P                  2    6    2   
48                48  S92000003              P                  0    1    2   
49                49  S92000003              P                  0    1    3   
86                86  S92000003              P                  1    1    2   
...              ...        ...            ...                ...  ...  ...   
63296          63296  S92000003              P                  1    1    2   
63318          63318  S92000003              P                  0    2    2   
63351          63351  S92000003              P                  1    1    2   
63367          63367  S92000003              P                  4    2    2   
63384          63384  S92000003              P                  1    1    2   

       marital_status  student  country_of_birth  health  ethnic_group  \
21                  1        1                 2       2             1   
29                  2        1                 2       1             2   
48                  1        1                 2       1             1   
49                  2        1                 2       1             4   
86                  1        1                 2       1             1   
...               ...      ...               ...     ...           ...   
63296               1        1                 1       1             1   
63318               1        1                 2       2             3   
63351               1        1                 1       1             1   
63367               1        1                 1       1             1   
63384               1        1                 1       1             1   

       religion economic_activity occupation industry hours_worked_per_week  \
21            2                 6          X        X                     X   
29            1                 6          4        2                     3   
48            1                 6          X        X                     X   
49            2                 6          2        8                     X   
86            2                 6          X        X                     X   
...         ...               ...        ...      ...                   ...   
63296         2                 6          7        4                     X   
63318         1                 6          X        X                     X   
63351         1                 6          X        X                     X   
63367         1                 6          X        X                     X   
63384         2                 6          X        X                     X   

      approximate_social_grade  
21                           2  
29                         NaN  
48                           2  
49                           2  
86                           1  
...                        ...  
63296                        2  
63318                        2  
63351                        4  
63367                        2  
63384                        3  

[2600 rows x 17 columns]
2024-12-02 11:16:58,618 - INFO - Rule 1: Found 2600 rows to delete, saved to data/rule_1_deleted_data.csv
2024-12-02 11:16:58,625 - INFO - Rule 2: No rows to delete
2024-12-02 11:16:58,637 - INFO - Rule 3: Found 842 rows to delete, saved to data/rule_3_deleted_data.csv
2024-12-02 11:16:58,654 - INFO - Rule 4: Found 2362 rows to delete, saved to data/rule_4_deleted_data.csv
2024-12-02 11:16:58,661 - INFO - Rule 5: No rows to delete
2024-12-02 11:16:58,672 - INFO - Rule 6: Found 842 rows to delete, saved to data/rule_6_deleted_data.csv
2024-12-02 11:16:58,684 - INFO - 'record_number' column reset.
2024-12-02 11:16:58,863 - INFO - Progress saved to /cs/home/sz92/Documents/CS5002/P3/notebooks/progress.json.
2024-12-02 11:16:58,863 - INFO - Data cleaning process completed. Total rows processed: 63389
2024-12-02 11:16:58,863 - INFO - Rows to drop: 5299
2024-12-02 11:16:58,863 - INFO - Cleaned data saved to ../data/output.csv
2024-12-02 11:16:58,864 - INFO - Progress file removed. Data processing complete.
2024-12-02 11:16:58,902 - INFO - Data clean code test pass. Congratulation!
2024-12-02 11:21:41,954 - WARNING - Progress file progress.json not found. Starting from the beginning.
2024-12-02 11:21:42,021 - INFO - Loaded data from row 0.
2024-12-02 11:21:42,021 - INFO - Columns in DataFrame: ['record_number', 'region', 'residence_type', 'family_composition', 'sex', 'age', 'marital_status', 'student', 'country_of_birth', 'health', 'ethnic_group', 'religion', 'economic_activity', 'occupation', 'industry', 'hours_worked_per_week', 'approximate_social_grade']
2024-12-02 11:21:42,022 - WARNING - Progress file progress.json not found. Starting from the beginning.
2024-12-02 11:21:42,077 - INFO - =====Checking data types:=====
2024-12-02 11:21:42,099 - INFO - Batch info:
None
2024-12-02 11:21:42,366 - INFO - =====Checking for missing value:=====
2024-12-02 11:21:42,385 - WARNING - Missing values detected:
Record_Number               0
Region                      0
RESIDENCE_TYPE              0
Family_Composition          0
sex                         0
age                         0
Marital_Status              0
student                     0
Country_Of_Birth            0
health                      0
Ethnic_Group                0
religion                    0
Economic_Activity           0
Occupation                  0
industry                    0
Hours_Worked_Per_Week       0
Approximate_Social_Grade    5
dtype: int64
2024-12-02 11:21:42,405 - WARNING - Column 'approximate_social_grade': missing values at indices [1, 27, 29, 42273, 42441]
2024-12-02 11:21:42,424 - INFO - Rows to drop:
       record_number     region residence_type family_composition  sex  age  marital_status  student  country_of_birth  health  ethnic_group  religion economic_activity occupation industry hours_worked_per_week approximate_social_grade
1                  2  S92000003              P                  0    1    3               1        2                 1       2             1         1                 1          1        8                     3                      NaN
27                27  S92000003              P                  1    2    4               2        2                 1       2             2         2                 1          6       11                     4                      NaN
29                29  S92000003              P                  2    6    2               2        1                 2       1             2         1                 6          4        2                     3                      NaN
42273          42273  S92000003              C                  X    1    6               1        2                 1       3             1         2                 X          X        X                     X                      NaN
42441          42441  S92000003              C                  X    2    8               5        1                 2       1             9         5                 X          X        X                     X                      NaN
2024-12-02 11:21:42,424 - INFO - =====Checking for duplicate rows:=====
2024-12-02 11:21:42,447 - ERROR - Failed! 1 duplicate rows detected.
2024-12-02 11:21:42,447 - INFO - 
Duplicate rows:
2024-12-02 11:21:42,473 - INFO -    record_number     region residence_type family_composition  sex  age  marital_status  student  country_of_birth  health  ethnic_group  religion economic_activity occupation industry hours_worked_per_week approximate_social_grade
5              5  S92000003              P                  4    2    4               4        2                 1       2             1         1                 1          3       11                     3                        2
2024-12-02 11:21:42,473 - INFO - =====Verifying 'record_number' uniqueness:=====
2024-12-02 11:21:42,473 - INFO - Columns in batch: ['record_number', 'region', 'residence_type', 'family_composition', 'sex', 'age', 'marital_status', 'student', 'country_of_birth', 'health', 'ethnic_group', 'religion', 'economic_activity', 'occupation', 'industry', 'hours_worked_per_week', 'approximate_social_grade']
2024-12-02 11:21:42,475 - ERROR - Failed! 'record_number' is not unique. Duplicate record numbers: [5]
2024-12-02 11:21:42,475 - INFO - 
Duplicate rows:
2024-12-02 11:21:42,478 - INFO -    record_number     region residence_type family_composition  sex  age  marital_status  student  country_of_birth  health  ethnic_group  religion economic_activity occupation industry hours_worked_per_week approximate_social_grade
5              5  S92000003              P                  4    2    4               4        2                 1       2             1         1                 1          3       11                     3                        2
2024-12-02 11:21:42,478 - INFO - =====validate_data_ranges:=====
2024-12-02 11:21:42,560 - INFO - 
Broken records in column 'sex':
2024-12-02 11:21:42,561 - INFO -     sex
29    6
2024-12-02 11:21:42,561 - ERROR - Failed! Column 'sex' contains invalid values: [6]
2024-12-02 11:21:42,813 - INFO - 
Broken records in column 'ethnic_group':
2024-12-02 11:21:42,814 - INFO -        ethnic_group
42441             9
2024-12-02 11:21:42,814 - ERROR - Failed! Column 'ethnic_group' contains invalid values: [9]
2024-12-02 11:21:42,965 - INFO - 
Broken records in column 'approximate_social_grade':
2024-12-02 11:21:42,966 - INFO -       approximate_social_grade
0                           11
1                          NaN
27                         NaN
29                         NaN
42273                      NaN
42441                      NaN
2024-12-02 11:21:42,967 - ERROR - Failed! Column 'approximate_social_grade' contains invalid values: ['11', nan]
2024-12-02 11:21:42,967 - INFO - 
Unique categories and counts per column:
2024-12-02 11:21:42,967 - INFO - residence_type: ['C', 'P'] (Total unique: 2)
2024-12-02 11:21:42,967 - INFO - family_composition: ['4', '2', 'X', '1', '0', '3', '5'] (Total unique: 7)
2024-12-02 11:21:42,967 - INFO - sex: [1, 2, 6] (Total unique: 3)
2024-12-02 11:21:42,967 - INFO - age: [1, 2, 3, 4, 5, 6, 7, 8] (Total unique: 8)
2024-12-02 11:21:42,967 - INFO - marital_status: [1, 2, 3, 4, 5] (Total unique: 5)
2024-12-02 11:21:42,967 - INFO - student: [1, 2] (Total unique: 2)
2024-12-02 11:21:42,967 - INFO - country_of_birth: [1, 2] (Total unique: 2)
2024-12-02 11:21:42,967 - INFO - health: [1, 2, 3, 4, 5] (Total unique: 5)
2024-12-02 11:21:42,967 - INFO - ethnic_group: [1, 2, 3, 4, 5, 6, 9] (Total unique: 7)
2024-12-02 11:21:42,967 - INFO - religion: [1, 2, 3, 4, 5, 6, 7, 8, 9] (Total unique: 9)
2024-12-02 11:21:42,967 - INFO - economic_activity: ['6', '4', '2', '8', '9', 'X', '7', '1', '3', '5'] (Total unique: 10)
2024-12-02 11:21:42,967 - INFO - occupation: ['4', '2', '6', '8', '9', 'X', '7', '1', '3', '5'] (Total unique: 10)
2024-12-02 11:21:42,967 - INFO - industry: ['13', '2', '4', '6', '10', '12', '8', '9', 'X', '7', '1', '11', '3', '5'] (Total unique: 14)
2024-12-02 11:21:42,967 - INFO - hours_worked_per_week: ['4', '2', 'X', '1', '3'] (Total unique: 5)
2024-12-02 11:21:42,967 - INFO - approximate_social_grade: ['4', '2', 'X', '1', '11', '3'] (Total unique: 6)
2024-12-02 11:21:42,967 - INFO - Starting data cleaning process...
2024-12-02 11:21:43,027 - INFO - Processing batch 1...
2024-12-02 11:21:43,027 - INFO - =====Checking for duplicate rows:=====
2024-12-02 11:21:43,060 - ERROR - Failed! 1 duplicate rows detected.
2024-12-02 11:21:43,060 - INFO - 
Duplicate rows:
2024-12-02 11:21:43,086 - INFO -    record_number     region residence_type family_composition  sex  age  marital_status  student  country_of_birth  health  ethnic_group  religion economic_activity occupation industry hours_worked_per_week approximate_social_grade
5              5  S92000003              P                  4    2    4               4        2                 1       2             1         1                 1          3       11                     3                        2
2024-12-02 11:21:43,095 - INFO - Total rows in file: 63390
2024-12-02 11:21:43,111 - INFO -        record_number     region  ... hours_worked_per_week approximate_social_grade
21                21  S92000003  ...                     X                        2
29                29  S92000003  ...                     3                      NaN
48                48  S92000003  ...                     X                        2
49                49  S92000003  ...                     X                        2
86                86  S92000003  ...                     X                        1
...              ...        ...  ...                   ...                      ...
63296          63296  S92000003  ...                     X                        2
63318          63318  S92000003  ...                     X                        2
63351          63351  S92000003  ...                     X                        4
63367          63367  S92000003  ...                     X                        2
63384          63384  S92000003  ...                     X                        3

[2600 rows x 17 columns]
2024-12-02 11:21:43,122 - INFO - Rule 1: Found 2600 rows to delete, saved to data/rule_1_deleted_data.csv
2024-12-02 11:21:43,129 - INFO - Rule 2: No rows to delete
2024-12-02 11:21:43,142 - INFO - Rule 3: Found 842 rows to delete, saved to data/rule_3_deleted_data.csv
2024-12-02 11:21:43,159 - INFO - Rule 4: Found 2362 rows to delete, saved to data/rule_4_deleted_data.csv
2024-12-02 11:21:43,165 - INFO - Rule 5: No rows to delete
2024-12-02 11:21:43,178 - INFO - Rule 6: Found 842 rows to delete, saved to data/rule_6_deleted_data.csv
2024-12-02 11:21:43,190 - INFO - 'record_number' column reset.
2024-12-02 11:21:43,373 - INFO - Progress saved to /cs/home/sz92/Documents/CS5002/P3/code/progress.json.
2024-12-02 11:21:43,374 - INFO - Data cleaning process completed. Total rows processed: 63389
2024-12-02 11:21:43,374 - INFO - Rows to drop: 5299
2024-12-02 11:21:43,374 - INFO - Cleaned data saved to ../data/output.csv
2024-12-02 11:21:43,374 - INFO - Progress file removed. Data processing complete.
2024-12-02 11:21:43,926 - INFO - Data clean code test pass. Congratulation!
2024-12-02 11:26:17,996 - WARNING - Progress file progress.json not found. Starting from the beginning.
2024-12-02 11:26:18,065 - INFO - Loaded data from row 0.
2024-12-02 11:26:18,065 - INFO - Columns in DataFrame: ['record_number', 'region', 'residence_type', 'family_composition', 'sex', 'age', 'marital_status', 'student', 'country_of_birth', 'health', 'ethnic_group', 'religion', 'economic_activity', 'occupation', 'industry', 'hours_worked_per_week', 'approximate_social_grade']
2024-12-02 11:26:18,065 - WARNING - Progress file progress.json not found. Starting from the beginning.
2024-12-02 11:26:18,118 - INFO - =====Checking data types:=====
2024-12-02 11:26:18,140 - INFO - Batch info:
None
2024-12-02 11:26:18,399 - INFO - =====Checking for missing value:=====
2024-12-02 11:26:18,417 - WARNING - Missing values detected:
Record_Number               0
Region                      0
RESIDENCE_TYPE              0
Family_Composition          0
sex                         0
age                         0
Marital_Status              0
student                     0
Country_Of_Birth            0
health                      0
Ethnic_Group                0
religion                    0
Economic_Activity           0
Occupation                  0
industry                    0
Hours_Worked_Per_Week       0
Approximate_Social_Grade    5
dtype: int64
2024-12-02 11:26:18,436 - WARNING - Column 'approximate_social_grade': missing values at indices [1, 27, 29, 42273, 42441]
2024-12-02 11:26:18,455 - INFO - Rows to drop:
       record_number     region residence_type family_composition  sex  age  marital_status  student  country_of_birth  health  ethnic_group  religion economic_activity occupation industry hours_worked_per_week approximate_social_grade
1                  2  S92000003              P                  0    1    3               1        2                 1       2             1         1                 1          1        8                     3                      NaN
27                27  S92000003              P                  1    2    4               2        2                 1       2             2         2                 1          6       11                     4                      NaN
29                29  S92000003              P                  2    6    2               2        1                 2       1             2         1                 6          4        2                     3                      NaN
42273          42273  S92000003              C                  X    1    6               1        2                 1       3             1         2                 X          X        X                     X                      NaN
42441          42441  S92000003              C                  X    2    8               5        1                 2       1             9         5                 X          X        X                     X                      NaN
2024-12-02 11:26:18,455 - INFO - =====Checking for duplicate rows:=====
2024-12-02 11:26:18,478 - ERROR - Failed! 1 duplicate rows detected.
2024-12-02 11:26:18,478 - INFO - 
Duplicate rows:
2024-12-02 11:26:18,504 - INFO -    record_number     region residence_type family_composition  sex  age  marital_status  student  country_of_birth  health  ethnic_group  religion economic_activity occupation industry hours_worked_per_week approximate_social_grade
5              5  S92000003              P                  4    2    4               4        2                 1       2             1         1                 1          3       11                     3                        2
2024-12-02 11:26:18,504 - INFO - =====Verifying 'record_number' uniqueness:=====
2024-12-02 11:26:18,504 - INFO - Columns in batch: ['record_number', 'region', 'residence_type', 'family_composition', 'sex', 'age', 'marital_status', 'student', 'country_of_birth', 'health', 'ethnic_group', 'religion', 'economic_activity', 'occupation', 'industry', 'hours_worked_per_week', 'approximate_social_grade']
2024-12-02 11:26:18,506 - ERROR - Failed! 'record_number' is not unique. Duplicate record numbers: [5]
2024-12-02 11:26:18,506 - INFO - 
Duplicate rows:
2024-12-02 11:26:18,509 - INFO -    record_number     region residence_type family_composition  sex  age  marital_status  student  country_of_birth  health  ethnic_group  religion economic_activity occupation industry hours_worked_per_week approximate_social_grade
5              5  S92000003              P                  4    2    4               4        2                 1       2             1         1                 1          3       11                     3                        2
2024-12-02 11:26:18,509 - INFO - =====validate_data_ranges:=====
2024-12-02 11:26:18,590 - INFO - 
Broken records in column 'sex':
2024-12-02 11:26:18,591 - INFO -     sex
29    6
2024-12-02 11:26:18,591 - ERROR - Failed! Column 'sex' contains invalid values: [6]
2024-12-02 11:26:18,840 - INFO - 
Broken records in column 'ethnic_group':
2024-12-02 11:26:18,841 - INFO -        ethnic_group
42441             9
2024-12-02 11:26:18,842 - ERROR - Failed! Column 'ethnic_group' contains invalid values: [9]
2024-12-02 11:26:18,991 - INFO - 
Broken records in column 'approximate_social_grade':
2024-12-02 11:26:18,992 - INFO -       approximate_social_grade
0                           11
1                          NaN
27                         NaN
29                         NaN
42273                      NaN
42441                      NaN
2024-12-02 11:26:18,992 - ERROR - Failed! Column 'approximate_social_grade' contains invalid values: ['11', nan]
2024-12-02 11:26:18,992 - INFO - 
Unique categories and counts per column:
2024-12-02 11:26:18,992 - INFO - residence_type: ['P', 'C'] (Total unique: 2)
2024-12-02 11:26:18,992 - INFO - family_composition: ['1', '3', '5', 'X', '0', '2', '4'] (Total unique: 7)
2024-12-02 11:26:18,992 - INFO - sex: [1, 2, 6] (Total unique: 3)
2024-12-02 11:26:18,992 - INFO - age: [1, 2, 3, 4, 5, 6, 7, 8] (Total unique: 8)
2024-12-02 11:26:18,992 - INFO - marital_status: [1, 2, 3, 4, 5] (Total unique: 5)
2024-12-02 11:26:18,992 - INFO - student: [1, 2] (Total unique: 2)
2024-12-02 11:26:18,992 - INFO - country_of_birth: [1, 2] (Total unique: 2)
2024-12-02 11:26:18,992 - INFO - health: [1, 2, 3, 4, 5] (Total unique: 5)
2024-12-02 11:26:18,992 - INFO - ethnic_group: [1, 2, 3, 4, 5, 6, 9] (Total unique: 7)
2024-12-02 11:26:18,992 - INFO - religion: [1, 2, 3, 4, 5, 6, 7, 8, 9] (Total unique: 9)
2024-12-02 11:26:18,992 - INFO - economic_activity: ['1', '3', '9', '5', 'X', '8', '6', '2', '7', '4'] (Total unique: 10)
2024-12-02 11:26:18,992 - INFO - occupation: ['1', '3', '5', '9', 'X', '8', '2', '6', '7', '4'] (Total unique: 10)
2024-12-02 11:26:18,992 - INFO - industry: ['3', '1', '10', '9', '5', 'X', '8', '11', '2', '6', '7', '13', '4', '12'] (Total unique: 14)
2024-12-02 11:26:18,992 - INFO - hours_worked_per_week: ['3', '1', 'X', '2', '4'] (Total unique: 5)
2024-12-02 11:26:18,992 - INFO - approximate_social_grade: ['3', '1', 'X', '11', '2', '4'] (Total unique: 6)
2024-12-02 11:26:18,992 - INFO - Starting data cleaning process...
2024-12-02 11:26:19,050 - INFO - Processing batch 1...
2024-12-02 11:26:19,050 - INFO - =====Checking for duplicate rows:=====
2024-12-02 11:26:19,084 - ERROR - Failed! 1 duplicate rows detected.
2024-12-02 11:26:19,084 - INFO - 
Duplicate rows:
2024-12-02 11:26:19,109 - INFO -    record_number     region residence_type family_composition  sex  age  marital_status  student  country_of_birth  health  ethnic_group  religion economic_activity occupation industry hours_worked_per_week approximate_social_grade
5              5  S92000003              P                  4    2    4               4        2                 1       2             1         1                 1          3       11                     3                        2
2024-12-02 11:26:19,118 - INFO - Total rows in file: 63390
2024-12-02 11:26:19,134 - INFO -        record_number     region  ... hours_worked_per_week approximate_social_grade
21                21  S92000003  ...                     X                        2
29                29  S92000003  ...                     3                      NaN
48                48  S92000003  ...                     X                        2
49                49  S92000003  ...                     X                        2
86                86  S92000003  ...                     X                        1
...              ...        ...  ...                   ...                      ...
63296          63296  S92000003  ...                     X                        2
63318          63318  S92000003  ...                     X                        2
63351          63351  S92000003  ...                     X                        4
63367          63367  S92000003  ...                     X                        2
63384          63384  S92000003  ...                     X                        3

[2600 rows x 17 columns]
2024-12-02 11:26:19,146 - INFO - Rule 1: Found 2600 rows to delete, saved to data/rule_1_deleted_data.csv
2024-12-02 11:26:19,152 - INFO - Rule 2: No rows to delete
2024-12-02 11:26:19,163 - INFO - Rule 3: Found 842 rows to delete, saved to data/rule_3_deleted_data.csv
2024-12-02 11:26:19,179 - INFO - Rule 4: Found 2362 rows to delete, saved to data/rule_4_deleted_data.csv
2024-12-02 11:26:19,185 - INFO - Rule 5: No rows to delete
2024-12-02 11:26:19,196 - INFO - Rule 6: Found 842 rows to delete, saved to data/rule_6_deleted_data.csv
2024-12-02 11:26:19,208 - INFO - 'record_number' column reset.
2024-12-02 11:26:19,386 - INFO - Progress saved to /cs/home/sz92/Documents/CS5002/P3/code/progress.json.
2024-12-02 11:26:19,386 - INFO - Data cleaning process completed. Total rows processed: 63389
2024-12-02 11:26:19,386 - INFO - Rows to drop: 5299
2024-12-02 11:26:19,386 - INFO - Cleaned data saved to ../data/output.csv
2024-12-02 11:26:19,387 - INFO - Progress file removed. Data processing complete.
2024-12-02 11:26:19,952 - INFO - Data clean code test pass. Congratulation!
2024-12-02 11:29:02,626 - WARNING - Progress file progress.json not found. Starting from the beginning.
2024-12-02 11:29:02,691 - INFO - Loaded data from row 0.
2024-12-02 11:29:02,691 - INFO - Columns in DataFrame: ['record_number', 'region', 'residence_type', 'family_composition', 'sex', 'age', 'marital_status', 'student', 'country_of_birth', 'health', 'ethnic_group', 'religion', 'economic_activity', 'occupation', 'industry', 'hours_worked_per_week', 'approximate_social_grade']
2024-12-02 11:29:02,691 - WARNING - Progress file progress.json not found. Starting from the beginning.
2024-12-02 11:29:02,742 - INFO - =====Checking data types:=====
2024-12-02 11:29:02,762 - INFO - Batch info:
None
2024-12-02 11:29:03,011 - INFO - =====Checking for missing value:=====
2024-12-02 11:29:03,029 - WARNING - Missing values detected:
Record_Number               0
Region                      0
RESIDENCE_TYPE              0
Family_Composition          0
sex                         0
age                         0
Marital_Status              0
student                     0
Country_Of_Birth            0
health                      0
Ethnic_Group                0
religion                    0
Economic_Activity           0
Occupation                  0
industry                    0
Hours_Worked_Per_Week       0
Approximate_Social_Grade    5
dtype: int64
2024-12-02 11:29:03,048 - WARNING - Column 'approximate_social_grade': missing values at indices [1, 27, 29, 42273, 42441]
2024-12-02 11:29:03,066 - INFO - Rows to drop:
       record_number     region residence_type family_composition  sex  age  marital_status  student  country_of_birth  health  ethnic_group  religion economic_activity occupation industry hours_worked_per_week approximate_social_grade
1                  2  S92000003              P                  0    1    3               1        2                 1       2             1         1                 1          1        8                     3                      NaN
27                27  S92000003              P                  1    2    4               2        2                 1       2             2         2                 1          6       11                     4                      NaN
29                29  S92000003              P                  2    6    2               2        1                 2       1             2         1                 6          4        2                     3                      NaN
42273          42273  S92000003              C                  X    1    6               1        2                 1       3             1         2                 X          X        X                     X                      NaN
42441          42441  S92000003              C                  X    2    8               5        1                 2       1             9         5                 X          X        X                     X                      NaN
2024-12-02 11:29:03,066 - INFO - =====Checking for duplicate rows:=====
2024-12-02 11:29:03,088 - ERROR - Failed! 1 duplicate rows detected.
2024-12-02 11:29:03,088 - INFO - 
Duplicate rows:
2024-12-02 11:29:03,112 - INFO -    record_number     region residence_type family_composition  sex  age  marital_status  student  country_of_birth  health  ethnic_group  religion economic_activity occupation industry hours_worked_per_week approximate_social_grade
5              5  S92000003              P                  4    2    4               4        2                 1       2             1         1                 1          3       11                     3                        2
2024-12-02 11:29:03,112 - INFO - =====Verifying 'record_number' uniqueness:=====
2024-12-02 11:29:03,113 - INFO - Columns in batch: ['record_number', 'region', 'residence_type', 'family_composition', 'sex', 'age', 'marital_status', 'student', 'country_of_birth', 'health', 'ethnic_group', 'religion', 'economic_activity', 'occupation', 'industry', 'hours_worked_per_week', 'approximate_social_grade']
2024-12-02 11:29:03,114 - ERROR - Failed! 'record_number' is not unique. Duplicate record numbers: [5]
2024-12-02 11:29:03,114 - INFO - 
Duplicate rows:
2024-12-02 11:29:03,117 - INFO -    record_number     region residence_type family_composition  sex  age  marital_status  student  country_of_birth  health  ethnic_group  religion economic_activity occupation industry hours_worked_per_week approximate_social_grade
5              5  S92000003              P                  4    2    4               4        2                 1       2             1         1                 1          3       11                     3                        2
2024-12-02 11:29:03,117 - INFO - =====validate_data_ranges:=====
2024-12-02 11:29:03,195 - INFO - 
Broken records in column 'sex':
2024-12-02 11:29:03,196 - INFO -     sex
29    6
2024-12-02 11:29:03,196 - ERROR - Failed! Column 'sex' contains invalid values: [6]
2024-12-02 11:29:03,435 - INFO - 
Broken records in column 'ethnic_group':
2024-12-02 11:29:03,436 - INFO -        ethnic_group
42441             9
2024-12-02 11:29:03,436 - ERROR - Failed! Column 'ethnic_group' contains invalid values: [9]
2024-12-02 11:29:03,581 - INFO - 
Broken records in column 'approximate_social_grade':
2024-12-02 11:29:03,582 - INFO -       approximate_social_grade
0                           11
1                          NaN
27                         NaN
29                         NaN
42273                      NaN
42441                      NaN
2024-12-02 11:29:03,583 - ERROR - Failed! Column 'approximate_social_grade' contains invalid values: ['11', nan]
2024-12-02 11:29:03,583 - INFO - 
Unique categories and counts per column:
2024-12-02 11:29:03,583 - INFO - residence_type: ['P', 'C'] (Total unique: 2)
2024-12-02 11:29:03,583 - INFO - family_composition: ['1', '3', '2', 'X', '0', '4', '5'] (Total unique: 7)
2024-12-02 11:29:03,583 - INFO - sex: [1, 2, 6] (Total unique: 3)
2024-12-02 11:29:03,583 - INFO - age: [1, 2, 3, 4, 5, 6, 7, 8] (Total unique: 8)
2024-12-02 11:29:03,583 - INFO - marital_status: [1, 2, 3, 4, 5] (Total unique: 5)
2024-12-02 11:29:03,583 - INFO - student: [1, 2] (Total unique: 2)
2024-12-02 11:29:03,583 - INFO - country_of_birth: [1, 2] (Total unique: 2)
2024-12-02 11:29:03,583 - INFO - health: [1, 2, 3, 4, 5] (Total unique: 5)
2024-12-02 11:29:03,583 - INFO - ethnic_group: [1, 2, 3, 4, 5, 6, 9] (Total unique: 7)
2024-12-02 11:29:03,583 - INFO - religion: [1, 2, 3, 4, 5, 6, 7, 8, 9] (Total unique: 9)
2024-12-02 11:29:03,583 - INFO - economic_activity: ['8', '1', '7', '3', '9', '2', 'X', '6', '4', '5'] (Total unique: 10)
2024-12-02 11:29:03,583 - INFO - occupation: ['8', '1', '7', '3', '9', 'X', '4', '6', '2', '5'] (Total unique: 10)
2024-12-02 11:29:03,583 - INFO - industry: ['12', '8', '4', '10', '1', '7', '3', '9', '13', 'X', '11', '6', '2', '5'] (Total unique: 14)
2024-12-02 11:29:03,583 - INFO - hours_worked_per_week: ['1', '3', '2', 'X', '4'] (Total unique: 5)
2024-12-02 11:29:03,583 - INFO - approximate_social_grade: ['1', '3', '2', 'X', '11', '4'] (Total unique: 6)
2024-12-02 11:29:03,583 - INFO - Starting data cleaning process...
2024-12-02 11:29:03,636 - INFO - Processing batch 1...
2024-12-02 11:29:03,636 - INFO - =====Checking for duplicate rows:=====
2024-12-02 11:29:03,668 - ERROR - Failed! 1 duplicate rows detected.
2024-12-02 11:29:03,668 - INFO - 
Duplicate rows:
2024-12-02 11:29:03,692 - INFO -    record_number     region residence_type family_composition  sex  age  marital_status  student  country_of_birth  health  ethnic_group  religion economic_activity occupation industry hours_worked_per_week approximate_social_grade
5              5  S92000003              P                  4    2    4               4        2                 1       2             1         1                 1          3       11                     3                        2
2024-12-02 11:29:03,702 - INFO - Total rows in file: 63390
2024-12-02 11:29:03,716 - INFO -        record_number     region  ... hours_worked_per_week approximate_social_grade
21                21  S92000003  ...                     X                        2
29                29  S92000003  ...                     3                      NaN
48                48  S92000003  ...                     X                        2
49                49  S92000003  ...                     X                        2
86                86  S92000003  ...                     X                        1
...              ...        ...  ...                   ...                      ...
63296          63296  S92000003  ...                     X                        2
63318          63318  S92000003  ...                     X                        2
63351          63351  S92000003  ...                     X                        4
63367          63367  S92000003  ...                     X                        2
63384          63384  S92000003  ...                     X                        3

[2600 rows x 17 columns]
2024-12-02 11:29:03,727 - INFO - Rule 1: Found 2600 rows to delete, saved to data/rule_1_deleted_data.csv
2024-12-02 11:29:03,741 - INFO - Rule 2: No rows to delete
2024-12-02 11:29:03,756 - INFO - Rule 3: Found 842 rows to delete, saved to data/rule_3_deleted_data.csv
2024-12-02 11:29:03,786 - INFO - Rule 4: Found 2362 rows to delete, saved to data/rule_4_deleted_data.csv
2024-12-02 11:29:03,796 - INFO - Rule 5: No rows to delete
2024-12-02 11:29:03,811 - INFO - Rule 6: Found 842 rows to delete, saved to data/rule_6_deleted_data.csv
2024-12-02 11:29:03,823 - INFO - 'record_number' column reset.
2024-12-02 11:29:04,072 - INFO - Progress saved to /cs/home/sz92/Documents/CS5002/P3/code/progress.json.
2024-12-02 11:29:04,072 - INFO - Data cleaning process completed. Total rows processed: 63389
2024-12-02 11:29:04,073 - INFO - Rows to drop: 5299
2024-12-02 11:29:04,073 - INFO - Cleaned data saved to ../data/output.csv
2024-12-02 11:29:04,073 - INFO - Progress file removed. Data processing complete.
2024-12-02 11:29:04,727 - INFO - Data clean code test pass. Congratulation!
2024-12-02 11:31:14,820 - WARNING - Progress file progress.json not found. Starting from the beginning.
2024-12-02 11:31:14,887 - INFO - Loaded data from row 0.
2024-12-02 11:31:14,888 - INFO - Columns in DataFrame: ['record_number', 'region', 'residence_type', 'family_composition', 'sex', 'age', 'marital_status', 'student', 'country_of_birth', 'health', 'ethnic_group', 'religion', 'economic_activity', 'occupation', 'industry', 'hours_worked_per_week', 'approximate_social_grade']
2024-12-02 11:31:14,888 - WARNING - Progress file progress.json not found. Starting from the beginning.
2024-12-02 11:31:14,941 - INFO - =====Checking data types:=====
2024-12-02 11:31:14,961 - INFO - Batch info:
None
2024-12-02 11:31:15,224 - INFO - =====Checking for missing value:=====
2024-12-02 11:31:15,242 - WARNING - Missing values detected:
Record_Number               0
Region                      0
RESIDENCE_TYPE              0
Family_Composition          0
sex                         0
age                         0
Marital_Status              0
student                     0
Country_Of_Birth            0
health                      0
Ethnic_Group                0
religion                    0
Economic_Activity           0
Occupation                  0
industry                    0
Hours_Worked_Per_Week       0
Approximate_Social_Grade    5
dtype: int64
2024-12-02 11:31:15,261 - WARNING - Column 'approximate_social_grade': missing values at indices [1, 27, 29, 42273, 42441]
2024-12-02 11:31:15,280 - INFO - Rows to drop:
       record_number     region residence_type family_composition  sex  age  marital_status  student  country_of_birth  health  ethnic_group  religion economic_activity occupation industry hours_worked_per_week approximate_social_grade
1                  2  S92000003              P                  0    1    3               1        2                 1       2             1         1                 1          1        8                     3                      NaN
27                27  S92000003              P                  1    2    4               2        2                 1       2             2         2                 1          6       11                     4                      NaN
29                29  S92000003              P                  2    6    2               2        1                 2       1             2         1                 6          4        2                     3                      NaN
42273          42273  S92000003              C                  X    1    6               1        2                 1       3             1         2                 X          X        X                     X                      NaN
42441          42441  S92000003              C                  X    2    8               5        1                 2       1             9         5                 X          X        X                     X                      NaN
2024-12-02 11:31:15,280 - INFO - =====Checking for duplicate rows:=====
2024-12-02 11:31:15,303 - ERROR - Failed! 1 duplicate rows detected.
2024-12-02 11:31:15,303 - INFO - 
Duplicate rows:
2024-12-02 11:31:15,328 - INFO -    record_number     region residence_type family_composition  sex  age  marital_status  student  country_of_birth  health  ethnic_group  religion economic_activity occupation industry hours_worked_per_week approximate_social_grade
5              5  S92000003              P                  4    2    4               4        2                 1       2             1         1                 1          3       11                     3                        2
2024-12-02 11:31:15,328 - INFO - =====Verifying 'record_number' uniqueness:=====
2024-12-02 11:31:15,328 - INFO - Columns in batch: ['record_number', 'region', 'residence_type', 'family_composition', 'sex', 'age', 'marital_status', 'student', 'country_of_birth', 'health', 'ethnic_group', 'religion', 'economic_activity', 'occupation', 'industry', 'hours_worked_per_week', 'approximate_social_grade']
2024-12-02 11:31:15,330 - ERROR - Failed! 'record_number' is not unique. Duplicate record numbers: [5]
2024-12-02 11:31:15,330 - INFO - 
Duplicate rows:
2024-12-02 11:31:15,333 - INFO -    record_number     region residence_type family_composition  sex  age  marital_status  student  country_of_birth  health  ethnic_group  religion economic_activity occupation industry hours_worked_per_week approximate_social_grade
5              5  S92000003              P                  4    2    4               4        2                 1       2             1         1                 1          3       11                     3                        2
2024-12-02 11:31:15,333 - INFO - =====validate_data_ranges:=====
2024-12-02 11:31:15,415 - INFO - 
Broken records in column 'sex':
2024-12-02 11:31:15,416 - INFO -     sex
29    6
2024-12-02 11:31:15,416 - ERROR - Failed! Column 'sex' contains invalid values: [6]
2024-12-02 11:31:15,661 - INFO - 
Broken records in column 'ethnic_group':
2024-12-02 11:31:15,662 - INFO -        ethnic_group
42441             9
2024-12-02 11:31:15,663 - ERROR - Failed! Column 'ethnic_group' contains invalid values: [9]
2024-12-02 11:31:15,808 - INFO - 
Broken records in column 'approximate_social_grade':
2024-12-02 11:31:15,809 - INFO -       approximate_social_grade
0                           11
1                          NaN
27                         NaN
29                         NaN
42273                      NaN
42441                      NaN
2024-12-02 11:31:15,809 - ERROR - Failed! Column 'approximate_social_grade' contains invalid values: ['11', nan]
2024-12-02 11:31:15,809 - INFO - 
Unique categories and counts per column:
2024-12-02 11:31:15,809 - INFO - residence_type: ['C', 'P'] (Total unique: 2)
2024-12-02 11:31:15,809 - INFO - family_composition: ['5', 'X', '4', '3', '0', '2', '1'] (Total unique: 7)
2024-12-02 11:31:15,809 - INFO - sex: [1, 2, 6] (Total unique: 3)
2024-12-02 11:31:15,809 - INFO - age: [1, 2, 3, 4, 5, 6, 7, 8] (Total unique: 8)
2024-12-02 11:31:15,809 - INFO - marital_status: [1, 2, 3, 4, 5] (Total unique: 5)
2024-12-02 11:31:15,809 - INFO - student: [1, 2] (Total unique: 2)
2024-12-02 11:31:15,809 - INFO - country_of_birth: [1, 2] (Total unique: 2)
2024-12-02 11:31:15,809 - INFO - health: [1, 2, 3, 4, 5] (Total unique: 5)
2024-12-02 11:31:15,809 - INFO - ethnic_group: [1, 2, 3, 4, 5, 6, 9] (Total unique: 7)
2024-12-02 11:31:15,810 - INFO - religion: [1, 2, 3, 4, 5, 6, 7, 8, 9] (Total unique: 9)
2024-12-02 11:31:15,810 - INFO - economic_activity: ['5', '8', 'X', '4', '3', '7', '9', '2', '6', '1'] (Total unique: 10)
2024-12-02 11:31:15,810 - INFO - occupation: ['5', '8', 'X', '4', '3', '7', '9', '2', '6', '1'] (Total unique: 10)
2024-12-02 11:31:15,810 - INFO - industry: ['8', '5', 'X', '4', '10', '3', '11', '9', '7', '2', '13', '12', '6', '1'] (Total unique: 14)
2024-12-02 11:31:15,810 - INFO - hours_worked_per_week: ['X', '4', '3', '2', '1'] (Total unique: 5)
2024-12-02 11:31:15,810 - INFO - approximate_social_grade: ['X', '4', '3', '11', '2', '1'] (Total unique: 6)
2024-12-02 11:31:15,810 - INFO - Starting data cleaning process...
2024-12-02 11:31:15,866 - INFO - Processing batch 1...
2024-12-02 11:31:15,867 - INFO - =====Checking for duplicate rows:=====
2024-12-02 11:31:15,898 - ERROR - Failed! 1 duplicate rows detected.
2024-12-02 11:31:15,898 - INFO - 
Duplicate rows:
2024-12-02 11:31:15,924 - INFO -    record_number     region residence_type family_composition  sex  age  marital_status  student  country_of_birth  health  ethnic_group  religion economic_activity occupation industry hours_worked_per_week approximate_social_grade
5              5  S92000003              P                  4    2    4               4        2                 1       2             1         1                 1          3       11                     3                        2
2024-12-02 11:31:15,933 - INFO - Total rows in file: 63390
2024-12-02 11:31:15,949 - INFO -        record_number     region  ... hours_worked_per_week approximate_social_grade
21                21  S92000003  ...                     X                        2
29                29  S92000003  ...                     3                      NaN
48                48  S92000003  ...                     X                        2
49                49  S92000003  ...                     X                        2
86                86  S92000003  ...                     X                        1
...              ...        ...  ...                   ...                      ...
63296          63296  S92000003  ...                     X                        2
63318          63318  S92000003  ...                     X                        2
63351          63351  S92000003  ...                     X                        4
63367          63367  S92000003  ...                     X                        2
63384          63384  S92000003  ...                     X                        3

[2600 rows x 17 columns]
2024-12-02 11:31:15,960 - INFO - Rule 1: Found 2600 rows to delete, saved to data/rule_1_deleted_data.csv
2024-12-02 11:31:15,966 - INFO - Rule 2: No rows to delete
2024-12-02 11:31:15,978 - INFO - Rule 3: Found 842 rows to delete, saved to data/rule_3_deleted_data.csv
2024-12-02 11:31:15,993 - INFO - Rule 4: Found 2362 rows to delete, saved to data/rule_4_deleted_data.csv
2024-12-02 11:31:15,999 - INFO - Rule 5: No rows to delete
2024-12-02 11:31:16,011 - INFO - Rule 6: Found 842 rows to delete, saved to data/rule_6_deleted_data.csv
2024-12-02 11:31:16,023 - INFO - 'record_number' column reset.
2024-12-02 11:31:16,208 - INFO - Progress saved to /cs/home/sz92/Documents/CS5002/P3/code/progress.json.
2024-12-02 11:31:16,208 - INFO - Data cleaning process completed. Total rows processed: 63389
2024-12-02 11:31:16,208 - INFO - Rows to drop: 5299
2024-12-02 11:31:16,208 - INFO - Cleaned data saved to ../data/output.csv
2024-12-02 11:31:16,209 - INFO - Progress file removed. Data processing complete.
2024-12-02 11:31:16,806 - INFO - Data clean code test pass. Congratulation!
2024-12-02 11:38:27,914 - WARNING - Progress file progress.json not found. Starting from the beginning.
2024-12-02 11:38:27,981 - INFO - Loaded data from row 0.
2024-12-02 11:38:27,981 - INFO - Columns in DataFrame: ['record_number', 'region', 'residence_type', 'family_composition', 'sex', 'age', 'marital_status', 'student', 'country_of_birth', 'health', 'ethnic_group', 'religion', 'economic_activity', 'occupation', 'industry', 'hours_worked_per_week', 'approximate_social_grade']
2024-12-02 11:38:27,981 - WARNING - Progress file progress.json not found. Starting from the beginning.
2024-12-02 11:38:28,034 - INFO - =====Checking data types:=====
2024-12-02 11:38:28,055 - INFO - Batch info:
None
2024-12-02 11:38:28,318 - INFO - =====Checking for missing value:=====
2024-12-02 11:38:28,337 - WARNING - Missing values detected:
Record_Number               0
Region                      0
RESIDENCE_TYPE              0
Family_Composition          0
sex                         0
age                         0
Marital_Status              0
student                     0
Country_Of_Birth            0
health                      0
Ethnic_Group                0
religion                    0
Economic_Activity           0
Occupation                  0
industry                    0
Hours_Worked_Per_Week       0
Approximate_Social_Grade    5
dtype: int64
2024-12-02 11:38:28,357 - WARNING - Column 'approximate_social_grade': missing values at indices [1, 27, 29, 42273, 42441]
2024-12-02 11:38:28,376 - INFO - Rows to drop:
       record_number     region residence_type family_composition  sex  age  marital_status  student  country_of_birth  health  ethnic_group  religion economic_activity occupation industry hours_worked_per_week approximate_social_grade
1                  2  S92000003              P                  0    1    3               1        2                 1       2             1         1                 1          1        8                     3                      NaN
27                27  S92000003              P                  1    2    4               2        2                 1       2             2         2                 1          6       11                     4                      NaN
29                29  S92000003              P                  2    6    2               2        1                 2       1             2         1                 6          4        2                     3                      NaN
42273          42273  S92000003              C                  X    1    6               1        2                 1       3             1         2                 X          X        X                     X                      NaN
42441          42441  S92000003              C                  X    2    8               5        1                 2       1             9         5                 X          X        X                     X                      NaN
2024-12-02 11:38:28,376 - INFO - =====Checking for duplicate rows:=====
2024-12-02 11:38:28,399 - ERROR - Failed! 1 duplicate rows detected.
2024-12-02 11:38:28,399 - INFO - 
Duplicate rows:
2024-12-02 11:38:28,424 - INFO -    record_number     region residence_type family_composition  sex  age  marital_status  student  country_of_birth  health  ethnic_group  religion economic_activity occupation industry hours_worked_per_week approximate_social_grade
5              5  S92000003              P                  4    2    4               4        2                 1       2             1         1                 1          3       11                     3                        2
2024-12-02 11:38:28,424 - INFO - =====Verifying 'record_number' uniqueness:=====
2024-12-02 11:38:28,424 - INFO - Columns in batch: ['record_number', 'region', 'residence_type', 'family_composition', 'sex', 'age', 'marital_status', 'student', 'country_of_birth', 'health', 'ethnic_group', 'religion', 'economic_activity', 'occupation', 'industry', 'hours_worked_per_week', 'approximate_social_grade']
2024-12-02 11:38:28,425 - ERROR - Failed! 'record_number' is not unique. Duplicate record numbers: [5]
2024-12-02 11:38:28,426 - INFO - 
Duplicate rows:
2024-12-02 11:38:28,428 - INFO -    record_number     region residence_type family_composition  sex  age  marital_status  student  country_of_birth  health  ethnic_group  religion economic_activity occupation industry hours_worked_per_week approximate_social_grade
5              5  S92000003              P                  4    2    4               4        2                 1       2             1         1                 1          3       11                     3                        2
2024-12-02 11:38:28,429 - INFO - =====validate_data_ranges:=====
2024-12-02 11:38:28,513 - INFO - 
Broken records in column 'sex':
2024-12-02 11:38:28,514 - INFO -     sex
29    6
2024-12-02 11:38:28,514 - ERROR - Failed! Column 'sex' contains invalid values: [6]
2024-12-02 11:38:28,760 - INFO - 
Broken records in column 'ethnic_group':
2024-12-02 11:38:28,761 - INFO -        ethnic_group
42441             9
2024-12-02 11:38:28,762 - ERROR - Failed! Column 'ethnic_group' contains invalid values: [9]
2024-12-02 11:38:28,913 - INFO - 
Broken records in column 'approximate_social_grade':
2024-12-02 11:38:28,914 - INFO -       approximate_social_grade
0                           11
1                          NaN
27                         NaN
29                         NaN
42273                      NaN
42441                      NaN
2024-12-02 11:38:28,915 - ERROR - Failed! Column 'approximate_social_grade' contains invalid values: ['11', nan]
2024-12-02 11:38:28,915 - INFO - 
Unique categories and counts per column:
2024-12-02 11:38:28,915 - INFO - residence_type: ['P', 'C'] (Total unique: 2)
2024-12-02 11:38:28,915 - INFO - family_composition: ['1', '3', '2', '0', '4', '5', 'X'] (Total unique: 7)
2024-12-02 11:38:28,915 - INFO - sex: [1, 2, 6] (Total unique: 3)
2024-12-02 11:38:28,915 - INFO - age: [1, 2, 3, 4, 5, 6, 7, 8] (Total unique: 8)
2024-12-02 11:38:28,915 - INFO - marital_status: [1, 2, 3, 4, 5] (Total unique: 5)
2024-12-02 11:38:28,915 - INFO - student: [1, 2] (Total unique: 2)
2024-12-02 11:38:28,915 - INFO - country_of_birth: [1, 2] (Total unique: 2)
2024-12-02 11:38:28,915 - INFO - health: [1, 2, 3, 4, 5] (Total unique: 5)
2024-12-02 11:38:28,915 - INFO - ethnic_group: [1, 2, 3, 4, 5, 6, 9] (Total unique: 7)
2024-12-02 11:38:28,915 - INFO - religion: [1, 2, 3, 4, 5, 6, 7, 8, 9] (Total unique: 9)
2024-12-02 11:38:28,915 - INFO - economic_activity: ['6', '7', '1', '8', '9', '3', '2', '4', '5', 'X'] (Total unique: 10)
2024-12-02 11:38:28,915 - INFO - occupation: ['6', '8', '1', '7', '3', '9', '2', '4', '5', 'X'] (Total unique: 10)
2024-12-02 11:38:28,915 - INFO - industry: ['6', '8', '7', '1', '5', '13', '10', '9', '3', '2', '4', '12', '11', 'X'] (Total unique: 14)
2024-12-02 11:38:28,915 - INFO - hours_worked_per_week: ['1', '3', '2', '4', 'X'] (Total unique: 5)
2024-12-02 11:38:28,915 - INFO - approximate_social_grade: ['1', '3', '2', '4', '11', 'X'] (Total unique: 6)
2024-12-02 11:38:28,915 - INFO - Starting data cleaning process...
2024-12-02 11:38:28,971 - INFO - Processing batch 1...
2024-12-02 11:38:28,971 - INFO - =====Checking for duplicate rows:=====
2024-12-02 11:38:29,003 - ERROR - Failed! 1 duplicate rows detected.
2024-12-02 11:38:29,003 - INFO - 
Duplicate rows:
2024-12-02 11:38:29,030 - INFO -    record_number     region residence_type family_composition  sex  age  marital_status  student  country_of_birth  health  ethnic_group  religion economic_activity occupation industry hours_worked_per_week approximate_social_grade
5              5  S92000003              P                  4    2    4               4        2                 1       2             1         1                 1          3       11                     3                        2
2024-12-02 11:38:29,039 - INFO - Total rows in file: 63390
2024-12-02 11:38:29,055 - INFO -        record_number     region  ... hours_worked_per_week approximate_social_grade
21                21  S92000003  ...                     X                        2
29                29  S92000003  ...                     3                      NaN
48                48  S92000003  ...                     X                        2
49                49  S92000003  ...                     X                        2
86                86  S92000003  ...                     X                        1
...              ...        ...  ...                   ...                      ...
63296          63296  S92000003  ...                     X                        2
63318          63318  S92000003  ...                     X                        2
63351          63351  S92000003  ...                     X                        4
63367          63367  S92000003  ...                     X                        2
63384          63384  S92000003  ...                     X                        3

[2600 rows x 17 columns]
2024-12-02 11:38:29,066 - INFO - Rule 1: Found 2600 rows to delete, saved to data/rule_1_deleted_data.csv
2024-12-02 11:38:29,073 - INFO - Rule 2: No rows to delete
2024-12-02 11:38:29,084 - INFO - Rule 3: Found 842 rows to delete, saved to data/rule_3_deleted_data.csv
2024-12-02 11:38:29,319 - INFO - Rule 4: Found 2362 rows to delete, saved to data/rule_4_deleted_data.csv
2024-12-02 11:38:29,337 - INFO - Rule 5: No rows to delete
2024-12-02 11:38:29,356 - INFO - Rule 6: Found 842 rows to delete, saved to data/rule_6_deleted_data.csv
2024-12-02 11:38:29,371 - INFO - 'record_number' column reset.
2024-12-02 11:38:29,560 - INFO - Progress saved to /cs/home/sz92/Documents/CS5002/P3/code/progress.json.
2024-12-02 11:38:29,561 - INFO - Data cleaning process completed. Total rows processed: 63389
2024-12-02 11:38:29,561 - INFO - Rows to drop: 5299
2024-12-02 11:38:29,561 - INFO - Cleaned data saved to ../data/output.csv
2024-12-02 11:38:29,562 - INFO - Progress file removed. Data processing complete.
2024-12-02 11:38:30,118 - INFO - Data clean code test pass. Congratulation!
2024-12-02 11:43:03,775 - WARNING - Progress file progress.json not found. Starting from the beginning.
2024-12-02 11:43:03,845 - INFO - Loaded data from row 0.
2024-12-02 11:43:03,845 - INFO - Columns in DataFrame: ['record_number', 'region', 'residence_type', 'family_composition', 'sex', 'age', 'marital_status', 'student', 'country_of_birth', 'health', 'ethnic_group', 'religion', 'economic_activity', 'occupation', 'industry', 'hours_worked_per_week', 'approximate_social_grade']
2024-12-02 11:43:03,845 - WARNING - Progress file progress.json not found. Starting from the beginning.
2024-12-02 11:43:03,899 - INFO - =====Checking data types:=====
2024-12-02 11:43:03,920 - INFO - Batch info:
None
2024-12-02 11:43:04,182 - INFO - =====Checking for missing value:=====
2024-12-02 11:43:04,200 - WARNING - Missing values detected:
Record_Number               0
Region                      0
RESIDENCE_TYPE              0
Family_Composition          0
sex                         0
age                         0
Marital_Status              0
student                     0
Country_Of_Birth            0
health                      0
Ethnic_Group                0
religion                    0
Economic_Activity           0
Occupation                  0
industry                    0
Hours_Worked_Per_Week       0
Approximate_Social_Grade    5
dtype: int64
2024-12-02 11:43:04,220 - WARNING - Column 'approximate_social_grade': missing values at indices [1, 27, 29, 42273, 42441]
2024-12-02 11:43:04,238 - INFO - Rows to drop:
       record_number     region residence_type family_composition  sex  age  marital_status  student  country_of_birth  health  ethnic_group  religion economic_activity occupation industry hours_worked_per_week approximate_social_grade
1                  2  S92000003              P                  0    1    3               1        2                 1       2             1         1                 1          1        8                     3                      NaN
27                27  S92000003              P                  1    2    4               2        2                 1       2             2         2                 1          6       11                     4                      NaN
29                29  S92000003              P                  2    6    2               2        1                 2       1             2         1                 6          4        2                     3                      NaN
42273          42273  S92000003              C                  X    1    6               1        2                 1       3             1         2                 X          X        X                     X                      NaN
42441          42441  S92000003              C                  X    2    8               5        1                 2       1             9         5                 X          X        X                     X                      NaN
2024-12-02 11:43:04,238 - INFO - =====Checking for duplicate rows:=====
2024-12-02 11:43:04,262 - ERROR - Failed! 1 duplicate rows detected.
2024-12-02 11:43:04,262 - INFO - 
Duplicate rows:
2024-12-02 11:43:04,288 - INFO -    record_number     region residence_type family_composition  sex  age  marital_status  student  country_of_birth  health  ethnic_group  religion economic_activity occupation industry hours_worked_per_week approximate_social_grade
5              5  S92000003              P                  4    2    4               4        2                 1       2             1         1                 1          3       11                     3                        2
2024-12-02 11:43:04,288 - INFO - =====Verifying 'record_number' uniqueness:=====
2024-12-02 11:43:04,288 - INFO - Columns in batch: ['record_number', 'region', 'residence_type', 'family_composition', 'sex', 'age', 'marital_status', 'student', 'country_of_birth', 'health', 'ethnic_group', 'religion', 'economic_activity', 'occupation', 'industry', 'hours_worked_per_week', 'approximate_social_grade']
2024-12-02 11:43:04,290 - ERROR - Failed! 'record_number' is not unique. Duplicate record numbers: [5]
2024-12-02 11:43:04,290 - INFO - 
Duplicate rows:
2024-12-02 11:43:04,293 - INFO -    record_number     region residence_type family_composition  sex  age  marital_status  student  country_of_birth  health  ethnic_group  religion economic_activity occupation industry hours_worked_per_week approximate_social_grade
5              5  S92000003              P                  4    2    4               4        2                 1       2             1         1                 1          3       11                     3                        2
2024-12-02 11:43:04,293 - INFO - =====validate_data_ranges:=====
2024-12-02 11:43:04,373 - INFO - 
Broken records in column 'sex':
2024-12-02 11:43:04,374 - INFO -     sex
29    6
2024-12-02 11:43:04,375 - ERROR - Failed! Column 'sex' contains invalid values: [6]
2024-12-02 11:43:04,621 - INFO - 
Broken records in column 'ethnic_group':
2024-12-02 11:43:04,622 - INFO -        ethnic_group
42441             9
2024-12-02 11:43:04,622 - ERROR - Failed! Column 'ethnic_group' contains invalid values: [9]
2024-12-02 11:43:04,770 - INFO - 
Broken records in column 'approximate_social_grade':
2024-12-02 11:43:04,771 - INFO -       approximate_social_grade
0                           11
1                          NaN
27                         NaN
29                         NaN
42273                      NaN
42441                      NaN
2024-12-02 11:43:04,772 - ERROR - Failed! Column 'approximate_social_grade' contains invalid values: ['11', nan]
2024-12-02 11:43:04,772 - INFO - 
Unique categories and counts per column:
2024-12-02 11:43:04,772 - INFO - residence_type: ['P', 'C'] (Total unique: 2)
2024-12-02 11:43:04,772 - INFO - family_composition: ['1', '4', '2', '3', 'X', '5', '0'] (Total unique: 7)
2024-12-02 11:43:04,772 - INFO - sex: [1, 2, 6] (Total unique: 3)
2024-12-02 11:43:04,772 - INFO - age: [1, 2, 3, 4, 5, 6, 7, 8] (Total unique: 8)
2024-12-02 11:43:04,772 - INFO - marital_status: [1, 2, 3, 4, 5] (Total unique: 5)
2024-12-02 11:43:04,772 - INFO - student: [1, 2] (Total unique: 2)
2024-12-02 11:43:04,772 - INFO - country_of_birth: [1, 2] (Total unique: 2)
2024-12-02 11:43:04,772 - INFO - health: [1, 2, 3, 4, 5] (Total unique: 5)
2024-12-02 11:43:04,772 - INFO - ethnic_group: [1, 2, 3, 4, 5, 6, 9] (Total unique: 7)
2024-12-02 11:43:04,772 - INFO - religion: [1, 2, 3, 4, 5, 6, 7, 8, 9] (Total unique: 9)
2024-12-02 11:43:04,772 - INFO - economic_activity: ['1', '6', '9', '4', '2', '3', 'X', '5', '7', '8'] (Total unique: 10)
2024-12-02 11:43:04,772 - INFO - occupation: ['1', '6', '4', '9', '2', '3', 'X', '5', '7', '8'] (Total unique: 10)
2024-12-02 11:43:04,772 - INFO - industry: ['6', '10', '13', '1', '12', '11', '9', '4', '2', '3', 'X', '5', '7', '8'] (Total unique: 14)
2024-12-02 11:43:04,772 - INFO - hours_worked_per_week: ['1', '4', '2', '3', 'X'] (Total unique: 5)
2024-12-02 11:43:04,772 - INFO - approximate_social_grade: ['1', '11', '4', '2', '3', 'X'] (Total unique: 6)
2024-12-02 11:43:04,772 - INFO - Starting data cleaning process...
2024-12-02 11:43:04,829 - INFO - Processing batch 1...
2024-12-02 11:43:04,829 - INFO - =====Checking for duplicate rows:=====
2024-12-02 11:43:04,862 - ERROR - Failed! 1 duplicate rows detected.
2024-12-02 11:43:04,862 - INFO - 
Duplicate rows:
2024-12-02 11:43:04,888 - INFO -    record_number     region residence_type family_composition  sex  age  marital_status  student  country_of_birth  health  ethnic_group  religion economic_activity occupation industry hours_worked_per_week approximate_social_grade
5              5  S92000003              P                  4    2    4               4        2                 1       2             1         1                 1          3       11                     3                        2
2024-12-02 11:43:04,896 - INFO - Total rows in file: 63390
2024-12-02 11:43:04,911 - INFO -        record_number     region  ... hours_worked_per_week approximate_social_grade
21                21  S92000003  ...                     X                        2
29                29  S92000003  ...                     3                      NaN
48                48  S92000003  ...                     X                        2
49                49  S92000003  ...                     X                        2
86                86  S92000003  ...                     X                        1
...              ...        ...  ...                   ...                      ...
63296          63296  S92000003  ...                     X                        2
63318          63318  S92000003  ...                     X                        2
63351          63351  S92000003  ...                     X                        4
63367          63367  S92000003  ...                     X                        2
63384          63384  S92000003  ...                     X                        3

[2600 rows x 17 columns]
2024-12-02 11:43:04,922 - INFO - Rule 1: Found 2600 rows to delete, saved to data/rule_1_deleted_data.csv
2024-12-02 11:43:04,928 - INFO - Rule 2: No rows to delete
2024-12-02 11:43:05,084 - INFO - Rule 3: Found 842 rows to delete, saved to data/rule_3_deleted_data.csv
2024-12-02 11:43:05,164 - INFO - Rule 4: Found 2362 rows to delete, saved to data/rule_4_deleted_data.csv
2024-12-02 11:43:05,183 - INFO - Rule 5: No rows to delete
2024-12-02 11:43:05,205 - INFO - Rule 6: Found 842 rows to delete, saved to data/rule_6_deleted_data.csv
2024-12-02 11:43:05,224 - INFO - 'record_number' column reset.
2024-12-02 11:43:05,415 - INFO - Progress saved to /cs/home/sz92/Documents/CS5002/P3/code/progress.json.
2024-12-02 11:43:05,416 - INFO - Data cleaning process completed. Total rows processed: 63389
2024-12-02 11:43:05,416 - INFO - Rows to drop: 5299
2024-12-02 11:43:05,416 - INFO - Cleaned data saved to ../data/output.csv
2024-12-02 11:43:05,416 - INFO - Progress file removed. Data processing complete.
2024-12-02 11:43:06,018 - INFO - Data clean code test pass. Congratulation!
2024-12-02 11:44:53,773 - WARNING - Progress file progress.json not found. Starting from the beginning.
2024-12-02 11:44:53,841 - INFO - Loaded data from row 0.
2024-12-02 11:44:53,842 - INFO - Columns in DataFrame: ['record_number', 'region', 'residence_type', 'family_composition', 'sex', 'age', 'marital_status', 'student', 'country_of_birth', 'health', 'ethnic_group', 'religion', 'economic_activity', 'occupation', 'industry', 'hours_worked_per_week', 'approximate_social_grade']
2024-12-02 11:44:53,842 - WARNING - Progress file progress.json not found. Starting from the beginning.
2024-12-02 11:44:53,893 - INFO - =====Checking data types:=====
2024-12-02 11:44:53,915 - INFO - Batch info:
None
2024-12-02 11:44:54,178 - INFO - =====Checking for missing value:=====
2024-12-02 11:44:54,196 - WARNING - Missing values detected:
Record_Number               0
Region                      0
RESIDENCE_TYPE              0
Family_Composition          0
sex                         0
age                         0
Marital_Status              0
student                     0
Country_Of_Birth            0
health                      0
Ethnic_Group                0
religion                    0
Economic_Activity           0
Occupation                  0
industry                    0
Hours_Worked_Per_Week       0
Approximate_Social_Grade    5
dtype: int64
2024-12-02 11:44:54,216 - WARNING - Column 'approximate_social_grade': missing values at indices [1, 27, 29, 42273, 42441]
2024-12-02 11:44:54,234 - INFO - Rows to drop:
       record_number     region residence_type family_composition  sex  age  marital_status  student  country_of_birth  health  ethnic_group  religion economic_activity occupation industry hours_worked_per_week approximate_social_grade
1                  2  S92000003              P                  0    1    3               1        2                 1       2             1         1                 1          1        8                     3                      NaN
27                27  S92000003              P                  1    2    4               2        2                 1       2             2         2                 1          6       11                     4                      NaN
29                29  S92000003              P                  2    6    2               2        1                 2       1             2         1                 6          4        2                     3                      NaN
42273          42273  S92000003              C                  X    1    6               1        2                 1       3             1         2                 X          X        X                     X                      NaN
42441          42441  S92000003              C                  X    2    8               5        1                 2       1             9         5                 X          X        X                     X                      NaN
2024-12-02 11:44:54,234 - INFO - =====Checking for duplicate rows:=====
2024-12-02 11:44:54,258 - ERROR - Failed! 1 duplicate rows detected.
2024-12-02 11:44:54,258 - INFO - 
Duplicate rows:
2024-12-02 11:44:54,284 - INFO -    record_number     region residence_type family_composition  sex  age  marital_status  student  country_of_birth  health  ethnic_group  religion economic_activity occupation industry hours_worked_per_week approximate_social_grade
5              5  S92000003              P                  4    2    4               4        2                 1       2             1         1                 1          3       11                     3                        2
2024-12-02 11:44:54,284 - INFO - =====Verifying 'record_number' uniqueness:=====
2024-12-02 11:44:54,284 - INFO - Columns in batch: ['record_number', 'region', 'residence_type', 'family_composition', 'sex', 'age', 'marital_status', 'student', 'country_of_birth', 'health', 'ethnic_group', 'religion', 'economic_activity', 'occupation', 'industry', 'hours_worked_per_week', 'approximate_social_grade']
2024-12-02 11:44:54,286 - ERROR - Failed! 'record_number' is not unique. Duplicate record numbers: [5]
2024-12-02 11:44:54,286 - INFO - 
Duplicate rows:
2024-12-02 11:44:54,289 - INFO -    record_number     region residence_type family_composition  sex  age  marital_status  student  country_of_birth  health  ethnic_group  religion economic_activity occupation industry hours_worked_per_week approximate_social_grade
5              5  S92000003              P                  4    2    4               4        2                 1       2             1         1                 1          3       11                     3                        2
2024-12-02 11:44:54,289 - INFO - =====validate_data_ranges:=====
2024-12-02 11:44:54,370 - INFO - 
Broken records in column 'sex':
2024-12-02 11:44:54,371 - INFO -     sex
29    6
2024-12-02 11:44:54,371 - ERROR - Failed! Column 'sex' contains invalid values: [6]
2024-12-02 11:44:54,612 - INFO - 
Broken records in column 'ethnic_group':
2024-12-02 11:44:54,613 - INFO -        ethnic_group
42441             9
2024-12-02 11:44:54,614 - ERROR - Failed! Column 'ethnic_group' contains invalid values: [9]
2024-12-02 11:44:54,765 - INFO - 
Broken records in column 'approximate_social_grade':
2024-12-02 11:44:54,766 - INFO -       approximate_social_grade
0                           11
1                          NaN
27                         NaN
29                         NaN
42273                      NaN
42441                      NaN
2024-12-02 11:44:54,766 - ERROR - Failed! Column 'approximate_social_grade' contains invalid values: ['11', nan]
2024-12-02 11:44:54,767 - INFO - 
Unique categories and counts per column:
2024-12-02 11:44:54,767 - INFO - residence_type: ['C', 'P'] (Total unique: 2)
2024-12-02 11:44:54,767 - INFO - family_composition: ['1', '3', '0', '4', '2', 'X', '5'] (Total unique: 7)
2024-12-02 11:44:54,767 - INFO - sex: [1, 2, 6] (Total unique: 3)
2024-12-02 11:44:54,767 - INFO - age: [1, 2, 3, 4, 5, 6, 7, 8] (Total unique: 8)
2024-12-02 11:44:54,767 - INFO - marital_status: [1, 2, 3, 4, 5] (Total unique: 5)
2024-12-02 11:44:54,767 - INFO - student: [1, 2] (Total unique: 2)
2024-12-02 11:44:54,767 - INFO - country_of_birth: [1, 2] (Total unique: 2)
2024-12-02 11:44:54,767 - INFO - health: [1, 2, 3, 4, 5] (Total unique: 5)
2024-12-02 11:44:54,767 - INFO - ethnic_group: [1, 2, 3, 4, 5, 6, 9] (Total unique: 7)
2024-12-02 11:44:54,767 - INFO - religion: [1, 2, 3, 4, 5, 6, 7, 8, 9] (Total unique: 9)
2024-12-02 11:44:54,767 - INFO - economic_activity: ['1', '3', '4', 'X', '2', '6', '5', '7', '8', '9'] (Total unique: 10)
2024-12-02 11:44:54,767 - INFO - occupation: ['1', '3', '4', '2', 'X', '5', '6', '7', '8', '9'] (Total unique: 10)
2024-12-02 11:44:54,767 - INFO - industry: ['1', '3', '13', '12', '10', '4', 'X', '2', '5', '6', '7', '8', '9', '11'] (Total unique: 14)
2024-12-02 11:44:54,767 - INFO - hours_worked_per_week: ['1', '3', '4', '2', 'X'] (Total unique: 5)
2024-12-02 11:44:54,767 - INFO - approximate_social_grade: ['1', '3', '4', '2', 'X', '11'] (Total unique: 6)
2024-12-02 11:44:54,767 - INFO - Starting data cleaning process...
2024-12-02 11:44:54,822 - INFO - Processing batch 1...
2024-12-02 11:44:54,822 - INFO - =====Checking for duplicate rows:=====
2024-12-02 11:44:54,853 - ERROR - Failed! 1 duplicate rows detected.
2024-12-02 11:44:54,853 - INFO - 
Duplicate rows:
2024-12-02 11:44:54,880 - INFO -    record_number     region residence_type family_composition  sex  age  marital_status  student  country_of_birth  health  ethnic_group  religion economic_activity occupation industry hours_worked_per_week approximate_social_grade
5              5  S92000003              P                  4    2    4               4        2                 1       2             1         1                 1          3       11                     3                        2
2024-12-02 11:44:54,888 - INFO - Total rows in file: 63390
2024-12-02 11:44:54,903 - INFO -        record_number     region  ... hours_worked_per_week approximate_social_grade
21                21  S92000003  ...                     X                        2
29                29  S92000003  ...                     3                      NaN
48                48  S92000003  ...                     X                        2
49                49  S92000003  ...                     X                        2
86                86  S92000003  ...                     X                        1
...              ...        ...  ...                   ...                      ...
63296          63296  S92000003  ...                     X                        2
63318          63318  S92000003  ...                     X                        2
63351          63351  S92000003  ...                     X                        4
63367          63367  S92000003  ...                     X                        2
63384          63384  S92000003  ...                     X                        3

[2600 rows x 17 columns]
2024-12-02 11:44:54,914 - INFO - Rule 1: Found 2600 rows to delete, saved to data/rule_1_deleted_data.csv
2024-12-02 11:44:54,920 - INFO - Rule 2: No rows to delete
2024-12-02 11:44:54,931 - INFO - Rule 3: Found 842 rows to delete, saved to data/rule_3_deleted_data.csv
2024-12-02 11:44:54,949 - INFO - Rule 4: Found 2362 rows to delete, saved to data/rule_4_deleted_data.csv
2024-12-02 11:44:54,955 - INFO - Rule 5: No rows to delete
2024-12-02 11:44:54,966 - INFO - Rule 6: Found 842 rows to delete, saved to data/rule_6_deleted_data.csv
2024-12-02 11:44:54,978 - INFO - 'record_number' column reset.
2024-12-02 11:44:55,158 - INFO - Progress saved to /cs/home/sz92/Documents/CS5002/P3/code/progress.json.
2024-12-02 11:44:55,158 - INFO - Data cleaning process completed. Total rows processed: 63389
2024-12-02 11:44:55,158 - INFO - Rows to drop: 5299
2024-12-02 11:44:55,158 - INFO - Cleaned data saved to ../data/output.csv
2024-12-02 11:44:55,159 - INFO - Progress file removed. Data processing complete.
2024-12-02 11:44:55,746 - INFO - Data clean code test pass. Congratulation!
2024-12-02 11:55:29,751 - WARNING - Progress file progress.json not found. Starting from the beginning.
2024-12-02 11:55:29,816 - INFO - Loaded data from row 0.
2024-12-02 11:55:29,817 - INFO - Columns in DataFrame: ['record_number', 'region', 'residence_type', 'family_composition', 'sex', 'age', 'marital_status', 'student', 'country_of_birth', 'health', 'ethnic_group', 'religion', 'economic_activity', 'occupation', 'industry', 'hours_worked_per_week', 'approximate_social_grade']
2024-12-02 11:55:29,817 - WARNING - Progress file progress.json not found. Starting from the beginning.
2024-12-02 11:55:29,869 - INFO - =====Checking data types:=====
2024-12-02 11:55:29,889 - INFO - Batch info:
None
2024-12-02 11:55:30,144 - INFO - =====Checking for missing value:=====
2024-12-02 11:55:30,161 - WARNING - Missing values detected:
Record_Number               0
Region                      0
RESIDENCE_TYPE              0
Family_Composition          0
sex                         0
age                         0
Marital_Status              0
student                     0
Country_Of_Birth            0
health                      0
Ethnic_Group                0
religion                    0
Economic_Activity           0
Occupation                  0
industry                    0
Hours_Worked_Per_Week       0
Approximate_Social_Grade    5
dtype: int64
2024-12-02 11:55:30,180 - WARNING - Column 'approximate_social_grade': missing values at indices [1, 27, 29, 42273, 42441]
2024-12-02 11:55:30,199 - INFO - Rows to drop:
       record_number     region residence_type family_composition  sex  age  marital_status  student  country_of_birth  health  ethnic_group  religion economic_activity occupation industry hours_worked_per_week approximate_social_grade
1                  2  S92000003              P                  0    1    3               1        2                 1       2             1         1                 1          1        8                     3                      NaN
27                27  S92000003              P                  1    2    4               2        2                 1       2             2         2                 1          6       11                     4                      NaN
29                29  S92000003              P                  2    6    2               2        1                 2       1             2         1                 6          4        2                     3                      NaN
42273          42273  S92000003              C                  X    1    6               1        2                 1       3             1         2                 X          X        X                     X                      NaN
42441          42441  S92000003              C                  X    2    8               5        1                 2       1             9         5                 X          X        X                     X                      NaN
2024-12-02 11:55:30,199 - INFO - =====Checking for duplicate rows:=====
2024-12-02 11:55:30,224 - ERROR - Failed! 1 duplicate rows detected.
2024-12-02 11:55:30,224 - INFO - 
Duplicate rows:
2024-12-02 11:55:30,249 - INFO -    record_number     region residence_type family_composition  sex  age  marital_status  student  country_of_birth  health  ethnic_group  religion economic_activity occupation industry hours_worked_per_week approximate_social_grade
5              5  S92000003              P                  4    2    4               4        2                 1       2             1         1                 1          3       11                     3                        2
2024-12-02 11:55:30,249 - INFO - =====Verifying 'record_number' uniqueness:=====
2024-12-02 11:55:30,249 - INFO - Columns in batch: ['record_number', 'region', 'residence_type', 'family_composition', 'sex', 'age', 'marital_status', 'student', 'country_of_birth', 'health', 'ethnic_group', 'religion', 'economic_activity', 'occupation', 'industry', 'hours_worked_per_week', 'approximate_social_grade']
2024-12-02 11:55:30,251 - ERROR - Failed! 'record_number' is not unique. Duplicate record numbers: [5]
2024-12-02 11:55:30,251 - INFO - 
Duplicate rows:
2024-12-02 11:55:30,254 - INFO -    record_number     region residence_type family_composition  sex  age  marital_status  student  country_of_birth  health  ethnic_group  religion economic_activity occupation industry hours_worked_per_week approximate_social_grade
5              5  S92000003              P                  4    2    4               4        2                 1       2             1         1                 1          3       11                     3                        2
2024-12-02 11:55:30,254 - INFO - =====validate_data_ranges:=====
2024-12-02 11:55:30,336 - INFO - 
Broken records in column 'sex':
2024-12-02 11:55:30,337 - INFO -     sex
29    6
2024-12-02 11:55:30,337 - ERROR - Failed! Column 'sex' contains invalid values: [6]
2024-12-02 11:55:30,584 - INFO - 
Broken records in column 'ethnic_group':
2024-12-02 11:55:30,585 - INFO -        ethnic_group
42441             9
2024-12-02 11:55:30,586 - ERROR - Failed! Column 'ethnic_group' contains invalid values: [9]
2024-12-02 11:55:30,729 - INFO - 
Broken records in column 'approximate_social_grade':
2024-12-02 11:55:30,730 - INFO -       approximate_social_grade
0                           11
1                          NaN
27                         NaN
29                         NaN
42273                      NaN
42441                      NaN
2024-12-02 11:55:30,731 - ERROR - Failed! Column 'approximate_social_grade' contains invalid values: ['11', nan]
2024-12-02 11:55:30,731 - INFO - 
Unique categories and counts per column:
2024-12-02 11:55:30,731 - INFO - residence_type: ['C', 'P'] (Total unique: 2)
2024-12-02 11:55:30,731 - INFO - family_composition: ['0', '1', 'X', '3', '2', '5', '4'] (Total unique: 7)
2024-12-02 11:55:30,731 - INFO - sex: [1, 2, 6] (Total unique: 3)
2024-12-02 11:55:30,731 - INFO - age: [1, 2, 3, 4, 5, 6, 7, 8] (Total unique: 8)
2024-12-02 11:55:30,731 - INFO - marital_status: [1, 2, 3, 4, 5] (Total unique: 5)
2024-12-02 11:55:30,731 - INFO - student: [1, 2] (Total unique: 2)
2024-12-02 11:55:30,731 - INFO - country_of_birth: [1, 2] (Total unique: 2)
2024-12-02 11:55:30,731 - INFO - health: [1, 2, 3, 4, 5] (Total unique: 5)
2024-12-02 11:55:30,731 - INFO - ethnic_group: [1, 2, 3, 4, 5, 6, 9] (Total unique: 7)
2024-12-02 11:55:30,731 - INFO - religion: [1, 2, 3, 4, 5, 6, 7, 8, 9] (Total unique: 9)
2024-12-02 11:55:30,731 - INFO - economic_activity: ['9', '8', '1', '7', 'X', '3', '2', '5', '4', '6'] (Total unique: 10)
2024-12-02 11:55:30,731 - INFO - occupation: ['9', '8', '1', '7', 'X', '3', '2', '5', '4', '6'] (Total unique: 10)
2024-12-02 11:55:30,731 - INFO - industry: ['11', '13', '9', '8', '1', '7', 'X', '10', '12', '3', '2', '5', '4', '6'] (Total unique: 14)
2024-12-02 11:55:30,731 - INFO - hours_worked_per_week: ['1', 'X', '3', '2', '4'] (Total unique: 5)
2024-12-02 11:55:30,731 - INFO - approximate_social_grade: ['1', 'X', '3', '2', '11', '4'] (Total unique: 6)
2024-12-02 11:55:30,731 - INFO - Starting data cleaning process...
2024-12-02 11:55:30,786 - INFO - Processing batch 1...
2024-12-02 11:55:30,787 - INFO - =====Checking for duplicate rows:=====
2024-12-02 11:55:30,819 - ERROR - Failed! 1 duplicate rows detected.
2024-12-02 11:55:30,819 - INFO - 
Duplicate rows:
2024-12-02 11:55:30,844 - INFO -    record_number     region residence_type family_composition  sex  age  marital_status  student  country_of_birth  health  ethnic_group  religion economic_activity occupation industry hours_worked_per_week approximate_social_grade
5              5  S92000003              P                  4    2    4               4        2                 1       2             1         1                 1          3       11                     3                        2
2024-12-02 11:55:30,853 - INFO - Total rows in file: 63390
2024-12-02 11:55:30,869 - INFO -        record_number     region  ... hours_worked_per_week approximate_social_grade
21                21  S92000003  ...                     X                        2
29                29  S92000003  ...                     3                      NaN
48                48  S92000003  ...                     X                        2
49                49  S92000003  ...                     X                        2
86                86  S92000003  ...                     X                        1
...              ...        ...  ...                   ...                      ...
63296          63296  S92000003  ...                     X                        2
63318          63318  S92000003  ...                     X                        2
63351          63351  S92000003  ...                     X                        4
63367          63367  S92000003  ...                     X                        2
63384          63384  S92000003  ...                     X                        3

[2600 rows x 17 columns]
2024-12-02 11:55:30,879 - INFO - Rule 1: Found 2600 rows to delete, saved to data/rule_1_deleted_data.csv
2024-12-02 11:55:30,886 - INFO - Rule 2: No rows to delete
2024-12-02 11:55:30,899 - INFO - Rule 3: Found 842 rows to delete, saved to data/rule_3_deleted_data.csv
2024-12-02 11:55:30,916 - INFO - Rule 4: Found 2362 rows to delete, saved to data/rule_4_deleted_data.csv
2024-12-02 11:55:30,922 - INFO - Rule 5: No rows to delete
2024-12-02 11:55:30,956 - INFO - Rule 6: Found 842 rows to delete, saved to data/rule_6_deleted_data.csv
2024-12-02 11:55:30,983 - INFO - 'record_number' column reset.
2024-12-02 11:55:31,164 - INFO - Batch 1 cleaned and saved.
2024-12-02 11:55:31,167 - INFO - Progress saved to /cs/home/sz92/Documents/CS5002/P3/code/progress.json.
2024-12-02 11:55:31,167 - INFO - Data cleaning process completed. Total rows processed: 63389
2024-12-02 11:55:31,167 - INFO - Rows to drop: 5299
2024-12-02 11:55:31,167 - INFO - Cleaned data saved to ../data/output.csv
2024-12-02 11:55:31,168 - INFO - Progress file removed. Data processing complete.
2024-12-02 11:55:31,758 - INFO - Data clean code test pass. Congratulation!
2024-12-02 12:15:28,818 - WARNING - Progress file progress.json not found. Starting from the beginning.
2024-12-02 12:15:28,894 - INFO - Loaded data from row 0.
2024-12-02 12:15:28,894 - INFO - Columns in DataFrame: ['record_number', 'region', 'residence_type', 'family_composition', 'sex', 'age', 'marital_status', 'student', 'country_of_birth', 'health', 'ethnic_group', 'religion', 'economic_activity', 'occupation', 'industry', 'hours_worked_per_week', 'approximate_social_grade']
2024-12-02 12:15:28,894 - WARNING - Progress file progress.json not found. Starting from the beginning.
2024-12-02 12:15:28,946 - INFO - =====Checking data types:=====
2024-12-02 12:15:28,968 - INFO - Batch info:
None
2024-12-02 12:15:29,228 - INFO - =====Checking for missing value:=====
2024-12-02 12:15:29,246 - WARNING - Missing values detected:
Record_Number               0
Region                      0
RESIDENCE_TYPE              0
Family_Composition          0
sex                         0
age                         0
Marital_Status              0
student                     0
Country_Of_Birth            0
health                      0
Ethnic_Group                0
religion                    0
Economic_Activity           0
Occupation                  0
industry                    0
Hours_Worked_Per_Week       0
Approximate_Social_Grade    5
dtype: int64
2024-12-02 12:15:29,266 - WARNING - Column 'approximate_social_grade': missing values at indices [1, 27, 29, 42273, 42441]
2024-12-02 12:15:29,285 - INFO - Rows to drop:
       record_number     region residence_type family_composition  sex  age  marital_status  student  country_of_birth  health  ethnic_group  religion economic_activity occupation industry hours_worked_per_week approximate_social_grade
1                  2  S92000003              P                  0    1    3               1        2                 1       2             1         1                 1          1        8                     3                      NaN
27                27  S92000003              P                  1    2    4               2        2                 1       2             2         2                 1          6       11                     4                      NaN
29                29  S92000003              P                  2    6    2               2        1                 2       1             2         1                 6          4        2                     3                      NaN
42273          42273  S92000003              C                  X    1    6               1        2                 1       3             1         2                 X          X        X                     X                      NaN
42441          42441  S92000003              C                  X    2    8               5        1                 2       1             9         5                 X          X        X                     X                      NaN
2024-12-02 12:15:29,285 - INFO - =====Checking for duplicate rows:=====
2024-12-02 12:15:29,307 - ERROR - Failed! 1 duplicate rows detected.
2024-12-02 12:15:29,307 - INFO - 
Duplicate rows:
2024-12-02 12:15:29,332 - INFO -    record_number     region residence_type family_composition  sex  age  marital_status  student  country_of_birth  health  ethnic_group  religion economic_activity occupation industry hours_worked_per_week approximate_social_grade
5              5  S92000003              P                  4    2    4               4        2                 1       2             1         1                 1          3       11                     3                        2
2024-12-02 12:15:29,332 - INFO - =====Verifying 'record_number' uniqueness:=====
2024-12-02 12:15:29,332 - INFO - Columns in batch: ['record_number', 'region', 'residence_type', 'family_composition', 'sex', 'age', 'marital_status', 'student', 'country_of_birth', 'health', 'ethnic_group', 'religion', 'economic_activity', 'occupation', 'industry', 'hours_worked_per_week', 'approximate_social_grade']
2024-12-02 12:15:29,334 - ERROR - Failed! 'record_number' is not unique. Duplicate record numbers: [5]
2024-12-02 12:15:29,334 - INFO - 
Duplicate rows:
2024-12-02 12:15:29,337 - INFO -    record_number     region residence_type family_composition  sex  age  marital_status  student  country_of_birth  health  ethnic_group  religion economic_activity occupation industry hours_worked_per_week approximate_social_grade
5              5  S92000003              P                  4    2    4               4        2                 1       2             1         1                 1          3       11                     3                        2
2024-12-02 12:15:29,337 - INFO - =====validate_data_ranges:=====
2024-12-02 12:15:29,415 - INFO - 
Broken records in column 'sex':
2024-12-02 12:15:29,416 - INFO -     sex
29    6
2024-12-02 12:15:29,417 - ERROR - Failed! Column 'sex' contains invalid values: [6]
2024-12-02 12:15:29,659 - INFO - 
Broken records in column 'ethnic_group':
2024-12-02 12:15:29,660 - INFO -        ethnic_group
42441             9
2024-12-02 12:15:29,661 - ERROR - Failed! Column 'ethnic_group' contains invalid values: [9]
2024-12-02 12:15:29,806 - INFO - 
Broken records in column 'approximate_social_grade':
2024-12-02 12:15:29,807 - INFO -       approximate_social_grade
0                           11
1                          NaN
27                         NaN
29                         NaN
42273                      NaN
42441                      NaN
2024-12-02 12:15:29,807 - ERROR - Failed! Column 'approximate_social_grade' contains invalid values: ['11', nan]
2024-12-02 12:15:29,808 - INFO - 
Unique categories and counts per column:
2024-12-02 12:15:29,808 - INFO - residence_type: ['C', 'P'] (Total unique: 2)
2024-12-02 12:15:29,808 - INFO - family_composition: ['3', 'X', '0', '4', '5', '2', '1'] (Total unique: 7)
2024-12-02 12:15:29,808 - INFO - sex: [1, 2, 6] (Total unique: 3)
2024-12-02 12:15:29,808 - INFO - age: [1, 2, 3, 4, 5, 6, 7, 8] (Total unique: 8)
2024-12-02 12:15:29,808 - INFO - marital_status: [1, 2, 3, 4, 5] (Total unique: 5)
2024-12-02 12:15:29,808 - INFO - student: [1, 2] (Total unique: 2)
2024-12-02 12:15:29,808 - INFO - country_of_birth: [1, 2] (Total unique: 2)
2024-12-02 12:15:29,808 - INFO - health: [1, 2, 3, 4, 5] (Total unique: 5)
2024-12-02 12:15:29,808 - INFO - ethnic_group: [1, 2, 3, 4, 5, 6, 9] (Total unique: 7)
2024-12-02 12:15:29,808 - INFO - religion: [1, 2, 3, 4, 5, 6, 7, 8, 9] (Total unique: 9)
2024-12-02 12:15:29,808 - INFO - economic_activity: ['9', '8', '3', 'X', '4', '7', '5', '6', '2', '1'] (Total unique: 10)
2024-12-02 12:15:29,808 - INFO - occupation: ['9', '8', '3', 'X', '4', '7', '5', '2', '6', '1'] (Total unique: 10)
2024-12-02 12:15:29,808 - INFO - industry: ['10', '9', '8', '3', '13', 'X', '4', '7', '5', '11', '2', '6', '12', '1'] (Total unique: 14)
2024-12-02 12:15:29,808 - INFO - hours_worked_per_week: ['3', 'X', '4', '2', '1'] (Total unique: 5)
2024-12-02 12:15:29,808 - INFO - approximate_social_grade: ['3', 'X', '4', '11', '2', '1'] (Total unique: 6)
2024-12-02 12:15:29,808 - INFO - Starting data cleaning process...
2024-12-02 12:15:29,877 - INFO - Total rows in file: 63390
2024-12-02 12:15:29,879 - WARNING - 'record_number' column not found. No reset performed.
2024-12-02 12:15:30,137 - INFO - Cleaned data saved to ../data/output.csv
2024-12-02 12:15:30,141 - INFO - Progress saved to /cs/home/sz92/Documents/CS5002/P3/code/progress.json.
2024-12-02 12:15:30,141 - INFO - Data cleaning process completed. Total rows processed: 63389
2024-12-02 12:15:30,141 - INFO - Rows to drop: 0
2024-12-02 12:15:30,141 - INFO - Cleaned data saved to ../data/output.csv
2024-12-02 12:15:30,142 - INFO - Progress file removed. Data processing complete.
2024-12-02 12:15:30,742 - INFO - Data clean code test pass. Congratulation!
2024-12-02 12:24:35,579 - WARNING - Progress file progress.json not found. Starting from the beginning.
2024-12-02 12:24:35,647 - INFO - Loaded data from row 0.
2024-12-02 12:24:35,647 - INFO - Columns in DataFrame: ['record_number', 'region', 'residence_type', 'family_composition', 'sex', 'age', 'marital_status', 'student', 'country_of_birth', 'health', 'ethnic_group', 'religion', 'economic_activity', 'occupation', 'industry', 'hours_worked_per_week', 'approximate_social_grade']
2024-12-02 12:24:35,648 - WARNING - Progress file progress.json not found. Starting from the beginning.
2024-12-02 12:24:35,704 - INFO - =====Checking data types:=====
2024-12-02 12:24:35,726 - INFO - Batch info:
None
2024-12-02 12:24:35,991 - INFO - =====Checking for missing value:=====
2024-12-02 12:24:36,009 - WARNING - Missing values detected:
Record_Number               0
Region                      0
RESIDENCE_TYPE              0
Family_Composition          0
sex                         0
age                         0
Marital_Status              0
student                     0
Country_Of_Birth            0
health                      0
Ethnic_Group                0
religion                    0
Economic_Activity           0
Occupation                  0
industry                    0
Hours_Worked_Per_Week       0
Approximate_Social_Grade    5
dtype: int64
2024-12-02 12:24:36,029 - WARNING - Column 'approximate_social_grade': missing values at indices [1, 27, 29, 42273, 42441]
2024-12-02 12:24:36,049 - INFO - Rows to drop:
       record_number     region residence_type family_composition  sex  age  marital_status  student  country_of_birth  health  ethnic_group  religion economic_activity occupation industry hours_worked_per_week approximate_social_grade
1                  2  S92000003              P                  0    1    3               1        2                 1       2             1         1                 1          1        8                     3                      NaN
27                27  S92000003              P                  1    2    4               2        2                 1       2             2         2                 1          6       11                     4                      NaN
29                29  S92000003              P                  2    6    2               2        1                 2       1             2         1                 6          4        2                     3                      NaN
42273          42273  S92000003              C                  X    1    6               1        2                 1       3             1         2                 X          X        X                     X                      NaN
42441          42441  S92000003              C                  X    2    8               5        1                 2       1             9         5                 X          X        X                     X                      NaN
2024-12-02 12:24:36,049 - INFO - =====Checking for duplicate rows:=====
2024-12-02 12:24:36,073 - ERROR - Failed! 1 duplicate rows detected.
2024-12-02 12:24:36,073 - INFO - 
Duplicate rows:
2024-12-02 12:24:36,099 - INFO -    record_number     region residence_type family_composition  sex  age  marital_status  student  country_of_birth  health  ethnic_group  religion economic_activity occupation industry hours_worked_per_week approximate_social_grade
5              5  S92000003              P                  4    2    4               4        2                 1       2             1         1                 1          3       11                     3                        2
2024-12-02 12:24:36,099 - INFO - =====Verifying 'record_number' uniqueness:=====
2024-12-02 12:24:36,099 - INFO - Columns in batch: ['record_number', 'region', 'residence_type', 'family_composition', 'sex', 'age', 'marital_status', 'student', 'country_of_birth', 'health', 'ethnic_group', 'religion', 'economic_activity', 'occupation', 'industry', 'hours_worked_per_week', 'approximate_social_grade']
2024-12-02 12:24:36,101 - ERROR - Failed! 'record_number' is not unique. Duplicate record numbers: [5]
2024-12-02 12:24:36,101 - INFO - 
Duplicate rows:
2024-12-02 12:24:36,104 - INFO -    record_number     region residence_type family_composition  sex  age  marital_status  student  country_of_birth  health  ethnic_group  religion economic_activity occupation industry hours_worked_per_week approximate_social_grade
5              5  S92000003              P                  4    2    4               4        2                 1       2             1         1                 1          3       11                     3                        2
2024-12-02 12:24:36,104 - INFO - =====validate_data_ranges:=====
2024-12-02 12:24:36,184 - INFO - 
Broken records in column 'sex':
2024-12-02 12:24:36,185 - INFO -     sex
29    6
2024-12-02 12:24:36,185 - ERROR - Failed! Column 'sex' contains invalid values: [6]
2024-12-02 12:24:36,431 - INFO - 
Broken records in column 'ethnic_group':
2024-12-02 12:24:36,432 - INFO -        ethnic_group
42441             9
2024-12-02 12:24:36,432 - ERROR - Failed! Column 'ethnic_group' contains invalid values: [9]
2024-12-02 12:24:36,582 - INFO - 
Broken records in column 'approximate_social_grade':
2024-12-02 12:24:36,583 - INFO -       approximate_social_grade
0                           11
1                          NaN
27                         NaN
29                         NaN
42273                      NaN
42441                      NaN
2024-12-02 12:24:36,583 - ERROR - Failed! Column 'approximate_social_grade' contains invalid values: ['11', nan]
2024-12-02 12:24:36,583 - INFO - 
Unique categories and counts per column:
2024-12-02 12:24:36,583 - INFO - residence_type: ['C', 'P'] (Total unique: 2)
2024-12-02 12:24:36,583 - INFO - family_composition: ['1', '2', '5', 'X', '4', '0', '3'] (Total unique: 7)
2024-12-02 12:24:36,583 - INFO - sex: [1, 2, 6] (Total unique: 3)
2024-12-02 12:24:36,584 - INFO - age: [1, 2, 3, 4, 5, 6, 7, 8] (Total unique: 8)
2024-12-02 12:24:36,584 - INFO - marital_status: [1, 2, 3, 4, 5] (Total unique: 5)
2024-12-02 12:24:36,584 - INFO - student: [1, 2] (Total unique: 2)
2024-12-02 12:24:36,584 - INFO - country_of_birth: [1, 2] (Total unique: 2)
2024-12-02 12:24:36,584 - INFO - health: [1, 2, 3, 4, 5] (Total unique: 5)
2024-12-02 12:24:36,584 - INFO - ethnic_group: [1, 2, 3, 4, 5, 6, 9] (Total unique: 7)
2024-12-02 12:24:36,584 - INFO - religion: [1, 2, 3, 4, 5, 6, 7, 8, 9] (Total unique: 9)
2024-12-02 12:24:36,584 - INFO - economic_activity: ['1', '2', '5', 'X', '6', '4', '7', '9', '3', '8'] (Total unique: 10)
2024-12-02 12:24:36,584 - INFO - occupation: ['1', '2', '5', 'X', '6', '4', '7', '9', '3', '8'] (Total unique: 10)
2024-12-02 12:24:36,584 - INFO - industry: ['1', '2', '5', 'X', '6', '4', '12', '11', '10', '7', '9', '3', '13', '8'] (Total unique: 14)
2024-12-02 12:24:36,584 - INFO - hours_worked_per_week: ['1', '2', 'X', '4', '3'] (Total unique: 5)
2024-12-02 12:24:36,584 - INFO - approximate_social_grade: ['1', '2', 'X', '4', '11', '3'] (Total unique: 6)
2024-12-02 12:24:36,584 - INFO - Starting data cleaning process...
2024-12-02 12:24:36,638 - INFO - Processing batch 1...
2024-12-02 12:24:36,638 - INFO - =====Checking for duplicate rows:=====
2024-12-02 12:24:36,669 - ERROR - Failed! 1 duplicate rows detected.
2024-12-02 12:24:36,670 - INFO - 
Duplicate rows:
2024-12-02 12:24:36,696 - INFO -    record_number     region residence_type family_composition  sex  age  marital_status  student  country_of_birth  health  ethnic_group  religion economic_activity occupation industry hours_worked_per_week approximate_social_grade
5              5  S92000003              P                  4    2    4               4        2                 1       2             1         1                 1          3       11                     3                        2
2024-12-02 12:24:36,705 - INFO - Total rows in file: 63390
2024-12-02 12:24:36,721 - INFO -        record_number     region  ... hours_worked_per_week approximate_social_grade
21                21  S92000003  ...                     X                        2
29                29  S92000003  ...                     3                      NaN
48                48  S92000003  ...                     X                        2
49                49  S92000003  ...                     X                        2
86                86  S92000003  ...                     X                        1
...              ...        ...  ...                   ...                      ...
63296          63296  S92000003  ...                     X                        2
63318          63318  S92000003  ...                     X                        2
63351          63351  S92000003  ...                     X                        4
63367          63367  S92000003  ...                     X                        2
63384          63384  S92000003  ...                     X                        3

[2600 rows x 17 columns]
2024-12-02 12:24:36,731 - INFO - Rule 1: Found 2600 rows to delete, saved to data/rule_1_deleted_data.csv
2024-12-02 12:24:36,739 - INFO - Rule 2: No rows to delete
2024-12-02 12:24:36,751 - INFO - Rule 3: Found 842 rows to delete, saved to data/rule_3_deleted_data.csv
2024-12-02 12:24:36,768 - INFO - Rule 4: Found 2362 rows to delete, saved to data/rule_4_deleted_data.csv
2024-12-02 12:24:36,774 - INFO - Rule 5: No rows to delete
2024-12-02 12:24:36,786 - INFO - Rule 6: Found 842 rows to delete, saved to data/rule_6_deleted_data.csv
2024-12-02 12:24:36,799 - INFO - 'record_number' column reset.
2024-12-02 12:24:37,016 - INFO - Batch 1 cleaned and saved.
2024-12-02 12:24:37,020 - INFO - Progress saved to /cs/home/sz92/Documents/CS5002/P3/code/progress.json.
2024-12-02 12:24:37,020 - INFO - Data cleaning process completed. Total rows processed: 63389
2024-12-02 12:24:37,020 - INFO - Rows to drop: 5299
2024-12-02 12:24:37,020 - INFO - Cleaned data saved to ../data/output.csv
2024-12-02 12:24:37,021 - INFO - Progress file removed. Data processing complete.
2024-12-02 12:24:37,589 - INFO - Data clean code test pass. Congratulation!
2024-12-02 12:26:37,123 - WARNING - Progress file progress.json not found. Starting from the beginning.
2024-12-02 12:26:37,209 - INFO - Loaded data from row 0.
2024-12-02 12:26:37,210 - INFO - Columns in DataFrame: ['record_number', 'region', 'residence_type', 'family_composition', 'sex', 'age', 'marital_status', 'student', 'country_of_birth', 'health', 'ethnic_group', 'religion', 'economic_activity', 'occupation', 'industry', 'hours_worked_per_week', 'approximate_social_grade']
2024-12-02 12:26:37,210 - WARNING - Progress file progress.json not found. Starting from the beginning.
2024-12-02 12:26:37,264 - INFO - =====Checking data types:=====
2024-12-02 12:26:37,285 - INFO - Batch info:
None
2024-12-02 12:26:37,556 - INFO - =====Checking for missing value:=====
2024-12-02 12:26:37,574 - WARNING - Missing values detected:
Record_Number               0
Region                      0
RESIDENCE_TYPE              0
Family_Composition          0
sex                         0
age                         0
Marital_Status              0
student                     0
Country_Of_Birth            0
health                      0
Ethnic_Group                0
religion                    0
Economic_Activity           0
Occupation                  0
industry                    0
Hours_Worked_Per_Week       0
Approximate_Social_Grade    5
dtype: int64
2024-12-02 12:26:37,595 - WARNING - Column 'approximate_social_grade': missing values at indices [1, 27, 29, 42273, 42441]
2024-12-02 12:26:37,614 - INFO - Rows to drop:
       record_number     region residence_type family_composition  sex  age  marital_status  student  country_of_birth  health  ethnic_group  religion economic_activity occupation industry hours_worked_per_week approximate_social_grade
1                  2  S92000003              P                  0    1    3               1        2                 1       2             1         1                 1          1        8                     3                      NaN
27                27  S92000003              P                  1    2    4               2        2                 1       2             2         2                 1          6       11                     4                      NaN
29                29  S92000003              P                  2    6    2               2        1                 2       1             2         1                 6          4        2                     3                      NaN
42273          42273  S92000003              C                  X    1    6               1        2                 1       3             1         2                 X          X        X                     X                      NaN
42441          42441  S92000003              C                  X    2    8               5        1                 2       1             9         5                 X          X        X                     X                      NaN
2024-12-02 12:26:37,614 - INFO - =====Checking for duplicate rows:=====
2024-12-02 12:26:37,638 - ERROR - Failed! 1 duplicate rows detected.
2024-12-02 12:26:37,638 - INFO - 
Duplicate rows:
2024-12-02 12:26:37,663 - INFO -    record_number     region residence_type family_composition  sex  age  marital_status  student  country_of_birth  health  ethnic_group  religion economic_activity occupation industry hours_worked_per_week approximate_social_grade
5              5  S92000003              P                  4    2    4               4        2                 1       2             1         1                 1          3       11                     3                        2
2024-12-02 12:26:37,663 - INFO - =====Verifying 'record_number' uniqueness:=====
2024-12-02 12:26:37,663 - INFO - Columns in batch: ['record_number', 'region', 'residence_type', 'family_composition', 'sex', 'age', 'marital_status', 'student', 'country_of_birth', 'health', 'ethnic_group', 'religion', 'economic_activity', 'occupation', 'industry', 'hours_worked_per_week', 'approximate_social_grade']
2024-12-02 12:26:37,665 - ERROR - Failed! 'record_number' is not unique. Duplicate record numbers: [5]
2024-12-02 12:26:37,665 - INFO - 
Duplicate rows:
2024-12-02 12:26:37,668 - INFO -    record_number     region residence_type family_composition  sex  age  marital_status  student  country_of_birth  health  ethnic_group  religion economic_activity occupation industry hours_worked_per_week approximate_social_grade
5              5  S92000003              P                  4    2    4               4        2                 1       2             1         1                 1          3       11                     3                        2
2024-12-02 12:26:37,668 - INFO - =====validate_data_ranges:=====
2024-12-02 12:26:37,749 - INFO - 
Broken records in column 'sex':
2024-12-02 12:26:37,750 - INFO -     sex
29    6
2024-12-02 12:26:37,750 - ERROR - Failed! Column 'sex' contains invalid values: [6]
2024-12-02 12:26:37,997 - INFO - 
Broken records in column 'ethnic_group':
2024-12-02 12:26:37,998 - INFO -        ethnic_group
42441             9
2024-12-02 12:26:37,998 - ERROR - Failed! Column 'ethnic_group' contains invalid values: [9]
2024-12-02 12:26:38,151 - INFO - 
Broken records in column 'approximate_social_grade':
2024-12-02 12:26:38,152 - INFO -       approximate_social_grade
0                           11
1                          NaN
27                         NaN
29                         NaN
42273                      NaN
42441                      NaN
2024-12-02 12:26:38,153 - ERROR - Failed! Column 'approximate_social_grade' contains invalid values: ['11', nan]
2024-12-02 12:26:38,153 - INFO - 
Unique categories and counts per column:
2024-12-02 12:26:38,153 - INFO - residence_type: ['P', 'C'] (Total unique: 2)
2024-12-02 12:26:38,153 - INFO - family_composition: ['0', '2', '1', '5', '3', '4', 'X'] (Total unique: 7)
2024-12-02 12:26:38,153 - INFO - sex: [1, 2, 6] (Total unique: 3)
2024-12-02 12:26:38,153 - INFO - age: [1, 2, 3, 4, 5, 6, 7, 8] (Total unique: 8)
2024-12-02 12:26:38,153 - INFO - marital_status: [1, 2, 3, 4, 5] (Total unique: 5)
2024-12-02 12:26:38,153 - INFO - student: [1, 2] (Total unique: 2)
2024-12-02 12:26:38,153 - INFO - country_of_birth: [1, 2] (Total unique: 2)
2024-12-02 12:26:38,153 - INFO - health: [1, 2, 3, 4, 5] (Total unique: 5)
2024-12-02 12:26:38,153 - INFO - ethnic_group: [1, 2, 3, 4, 5, 6, 9] (Total unique: 7)
2024-12-02 12:26:38,153 - INFO - religion: [1, 2, 3, 4, 5, 6, 7, 8, 9] (Total unique: 9)
2024-12-02 12:26:38,153 - INFO - economic_activity: ['6', '2', '5', '1', '3', '4', 'X', '9', '8', '7'] (Total unique: 10)
2024-12-02 12:26:38,153 - INFO - occupation: ['6', '2', '3', '5', '1', '7', '4', 'X', '9', '8'] (Total unique: 10)
2024-12-02 12:26:38,153 - INFO - industry: ['6', '11', '2', '5', '3', '12', '7', '1', '4', '13', 'X', '9', '8', '10'] (Total unique: 14)
2024-12-02 12:26:38,153 - INFO - hours_worked_per_week: ['2', '3', '1', '4', 'X'] (Total unique: 5)
2024-12-02 12:26:38,153 - INFO - approximate_social_grade: ['11', '2', '3', '1', '4', 'X'] (Total unique: 6)
2024-12-02 12:26:38,153 - INFO - Starting data cleaning process...
2024-12-02 12:26:38,209 - INFO - Processing batch 1...
2024-12-02 12:26:38,209 - INFO - =====Checking for duplicate rows:=====
2024-12-02 12:26:38,240 - ERROR - Failed! 1 duplicate rows detected.
2024-12-02 12:26:38,240 - INFO - 
Duplicate rows:
2024-12-02 12:26:38,266 - INFO -    record_number     region residence_type family_composition  sex  age  marital_status  student  country_of_birth  health  ethnic_group  religion economic_activity occupation industry hours_worked_per_week approximate_social_grade
5              5  S92000003              P                  4    2    4               4        2                 1       2             1         1                 1          3       11                     3                        2
2024-12-02 12:26:38,275 - INFO - Total rows in file: 63390
2024-12-02 12:26:38,290 - INFO -        record_number     region  ... hours_worked_per_week approximate_social_grade
21                21  S92000003  ...                     X                        2
29                29  S92000003  ...                     3                      NaN
48                48  S92000003  ...                     X                        2
49                49  S92000003  ...                     X                        2
86                86  S92000003  ...                     X                        1
...              ...        ...  ...                   ...                      ...
63296          63296  S92000003  ...                     X                        2
63318          63318  S92000003  ...                     X                        2
63351          63351  S92000003  ...                     X                        4
63367          63367  S92000003  ...                     X                        2
63384          63384  S92000003  ...                     X                        3

[2600 rows x 17 columns]
2024-12-02 12:26:38,300 - INFO - Rule 1: Found 2600 rows to delete, saved to data/rule_1_deleted_data.csv
2024-12-02 12:26:38,307 - INFO - Rule 2: No rows to delete
2024-12-02 12:26:38,318 - INFO - Rule 3: Found 842 rows to delete, saved to data/rule_3_deleted_data.csv
2024-12-02 12:26:38,334 - INFO - Rule 4: Found 2362 rows to delete, saved to data/rule_4_deleted_data.csv
2024-12-02 12:26:38,340 - INFO - Rule 5: No rows to delete
2024-12-02 12:26:38,351 - INFO - Rule 6: Found 842 rows to delete, saved to data/rule_6_deleted_data.csv
2024-12-02 12:26:38,363 - INFO - 'record_number' column reset.
2024-12-02 12:26:38,538 - INFO - Batch 1 cleaned and saved.
2024-12-02 12:26:38,541 - INFO - Progress saved to /cs/home/sz92/Documents/CS5002/P3/code/progress.json.
2024-12-02 12:26:38,541 - INFO - Data cleaning process completed. Total rows processed: 63389
2024-12-02 12:26:38,541 - INFO - Rows to drop: 5299
2024-12-02 12:26:38,541 - INFO - Cleaned data saved to ../data/output.csv
2024-12-02 12:26:38,542 - INFO - Progress file removed. Data processing complete.
2024-12-02 12:26:39,120 - INFO - Data clean code test pass. Congratulation!
2024-12-02 12:29:19,166 - WARNING - Progress file progress.json not found. Starting from the beginning.
2024-12-02 12:29:19,232 - INFO - Loaded data from row 0.
2024-12-02 12:29:19,233 - INFO - Columns in DataFrame: ['record_number', 'region', 'residence_type', 'family_composition', 'sex', 'age', 'marital_status', 'student', 'country_of_birth', 'health', 'ethnic_group', 'religion', 'economic_activity', 'occupation', 'industry', 'hours_worked_per_week', 'approximate_social_grade']
2024-12-02 12:29:19,233 - WARNING - Progress file progress.json not found. Starting from the beginning.
2024-12-02 12:29:19,287 - INFO - =====Checking data types:=====
2024-12-02 12:29:19,308 - INFO - Batch info:
None
2024-12-02 12:29:19,561 - INFO - =====Checking for missing value:=====
2024-12-02 12:29:19,580 - WARNING - Missing values detected:
Record_Number               0
Region                      0
RESIDENCE_TYPE              0
Family_Composition          0
sex                         0
age                         0
Marital_Status              0
student                     0
Country_Of_Birth            0
health                      0
Ethnic_Group                0
religion                    0
Economic_Activity           0
Occupation                  0
industry                    0
Hours_Worked_Per_Week       0
Approximate_Social_Grade    5
dtype: int64
2024-12-02 12:29:19,599 - WARNING - Column 'approximate_social_grade': missing values at indices [1, 27, 29, 42273, 42441]
2024-12-02 12:29:19,618 - INFO - Rows to drop:
       record_number     region residence_type family_composition  sex  age  marital_status  student  country_of_birth  health  ethnic_group  religion economic_activity occupation industry hours_worked_per_week approximate_social_grade
1                  2  S92000003              P                  0    1    3               1        2                 1       2             1         1                 1          1        8                     3                      NaN
27                27  S92000003              P                  1    2    4               2        2                 1       2             2         2                 1          6       11                     4                      NaN
29                29  S92000003              P                  2    6    2               2        1                 2       1             2         1                 6          4        2                     3                      NaN
42273          42273  S92000003              C                  X    1    6               1        2                 1       3             1         2                 X          X        X                     X                      NaN
42441          42441  S92000003              C                  X    2    8               5        1                 2       1             9         5                 X          X        X                     X                      NaN
2024-12-02 12:29:19,618 - INFO - =====Checking for duplicate rows:=====
2024-12-02 12:29:19,641 - ERROR - Failed! 1 duplicate rows detected.
2024-12-02 12:29:19,641 - INFO - 
Duplicate rows:
2024-12-02 12:29:19,665 - INFO -    record_number     region residence_type family_composition  sex  age  marital_status  student  country_of_birth  health  ethnic_group  religion economic_activity occupation industry hours_worked_per_week approximate_social_grade
5              5  S92000003              P                  4    2    4               4        2                 1       2             1         1                 1          3       11                     3                        2
2024-12-02 12:29:19,665 - INFO - =====Verifying 'record_number' uniqueness:=====
2024-12-02 12:29:19,665 - INFO - Columns in batch: ['record_number', 'region', 'residence_type', 'family_composition', 'sex', 'age', 'marital_status', 'student', 'country_of_birth', 'health', 'ethnic_group', 'religion', 'economic_activity', 'occupation', 'industry', 'hours_worked_per_week', 'approximate_social_grade']
2024-12-02 12:29:19,667 - ERROR - Failed! 'record_number' is not unique. Duplicate record numbers: [5]
2024-12-02 12:29:19,667 - INFO - 
Duplicate rows:
2024-12-02 12:29:19,670 - INFO -    record_number     region residence_type family_composition  sex  age  marital_status  student  country_of_birth  health  ethnic_group  religion economic_activity occupation industry hours_worked_per_week approximate_social_grade
5              5  S92000003              P                  4    2    4               4        2                 1       2             1         1                 1          3       11                     3                        2
2024-12-02 12:29:19,670 - INFO - =====validate_data_ranges:=====
2024-12-02 12:29:19,752 - INFO - 
Broken records in column 'sex':
2024-12-02 12:29:19,753 - INFO -     sex
29    6
2024-12-02 12:29:19,753 - ERROR - Failed! Column 'sex' contains invalid values: [6]
2024-12-02 12:29:20,000 - INFO - 
Broken records in column 'ethnic_group':
2024-12-02 12:29:20,001 - INFO -        ethnic_group
42441             9
2024-12-02 12:29:20,002 - ERROR - Failed! Column 'ethnic_group' contains invalid values: [9]
2024-12-02 12:29:20,148 - INFO - 
Broken records in column 'approximate_social_grade':
2024-12-02 12:29:20,149 - INFO -       approximate_social_grade
0                           11
1                          NaN
27                         NaN
29                         NaN
42273                      NaN
42441                      NaN
2024-12-02 12:29:20,149 - ERROR - Failed! Column 'approximate_social_grade' contains invalid values: ['11', nan]
2024-12-02 12:29:20,150 - INFO - 
Unique categories and counts per column:
2024-12-02 12:29:20,150 - INFO - residence_type: ['P', 'C'] (Total unique: 2)
2024-12-02 12:29:20,150 - INFO - family_composition: ['0', '1', 'X', '2', '4', '5', '3'] (Total unique: 7)
2024-12-02 12:29:20,150 - INFO - sex: [1, 2, 6] (Total unique: 3)
2024-12-02 12:29:20,150 - INFO - age: [1, 2, 3, 4, 5, 6, 7, 8] (Total unique: 8)
2024-12-02 12:29:20,150 - INFO - marital_status: [1, 2, 3, 4, 5] (Total unique: 5)
2024-12-02 12:29:20,150 - INFO - student: [1, 2] (Total unique: 2)
2024-12-02 12:29:20,150 - INFO - country_of_birth: [1, 2] (Total unique: 2)
2024-12-02 12:29:20,150 - INFO - health: [1, 2, 3, 4, 5] (Total unique: 5)
2024-12-02 12:29:20,150 - INFO - ethnic_group: [1, 2, 3, 4, 5, 6, 9] (Total unique: 7)
2024-12-02 12:29:20,150 - INFO - religion: [1, 2, 3, 4, 5, 6, 7, 8, 9] (Total unique: 9)
2024-12-02 12:29:20,150 - INFO - economic_activity: ['X', '1', '2', '4', '3', '5', '9', '8', '6', '7'] (Total unique: 10)
2024-12-02 12:29:20,150 - INFO - occupation: ['X', '1', '2', '4', '5', '9', '7', '8', '6', '3'] (Total unique: 10)
2024-12-02 12:29:20,150 - INFO - industry: ['X', '1', '13', '2', '4', '12', '10', '3', '5', '11', '9', '8', '6', '7'] (Total unique: 14)
2024-12-02 12:29:20,150 - INFO - hours_worked_per_week: ['X', '1', '2', '4', '3'] (Total unique: 5)
2024-12-02 12:29:20,150 - INFO - approximate_social_grade: ['X', '1', '2', '4', '11', '3'] (Total unique: 6)
2024-12-02 12:29:20,150 - INFO - Starting data cleaning process...
2024-12-02 12:29:20,205 - INFO - Processing batch 1...
2024-12-02 12:29:20,215 - INFO - Total rows in file: 63390
2024-12-02 12:29:20,220 - WARNING - 'record_number' column not found. No reset performed.
2024-12-02 12:29:20,424 - INFO - Batch 1 cleaned and saved.
2024-12-02 12:29:20,428 - INFO - Progress saved to /cs/home/sz92/Documents/CS5002/P3/code/progress.json.
2024-12-02 12:29:20,428 - INFO - Data cleaning process completed. Total rows processed: 63389
2024-12-02 12:29:20,428 - INFO - Rows to drop: 0
2024-12-02 12:29:20,428 - INFO - Cleaned data saved to ../data/output.csv
2024-12-02 12:29:20,429 - INFO - Progress file removed. Data processing complete.
2024-12-02 12:29:21,053 - INFO - Data clean code test pass. Congratulation!
2024-12-02 12:30:56,978 - WARNING - Progress file progress.json not found. Starting from the beginning.
2024-12-02 12:30:57,049 - INFO - Loaded data from row 0.
2024-12-02 12:30:57,049 - INFO - Columns in DataFrame: ['record_number', 'region', 'residence_type', 'family_composition', 'sex', 'age', 'marital_status', 'student', 'country_of_birth', 'health', 'ethnic_group', 'religion', 'economic_activity', 'occupation', 'industry', 'hours_worked_per_week', 'approximate_social_grade']
2024-12-02 12:30:57,049 - WARNING - Progress file progress.json not found. Starting from the beginning.
2024-12-02 12:30:57,104 - INFO - =====Checking data types:=====
2024-12-02 12:30:57,126 - INFO - Batch info:
None
2024-12-02 12:30:57,384 - INFO - =====Checking for missing value:=====
2024-12-02 12:30:57,403 - WARNING - Missing values detected:
Record_Number               0
Region                      0
RESIDENCE_TYPE              0
Family_Composition          0
sex                         0
age                         0
Marital_Status              0
student                     0
Country_Of_Birth            0
health                      0
Ethnic_Group                0
religion                    0
Economic_Activity           0
Occupation                  0
industry                    0
Hours_Worked_Per_Week       0
Approximate_Social_Grade    5
dtype: int64
2024-12-02 12:30:57,422 - WARNING - Column 'approximate_social_grade': missing values at indices [1, 27, 29, 42273, 42441]
2024-12-02 12:30:57,441 - INFO - Rows to drop:
       record_number     region residence_type family_composition  sex  age  marital_status  student  country_of_birth  health  ethnic_group  religion economic_activity occupation industry hours_worked_per_week approximate_social_grade
1                  2  S92000003              P                  0    1    3               1        2                 1       2             1         1                 1          1        8                     3                      NaN
27                27  S92000003              P                  1    2    4               2        2                 1       2             2         2                 1          6       11                     4                      NaN
29                29  S92000003              P                  2    6    2               2        1                 2       1             2         1                 6          4        2                     3                      NaN
42273          42273  S92000003              C                  X    1    6               1        2                 1       3             1         2                 X          X        X                     X                      NaN
42441          42441  S92000003              C                  X    2    8               5        1                 2       1             9         5                 X          X        X                     X                      NaN
2024-12-02 12:30:57,441 - INFO - =====Checking for duplicate rows:=====
2024-12-02 12:30:57,464 - ERROR - Failed! 1 duplicate rows detected.
2024-12-02 12:30:57,464 - INFO - 
Duplicate rows:
2024-12-02 12:30:57,489 - INFO -    record_number     region residence_type family_composition  sex  age  marital_status  student  country_of_birth  health  ethnic_group  religion economic_activity occupation industry hours_worked_per_week approximate_social_grade
5              5  S92000003              P                  4    2    4               4        2                 1       2             1         1                 1          3       11                     3                        2
2024-12-02 12:30:57,489 - INFO - =====Verifying 'record_number' uniqueness:=====
2024-12-02 12:30:57,489 - INFO - Columns in batch: ['record_number', 'region', 'residence_type', 'family_composition', 'sex', 'age', 'marital_status', 'student', 'country_of_birth', 'health', 'ethnic_group', 'religion', 'economic_activity', 'occupation', 'industry', 'hours_worked_per_week', 'approximate_social_grade']
2024-12-02 12:30:57,491 - ERROR - Failed! 'record_number' is not unique. Duplicate record numbers: [5]
2024-12-02 12:30:57,491 - INFO - 
Duplicate rows:
2024-12-02 12:30:57,494 - INFO -    record_number     region residence_type family_composition  sex  age  marital_status  student  country_of_birth  health  ethnic_group  religion economic_activity occupation industry hours_worked_per_week approximate_social_grade
5              5  S92000003              P                  4    2    4               4        2                 1       2             1         1                 1          3       11                     3                        2
2024-12-02 12:30:57,494 - INFO - =====validate_data_ranges:=====
2024-12-02 12:30:57,575 - INFO - 
Broken records in column 'sex':
2024-12-02 12:30:57,576 - INFO -     sex
29    6
2024-12-02 12:30:57,576 - ERROR - Failed! Column 'sex' contains invalid values: [6]
2024-12-02 12:30:57,815 - INFO - 
Broken records in column 'ethnic_group':
2024-12-02 12:30:57,816 - INFO -        ethnic_group
42441             9
2024-12-02 12:30:57,817 - ERROR - Failed! Column 'ethnic_group' contains invalid values: [9]
2024-12-02 12:30:57,963 - INFO - 
Broken records in column 'approximate_social_grade':
2024-12-02 12:30:57,965 - INFO -       approximate_social_grade
0                           11
1                          NaN
27                         NaN
29                         NaN
42273                      NaN
42441                      NaN
2024-12-02 12:30:57,965 - ERROR - Failed! Column 'approximate_social_grade' contains invalid values: ['11', nan]
2024-12-02 12:30:57,965 - INFO - 
Unique categories and counts per column:
2024-12-02 12:30:57,965 - INFO - residence_type: ['P', 'C'] (Total unique: 2)
2024-12-02 12:30:57,965 - INFO - family_composition: ['1', '2', '3', 'X', '5', '0', '4'] (Total unique: 7)
2024-12-02 12:30:57,965 - INFO - sex: [1, 2, 6] (Total unique: 3)
2024-12-02 12:30:57,965 - INFO - age: [1, 2, 3, 4, 5, 6, 7, 8] (Total unique: 8)
2024-12-02 12:30:57,965 - INFO - marital_status: [1, 2, 3, 4, 5] (Total unique: 5)
2024-12-02 12:30:57,965 - INFO - student: [1, 2] (Total unique: 2)
2024-12-02 12:30:57,965 - INFO - country_of_birth: [1, 2] (Total unique: 2)
2024-12-02 12:30:57,965 - INFO - health: [1, 2, 3, 4, 5] (Total unique: 5)
2024-12-02 12:30:57,965 - INFO - ethnic_group: [1, 2, 3, 4, 5, 6, 9] (Total unique: 7)
2024-12-02 12:30:57,965 - INFO - religion: [1, 2, 3, 4, 5, 6, 7, 8, 9] (Total unique: 9)
2024-12-02 12:30:57,965 - INFO - economic_activity: ['1', '6', '2', '8', '3', '7', 'X', '5', '9', '4'] (Total unique: 10)
2024-12-02 12:30:57,965 - INFO - occupation: ['1', '6', '2', '8', '3', '7', 'X', '5', '9', '4'] (Total unique: 10)
2024-12-02 12:30:57,965 - INFO - industry: ['1', '6', '8', '2', '10', '13', '3', '12', '7', '11', 'X', '5', '9', '4'] (Total unique: 14)
2024-12-02 12:30:57,965 - INFO - hours_worked_per_week: ['1', '2', '3', 'X', '4'] (Total unique: 5)
2024-12-02 12:30:57,965 - INFO - approximate_social_grade: ['1', '2', '3', '11', 'X', '4'] (Total unique: 6)
2024-12-02 12:30:57,965 - INFO - Starting data cleaning process...
2024-12-02 12:30:58,022 - INFO - Processing batch 1...
2024-12-02 12:30:58,023 - INFO - =====Checking for duplicate rows:=====
2024-12-02 12:30:58,055 - ERROR - Failed! 1 duplicate rows detected.
2024-12-02 12:30:58,055 - INFO - 
Duplicate rows:
2024-12-02 12:30:58,080 - INFO -    record_number     region residence_type family_composition  sex  age  marital_status  student  country_of_birth  health  ethnic_group  religion economic_activity occupation industry hours_worked_per_week approximate_social_grade
5              5  S92000003              P                  4    2    4               4        2                 1       2             1         1                 1          3       11                     3                        2
2024-12-02 12:30:58,089 - INFO - Total rows in file: 63390
2024-12-02 12:30:58,104 - INFO -        record_number     region  ... hours_worked_per_week approximate_social_grade
21                21  S92000003  ...                     X                        2
29                29  S92000003  ...                     3                      NaN
48                48  S92000003  ...                     X                        2
49                49  S92000003  ...                     X                        2
86                86  S92000003  ...                     X                        1
...              ...        ...  ...                   ...                      ...
63296          63296  S92000003  ...                     X                        2
63318          63318  S92000003  ...                     X                        2
63351          63351  S92000003  ...                     X                        4
63367          63367  S92000003  ...                     X                        2
63384          63384  S92000003  ...                     X                        3

[2600 rows x 17 columns]
2024-12-02 12:30:58,115 - INFO - Rule 1: Found 2600 rows to delete, saved to data/rule_1_deleted_data.csv
2024-12-02 12:30:58,121 - INFO - Rule 2: No rows to delete
2024-12-02 12:30:58,133 - INFO - Rule 3: Found 842 rows to delete, saved to data/rule_3_deleted_data.csv
2024-12-02 12:30:58,149 - INFO - Rule 4: Found 2362 rows to delete, saved to data/rule_4_deleted_data.csv
2024-12-02 12:30:58,155 - INFO - Rule 5: No rows to delete
2024-12-02 12:30:58,167 - INFO - Rule 6: Found 842 rows to delete, saved to data/rule_6_deleted_data.csv
2024-12-02 12:30:58,194 - INFO - 'record_number' column reset.
2024-12-02 12:30:58,369 - INFO - Batch 1 cleaned and saved.
2024-12-02 12:30:58,372 - INFO - Progress saved to /cs/home/sz92/Documents/CS5002/P3/code/progress.json.
2024-12-02 12:30:58,372 - INFO - Data cleaning process completed. Total rows processed: 63389
2024-12-02 12:30:58,372 - INFO - Rows to drop: 5299
2024-12-02 12:30:58,372 - INFO - Cleaned data saved to ../data/output.csv
2024-12-02 12:30:58,373 - INFO - Progress file removed. Data processing complete.
2024-12-02 12:30:58,972 - INFO - Data clean code test pass. Congratulation!
2024-12-02 12:33:52,390 - WARNING - Progress file progress.json not found. Starting from the beginning.
2024-12-02 12:33:52,456 - INFO - Loaded data from row 0.
2024-12-02 12:33:52,456 - INFO - Columns in DataFrame: ['record_number', 'region', 'residence_type', 'family_composition', 'sex', 'age', 'marital_status', 'student', 'country_of_birth', 'health', 'ethnic_group', 'religion', 'economic_activity', 'occupation', 'industry', 'hours_worked_per_week', 'approximate_social_grade']
2024-12-02 12:33:52,456 - WARNING - Progress file progress.json not found. Starting from the beginning.
2024-12-02 12:33:52,509 - INFO - =====Checking data types:=====
2024-12-02 12:33:52,529 - INFO - Batch info:
None
2024-12-02 12:33:52,790 - INFO - =====Checking for missing value:=====
2024-12-02 12:33:52,809 - WARNING - Missing values detected:
Record_Number               0
Region                      0
RESIDENCE_TYPE              0
Family_Composition          0
sex                         0
age                         0
Marital_Status              0
student                     0
Country_Of_Birth            0
health                      0
Ethnic_Group                0
religion                    0
Economic_Activity           0
Occupation                  0
industry                    0
Hours_Worked_Per_Week       0
Approximate_Social_Grade    5
dtype: int64
2024-12-02 12:33:52,829 - WARNING - Column 'approximate_social_grade': missing values at indices [1, 27, 29, 42273, 42441]
2024-12-02 12:33:52,847 - INFO - Rows to drop:
       record_number     region residence_type family_composition  sex  age  marital_status  student  country_of_birth  health  ethnic_group  religion economic_activity occupation industry hours_worked_per_week approximate_social_grade
1                  2  S92000003              P                  0    1    3               1        2                 1       2             1         1                 1          1        8                     3                      NaN
27                27  S92000003              P                  1    2    4               2        2                 1       2             2         2                 1          6       11                     4                      NaN
29                29  S92000003              P                  2    6    2               2        1                 2       1             2         1                 6          4        2                     3                      NaN
42273          42273  S92000003              C                  X    1    6               1        2                 1       3             1         2                 X          X        X                     X                      NaN
42441          42441  S92000003              C                  X    2    8               5        1                 2       1             9         5                 X          X        X                     X                      NaN
2024-12-02 12:33:52,847 - INFO - =====Checking for duplicate rows:=====
2024-12-02 12:33:52,871 - ERROR - Failed! 1 duplicate rows detected.
2024-12-02 12:33:52,871 - INFO - 
Duplicate rows:
2024-12-02 12:33:52,897 - INFO -    record_number     region residence_type family_composition  sex  age  marital_status  student  country_of_birth  health  ethnic_group  religion economic_activity occupation industry hours_worked_per_week approximate_social_grade
5              5  S92000003              P                  4    2    4               4        2                 1       2             1         1                 1          3       11                     3                        2
2024-12-02 12:33:52,897 - INFO - =====Verifying 'record_number' uniqueness:=====
2024-12-02 12:33:52,897 - INFO - Columns in batch: ['record_number', 'region', 'residence_type', 'family_composition', 'sex', 'age', 'marital_status', 'student', 'country_of_birth', 'health', 'ethnic_group', 'religion', 'economic_activity', 'occupation', 'industry', 'hours_worked_per_week', 'approximate_social_grade']
2024-12-02 12:33:52,899 - ERROR - Failed! 'record_number' is not unique. Duplicate record numbers: [5]
2024-12-02 12:33:52,899 - INFO - 
Duplicate rows:
2024-12-02 12:33:52,902 - INFO -    record_number     region residence_type family_composition  sex  age  marital_status  student  country_of_birth  health  ethnic_group  religion economic_activity occupation industry hours_worked_per_week approximate_social_grade
5              5  S92000003              P                  4    2    4               4        2                 1       2             1         1                 1          3       11                     3                        2
2024-12-02 12:33:52,902 - INFO - =====validate_data_ranges:=====
2024-12-02 12:33:52,985 - INFO - 
Broken records in column 'sex':
2024-12-02 12:33:52,986 - INFO -     sex
29    6
2024-12-02 12:33:52,986 - ERROR - Failed! Column 'sex' contains invalid values: [6]
2024-12-02 12:33:53,246 - INFO - 
Broken records in column 'ethnic_group':
2024-12-02 12:33:53,247 - INFO -        ethnic_group
42441             9
2024-12-02 12:33:53,247 - ERROR - Failed! Column 'ethnic_group' contains invalid values: [9]
2024-12-02 12:33:53,398 - INFO - 
Broken records in column 'approximate_social_grade':
2024-12-02 12:33:53,399 - INFO -       approximate_social_grade
0                           11
1                          NaN
27                         NaN
29                         NaN
42273                      NaN
42441                      NaN
2024-12-02 12:33:53,399 - ERROR - Failed! Column 'approximate_social_grade' contains invalid values: ['11', nan]
2024-12-02 12:33:53,399 - INFO - 
Unique categories and counts per column:
2024-12-02 12:33:53,400 - INFO - residence_type: ['P', 'C'] (Total unique: 2)
2024-12-02 12:33:53,400 - INFO - family_composition: ['X', '4', '1', '2', '5', '3', '0'] (Total unique: 7)
2024-12-02 12:33:53,400 - INFO - sex: [1, 2, 6] (Total unique: 3)
2024-12-02 12:33:53,400 - INFO - age: [1, 2, 3, 4, 5, 6, 7, 8] (Total unique: 8)
2024-12-02 12:33:53,400 - INFO - marital_status: [1, 2, 3, 4, 5] (Total unique: 5)
2024-12-02 12:33:53,400 - INFO - student: [1, 2] (Total unique: 2)
2024-12-02 12:33:53,400 - INFO - country_of_birth: [1, 2] (Total unique: 2)
2024-12-02 12:33:53,400 - INFO - health: [1, 2, 3, 4, 5] (Total unique: 5)
2024-12-02 12:33:53,400 - INFO - ethnic_group: [1, 2, 3, 4, 5, 6, 9] (Total unique: 7)
2024-12-02 12:33:53,400 - INFO - religion: [1, 2, 3, 4, 5, 6, 7, 8, 9] (Total unique: 9)
2024-12-02 12:33:53,400 - INFO - economic_activity: ['7', '8', '4', '1', '9', '2', '5', '6', 'X', '3'] (Total unique: 10)
2024-12-02 12:33:53,400 - INFO - occupation: ['7', 'X', '4', '1', '8', '9', '2', '5', '6', '3'] (Total unique: 10)
2024-12-02 12:33:53,400 - INFO - industry: ['13', '7', '11', '8', '4', '1', '12', '9', '2', '10', '5', '6', 'X', '3'] (Total unique: 14)
2024-12-02 12:33:53,400 - INFO - hours_worked_per_week: ['4', '1', '2', '3', 'X'] (Total unique: 5)
2024-12-02 12:33:53,400 - INFO - approximate_social_grade: ['11', '4', '1', '2', '3', 'X'] (Total unique: 6)
2024-12-02 12:33:53,400 - INFO - Starting data cleaning process...
2024-12-02 12:33:53,457 - INFO - Processing batch 1...
2024-12-02 12:33:53,457 - INFO - =====Checking for missing value:=====
2024-12-02 12:33:53,475 - WARNING - Missing values detected:
Record_Number               0
Region                      0
RESIDENCE_TYPE              0
Family_Composition          0
sex                         0
age                         0
Marital_Status              0
student                     0
Country_Of_Birth            0
health                      0
Ethnic_Group                0
religion                    0
Economic_Activity           0
Occupation                  0
industry                    0
Hours_Worked_Per_Week       0
Approximate_Social_Grade    5
dtype: int64
2024-12-02 12:33:53,504 - WARNING - Column 'approximate_social_grade': missing values at indices [1, 27, 29, 42273, 42441]
2024-12-02 12:33:53,523 - INFO - Rows to drop:
       record_number     region residence_type family_composition  sex  age  marital_status  student  country_of_birth  health  ethnic_group  religion economic_activity occupation industry hours_worked_per_week approximate_social_grade
1                  2  S92000003              P                  0    1    3               1        2                 1       2             1         1                 1          1        8                     3                      NaN
27                27  S92000003              P                  1    2    4               2        2                 1       2             2         2                 1          6       11                     4                      NaN
29                29  S92000003              P                  2    6    2               2        1                 2       1             2         1                 6          4        2                     3                      NaN
42273          42273  S92000003              C                  X    1    6               1        2                 1       3             1         2                 X          X        X                     X                      NaN
42441          42441  S92000003              C                  X    2    8               5        1                 2       1             9         5                 X          X        X                     X                      NaN
2024-12-02 12:33:53,523 - INFO - =====Checking for duplicate rows:=====
2024-12-02 12:33:53,548 - ERROR - Failed! 1 duplicate rows detected.
2024-12-02 12:33:53,548 - INFO - 
Duplicate rows:
2024-12-02 12:33:53,574 - INFO -    record_number     region residence_type family_composition  sex  age  marital_status  student  country_of_birth  health  ethnic_group  religion economic_activity occupation industry hours_worked_per_week approximate_social_grade
5              5  S92000003              P                  4    2    4               4        2                 1       2             1         1                 1          3       11                     3                        2
2024-12-02 12:33:53,590 - INFO -        record_number     region  ... hours_worked_per_week approximate_social_grade
21                21  S92000003  ...                     X                        2
29                29  S92000003  ...                     3                      NaN
48                48  S92000003  ...                     X                        2
49                49  S92000003  ...                     X                        2
86                86  S92000003  ...                     X                        1
...              ...        ...  ...                   ...                      ...
63296          63296  S92000003  ...                     X                        2
63318          63318  S92000003  ...                     X                        2
63351          63351  S92000003  ...                     X                        4
63367          63367  S92000003  ...                     X                        2
63384          63384  S92000003  ...                     X                        3

[2600 rows x 17 columns]
2024-12-02 12:33:53,600 - INFO - Rule 1: Found 2600 rows to delete, saved to data/rule_1_deleted_data.csv
2024-12-02 12:33:53,607 - INFO - Rule 2: No rows to delete
2024-12-02 12:33:53,617 - INFO - Rule 3: Found 842 rows to delete, saved to data/rule_3_deleted_data.csv
2024-12-02 12:33:53,633 - INFO - Rule 4: Found 2362 rows to delete, saved to data/rule_4_deleted_data.csv
2024-12-02 12:33:53,639 - INFO - Rule 5: No rows to delete
2024-12-02 12:33:53,650 - INFO - Rule 6: Found 842 rows to delete, saved to data/rule_6_deleted_data.csv
2024-12-02 12:33:53,663 - INFO - 'record_number' column reset.
2024-12-02 12:33:53,842 - INFO - Batch 1 cleaned and saved.
2024-12-02 12:33:53,845 - INFO - Progress saved to /cs/home/sz92/Documents/CS5002/P3/code/progress.json.
2024-12-02 12:33:53,845 - INFO - Data cleaning process completed. Total rows processed: 63389
2024-12-02 12:33:53,846 - INFO - Rows to drop: 5302
2024-12-02 12:33:53,846 - INFO - Cleaned data saved to ../data/output.csv
2024-12-02 12:33:53,846 - INFO - Progress file removed. Data processing complete.
2024-12-02 12:33:54,405 - INFO - Data clean code test passed. Congratulations!
2024-12-02 12:38:17,262 - WARNING - Progress file progress.json not found. Starting from the beginning.
2024-12-02 12:38:17,330 - INFO - Loaded data from row 0.
2024-12-02 12:38:17,331 - INFO - Columns in DataFrame: ['record_number', 'region', 'residence_type', 'family_composition', 'sex', 'age', 'marital_status', 'student', 'country_of_birth', 'health', 'ethnic_group', 'religion', 'economic_activity', 'occupation', 'industry', 'hours_worked_per_week', 'approximate_social_grade']
2024-12-02 12:38:17,331 - WARNING - Progress file progress.json not found. Starting from the beginning.
2024-12-02 12:38:17,385 - INFO - =====Checking data types:=====
2024-12-02 12:38:17,406 - INFO - Batch info:
None
2024-12-02 12:38:17,668 - INFO - =====Checking for missing value:=====
2024-12-02 12:38:17,688 - WARNING - Missing values detected:
Record_Number               0
Region                      0
RESIDENCE_TYPE              0
Family_Composition          0
sex                         0
age                         0
Marital_Status              0
student                     0
Country_Of_Birth            0
health                      0
Ethnic_Group                0
religion                    0
Economic_Activity           0
Occupation                  0
industry                    0
Hours_Worked_Per_Week       0
Approximate_Social_Grade    5
dtype: int64
2024-12-02 12:38:17,708 - WARNING - Column 'approximate_social_grade': missing values at indices [1, 27, 29, 42273, 42441]
2024-12-02 12:38:17,728 - INFO - Rows to drop:
       record_number     region residence_type family_composition  sex  age  marital_status  student  country_of_birth  health  ethnic_group  religion economic_activity occupation industry hours_worked_per_week approximate_social_grade
1                  2  S92000003              P                  0    1    3               1        2                 1       2             1         1                 1          1        8                     3                      NaN
27                27  S92000003              P                  1    2    4               2        2                 1       2             2         2                 1          6       11                     4                      NaN
29                29  S92000003              P                  2    6    2               2        1                 2       1             2         1                 6          4        2                     3                      NaN
42273          42273  S92000003              C                  X    1    6               1        2                 1       3             1         2                 X          X        X                     X                      NaN
42441          42441  S92000003              C                  X    2    8               5        1                 2       1             9         5                 X          X        X                     X                      NaN
2024-12-02 12:38:17,728 - INFO - =====Checking for duplicate rows:=====
2024-12-02 12:38:17,751 - ERROR - Failed! 1 duplicate rows detected.
2024-12-02 12:38:17,752 - INFO - 
Duplicate rows:
2024-12-02 12:38:17,776 - INFO -    record_number     region residence_type family_composition  sex  age  marital_status  student  country_of_birth  health  ethnic_group  religion economic_activity occupation industry hours_worked_per_week approximate_social_grade
5              5  S92000003              P                  4    2    4               4        2                 1       2             1         1                 1          3       11                     3                        2
2024-12-02 12:38:17,776 - INFO - =====Verifying 'record_number' uniqueness:=====
2024-12-02 12:38:17,777 - INFO - Columns in batch: ['record_number', 'region', 'residence_type', 'family_composition', 'sex', 'age', 'marital_status', 'student', 'country_of_birth', 'health', 'ethnic_group', 'religion', 'economic_activity', 'occupation', 'industry', 'hours_worked_per_week', 'approximate_social_grade']
2024-12-02 12:38:17,778 - ERROR - Failed! 'record_number' is not unique. Duplicate record numbers: [5]
2024-12-02 12:38:17,778 - INFO - 
Duplicate rows:
2024-12-02 12:38:17,782 - INFO -    record_number     region residence_type family_composition  sex  age  marital_status  student  country_of_birth  health  ethnic_group  religion economic_activity occupation industry hours_worked_per_week approximate_social_grade
5              5  S92000003              P                  4    2    4               4        2                 1       2             1         1                 1          3       11                     3                        2
2024-12-02 12:38:17,782 - INFO - =====validate_data_ranges:=====
2024-12-02 12:38:17,863 - INFO - 
Broken records in column 'sex':
2024-12-02 12:38:17,864 - INFO -     sex
29    6
2024-12-02 12:38:17,864 - ERROR - Failed! Column 'sex' contains invalid values: [6]
2024-12-02 12:38:18,115 - INFO - 
Broken records in column 'ethnic_group':
2024-12-02 12:38:18,116 - INFO -        ethnic_group
42441             9
2024-12-02 12:38:18,116 - ERROR - Failed! Column 'ethnic_group' contains invalid values: [9]
2024-12-02 12:38:18,264 - INFO - 
Broken records in column 'approximate_social_grade':
2024-12-02 12:38:18,265 - INFO -       approximate_social_grade
0                           11
1                          NaN
27                         NaN
29                         NaN
42273                      NaN
42441                      NaN
2024-12-02 12:38:18,266 - ERROR - Failed! Column 'approximate_social_grade' contains invalid values: ['11', nan]
2024-12-02 12:38:18,266 - INFO - 
Unique categories and counts per column:
2024-12-02 12:38:18,266 - INFO - residence_type: ['C', 'P'] (Total unique: 2)
2024-12-02 12:38:18,266 - INFO - family_composition: ['0', '4', '5', 'X', '1', '3', '2'] (Total unique: 7)
2024-12-02 12:38:18,266 - INFO - sex: [1, 2, 6] (Total unique: 3)
2024-12-02 12:38:18,266 - INFO - age: [1, 2, 3, 4, 5, 6, 7, 8] (Total unique: 8)
2024-12-02 12:38:18,266 - INFO - marital_status: [1, 2, 3, 4, 5] (Total unique: 5)
2024-12-02 12:38:18,266 - INFO - student: [1, 2] (Total unique: 2)
2024-12-02 12:38:18,266 - INFO - country_of_birth: [1, 2] (Total unique: 2)
2024-12-02 12:38:18,266 - INFO - health: [1, 2, 3, 4, 5] (Total unique: 5)
2024-12-02 12:38:18,266 - INFO - ethnic_group: [1, 2, 3, 4, 5, 6, 9] (Total unique: 7)
2024-12-02 12:38:18,266 - INFO - religion: [1, 2, 3, 4, 5, 6, 7, 8, 9] (Total unique: 9)
2024-12-02 12:38:18,266 - INFO - economic_activity: ['9', '7', '4', '5', '6', 'X', '1', '3', '2', '8'] (Total unique: 10)
2024-12-02 12:38:18,266 - INFO - occupation: ['9', '7', '4', '5', '6', 'X', '1', '3', '2', '8'] (Total unique: 10)
2024-12-02 12:38:18,266 - INFO - industry: ['9', '7', '13', '12', '4', '10', '5', '6', 'X', '1', '11', '3', '2', '8'] (Total unique: 14)
2024-12-02 12:38:18,266 - INFO - hours_worked_per_week: ['4', 'X', '1', '3', '2'] (Total unique: 5)
2024-12-02 12:38:18,266 - INFO - approximate_social_grade: ['4', 'X', '1', '11', '3', '2'] (Total unique: 6)
2024-12-02 12:38:18,266 - INFO - Starting data cleaning process...
2024-12-02 12:38:18,321 - INFO - Processing batch 1...
2024-12-02 12:38:18,321 - INFO - =====Checking for missing value:=====
2024-12-02 12:38:18,338 - WARNING - Missing values detected:
Record_Number               0
Region                      0
RESIDENCE_TYPE              0
Family_Composition          0
sex                         0
age                         0
Marital_Status              0
student                     0
Country_Of_Birth            0
health                      0
Ethnic_Group                0
religion                    0
Economic_Activity           0
Occupation                  0
industry                    0
Hours_Worked_Per_Week       0
Approximate_Social_Grade    5
dtype: int64
2024-12-02 12:38:18,367 - WARNING - Column 'approximate_social_grade': missing values at indices [1, 27, 29, 42273, 42441]
2024-12-02 12:38:18,386 - INFO - Rows to drop:
       record_number     region residence_type family_composition  sex  age  marital_status  student  country_of_birth  health  ethnic_group  religion economic_activity occupation industry hours_worked_per_week approximate_social_grade
1                  2  S92000003              P                  0    1    3               1        2                 1       2             1         1                 1          1        8                     3                      NaN
27                27  S92000003              P                  1    2    4               2        2                 1       2             2         2                 1          6       11                     4                      NaN
29                29  S92000003              P                  2    6    2               2        1                 2       1             2         1                 6          4        2                     3                      NaN
42273          42273  S92000003              C                  X    1    6               1        2                 1       3             1         2                 X          X        X                     X                      NaN
42441          42441  S92000003              C                  X    2    8               5        1                 2       1             9         5                 X          X        X                     X                      NaN
2024-12-02 12:38:18,386 - INFO - =====Checking for duplicate rows:=====
2024-12-02 12:38:18,410 - ERROR - Failed! 1 duplicate rows detected.
2024-12-02 12:38:18,410 - INFO - 
Duplicate rows:
2024-12-02 12:38:18,435 - INFO -    record_number     region residence_type family_composition  sex  age  marital_status  student  country_of_birth  health  ethnic_group  religion economic_activity occupation industry hours_worked_per_week approximate_social_grade
5              5  S92000003              P                  4    2    4               4        2                 1       2             1         1                 1          3       11                     3                        2
2024-12-02 12:38:18,450 - INFO -        record_number     region  ... hours_worked_per_week approximate_social_grade
21                21  S92000003  ...                     X                        2
29                29  S92000003  ...                     3                      NaN
48                48  S92000003  ...                     X                        2
49                49  S92000003  ...                     X                        2
86                86  S92000003  ...                     X                        1
...              ...        ...  ...                   ...                      ...
63296          63296  S92000003  ...                     X                        2
63318          63318  S92000003  ...                     X                        2
63351          63351  S92000003  ...                     X                        4
63367          63367  S92000003  ...                     X                        2
63384          63384  S92000003  ...                     X                        3

[2600 rows x 17 columns]
2024-12-02 12:38:18,461 - INFO - Rule 1: Found 2600 rows to delete, saved to data/rule_1_deleted_data.csv
2024-12-02 12:38:18,468 - INFO - Rule 2: No rows to delete
2024-12-02 12:38:18,479 - INFO - Rule 3: Found 842 rows to delete, saved to data/rule_3_deleted_data.csv
2024-12-02 12:38:18,495 - INFO - Rule 4: Found 2362 rows to delete, saved to data/rule_4_deleted_data.csv
2024-12-02 12:38:18,501 - INFO - Rule 5: No rows to delete
2024-12-02 12:38:18,512 - INFO - Rule 6: Found 842 rows to delete, saved to data/rule_6_deleted_data.csv
2024-12-02 12:38:18,517 - INFO - =====validate_data_ranges:=====
2024-12-02 12:38:18,591 - INFO - 
Broken records in column 'sex':
2024-12-02 12:38:18,592 - INFO -     sex
29    6
2024-12-02 12:38:18,592 - ERROR - Failed! Column 'sex' contains invalid values: [6]
2024-12-02 12:38:18,820 - INFO - 
Broken records in column 'ethnic_group':
2024-12-02 12:38:18,822 - INFO -        ethnic_group
42441             9
2024-12-02 12:38:18,822 - ERROR - Failed! Column 'ethnic_group' contains invalid values: [9]
2024-12-02 12:38:18,970 - INFO - 
Broken records in column 'approximate_social_grade':
2024-12-02 12:38:18,971 - INFO -       approximate_social_grade
0                           11
1                          NaN
27                         NaN
29                         NaN
42273                      NaN
42441                      NaN
2024-12-02 12:38:18,971 - ERROR - Failed! Column 'approximate_social_grade' contains invalid values: ['11', nan]
2024-12-02 12:38:18,972 - INFO - 
Unique categories and counts per column:
2024-12-02 12:38:18,972 - INFO - residence_type: ['C', 'P'] (Total unique: 2)
2024-12-02 12:38:18,972 - INFO - family_composition: ['0', '4', '5', 'X', '1', '3', '2'] (Total unique: 7)
2024-12-02 12:38:18,972 - INFO - sex: [1, 2, 6] (Total unique: 3)
2024-12-02 12:38:18,972 - INFO - age: [1, 2, 3, 4, 5, 6, 7, 8] (Total unique: 8)
2024-12-02 12:38:18,972 - INFO - marital_status: [1, 2, 3, 4, 5] (Total unique: 5)
2024-12-02 12:38:18,972 - INFO - student: [1, 2] (Total unique: 2)
2024-12-02 12:38:18,972 - INFO - country_of_birth: [1, 2] (Total unique: 2)
2024-12-02 12:38:18,972 - INFO - health: [1, 2, 3, 4, 5] (Total unique: 5)
2024-12-02 12:38:18,972 - INFO - ethnic_group: [1, 2, 3, 4, 5, 6, 9] (Total unique: 7)
2024-12-02 12:38:18,972 - INFO - religion: [1, 2, 3, 4, 5, 6, 7, 8, 9] (Total unique: 9)
2024-12-02 12:38:18,972 - INFO - economic_activity: ['9', '7', '4', '5', '6', 'X', '1', '3', '2', '8'] (Total unique: 10)
2024-12-02 12:38:18,972 - INFO - occupation: ['9', '7', '4', '5', '6', 'X', '1', '3', '2', '8'] (Total unique: 10)
2024-12-02 12:38:18,972 - INFO - industry: ['9', '7', '13', '12', '4', '10', '5', '6', 'X', '1', '11', '3', '2', '8'] (Total unique: 14)
2024-12-02 12:38:18,972 - INFO - hours_worked_per_week: ['4', 'X', '1', '3', '2'] (Total unique: 5)
2024-12-02 12:38:18,972 - INFO - approximate_social_grade: ['4', 'X', '1', '11', '3', '2'] (Total unique: 6)
2024-12-02 12:38:18,972 - INFO - =====Verifying 'record_number' uniqueness:=====
2024-12-02 12:38:18,972 - INFO - Columns in batch: ['record_number', 'region', 'residence_type', 'family_composition', 'sex', 'age', 'marital_status', 'student', 'country_of_birth', 'health', 'ethnic_group', 'religion', 'economic_activity', 'occupation', 'industry', 'hours_worked_per_week', 'approximate_social_grade']
2024-12-02 12:38:18,974 - ERROR - Failed! 'record_number' is not unique. Duplicate record numbers: [5]
2024-12-02 12:38:18,974 - INFO - 
Duplicate rows:
2024-12-02 12:38:18,977 - INFO -    record_number     region residence_type family_composition  sex  age  marital_status  student  country_of_birth  health  ethnic_group  religion economic_activity occupation industry hours_worked_per_week approximate_social_grade
5              5  S92000003              P                  4    2    4               4        2                 1       2             1         1                 1          3       11                     3                        2
2024-12-02 12:38:18,989 - INFO - 'record_number' column reset.
2024-12-02 12:38:19,173 - INFO - Batch 1 cleaned and saved.
2024-12-02 12:38:19,176 - INFO - Progress saved to /cs/home/sz92/Documents/CS5002/P3/code/progress.json.
2024-12-02 12:38:19,177 - INFO - Data cleaning process completed. Total rows processed: 63389
2024-12-02 12:38:19,177 - INFO - Rows to drop: 5303
2024-12-02 12:38:19,177 - INFO - Cleaned data saved to ../data/output.csv
2024-12-02 12:38:19,178 - INFO - Progress file removed. Data processing complete.
2024-12-02 12:38:19,739 - INFO - Data clean code test passed. Congratulations!
2024-12-02 12:45:49,933 - WARNING - Progress file progress.json not found. Starting from the beginning.
2024-12-02 12:45:49,999 - INFO - Loaded data from row 0.
2024-12-02 12:45:49,999 - INFO - Columns in DataFrame: ['record_number', 'region', 'residence_type', 'family_composition', 'sex', 'age', 'marital_status', 'student', 'country_of_birth', 'health', 'ethnic_group', 'religion', 'economic_activity', 'occupation', 'industry', 'hours_worked_per_week', 'approximate_social_grade']
2024-12-02 12:45:49,999 - WARNING - Progress file progress.json not found. Starting from the beginning.
2024-12-02 12:45:50,052 - INFO - =====Checking data types:=====
2024-12-02 12:45:50,073 - INFO - Batch info:
None
2024-12-02 12:45:50,331 - INFO - =====Checking for missing value:=====
2024-12-02 12:45:50,348 - INFO - No missing values detected.
2024-12-02 12:45:50,348 - INFO - =====Checking for duplicate rows:=====
2024-12-02 12:45:50,370 - INFO - No duplicate rows detected.
2024-12-02 12:45:50,370 - INFO - =====Verifying 'record_number' uniqueness:=====
2024-12-02 12:45:50,370 - INFO - Columns in batch: ['record_number', 'region', 'residence_type', 'family_composition', 'sex', 'age', 'marital_status', 'student', 'country_of_birth', 'health', 'ethnic_group', 'religion', 'economic_activity', 'occupation', 'industry', 'hours_worked_per_week', 'approximate_social_grade']
2024-12-02 12:45:50,371 - INFO - Record_Number is unique.
2024-12-02 12:45:50,371 - INFO - =====validate_data_ranges:=====
2024-12-02 12:45:50,852 - INFO - 
Unique categories and counts per column:
2024-12-02 12:45:50,852 - INFO - residence_type: ['P', 'C'] (Total unique: 2)
2024-12-02 12:45:50,852 - INFO - family_composition: ['2', '0', '3', '4', '1', 'X', '5'] (Total unique: 7)
2024-12-02 12:45:50,852 - INFO - sex: [1, 2] (Total unique: 2)
2024-12-02 12:45:50,853 - INFO - age: [1, 2, 3, 4, 5, 6, 7, 8] (Total unique: 8)
2024-12-02 12:45:50,853 - INFO - marital_status: [1, 2, 3, 4, 5] (Total unique: 5)
2024-12-02 12:45:50,853 - INFO - student: [1, 2] (Total unique: 2)
2024-12-02 12:45:50,853 - INFO - country_of_birth: [1, 2] (Total unique: 2)
2024-12-02 12:45:50,853 - INFO - health: [1, 2, 3, 4, 5] (Total unique: 5)
2024-12-02 12:45:50,853 - INFO - ethnic_group: [1, 2, 3, 4, 5, 6] (Total unique: 6)
2024-12-02 12:45:50,853 - INFO - religion: [1, 2, 3, 4, 5, 6, 7, 8, 9] (Total unique: 9)
2024-12-02 12:45:50,853 - INFO - economic_activity: ['2', '9', '7', '3', '4', '6', '1', 'X', '8', '5'] (Total unique: 10)
2024-12-02 12:45:50,853 - INFO - occupation: ['2', '3', '9', '7', '4', '6', '1', 'X', '8', '5'] (Total unique: 10)
2024-12-02 12:45:50,853 - INFO - industry: ['2', '9', '11', '7', '3', '4', '6', '1', 'X', '10', '13', '8', '5', '12'] (Total unique: 14)
2024-12-02 12:45:50,853 - INFO - hours_worked_per_week: ['2', '3', '4', '1', 'X'] (Total unique: 5)
2024-12-02 12:45:50,853 - INFO - approximate_social_grade: ['2', '3', '4', '1', 'X'] (Total unique: 5)
2024-12-02 12:45:50,853 - INFO - 
All data ranges validated.
2024-12-02 12:45:50,853 - INFO - Starting data cleaning process...
2024-12-02 12:45:50,908 - INFO - Processing batch 1...
2024-12-02 12:45:50,908 - INFO - =====Checking for missing value:=====
2024-12-02 12:45:50,926 - INFO - No missing values detected.
2024-12-02 12:45:50,926 - INFO - =====Checking for duplicate rows:=====
2024-12-02 12:45:50,948 - INFO - No duplicate rows detected.
2024-12-02 12:45:50,964 - INFO -        record_number     region  ... hours_worked_per_week approximate_social_grade
20                21  S92000003  ...                     X                        2
47                48  S92000003  ...                     X                        2
48                49  S92000003  ...                     X                        2
85                86  S92000003  ...                     X                        1
88                89  S92000003  ...                     X                        2
...              ...        ...  ...                   ...                      ...
63295          63296  S92000003  ...                     X                        2
63317          63318  S92000003  ...                     X                        2
63350          63351  S92000003  ...                     X                        4
63366          63367  S92000003  ...                     X                        2
63383          63384  S92000003  ...                     X                        3

[2598 rows x 17 columns]
2024-12-02 12:45:50,976 - INFO - Rule 1: Found 2598 rows to delete, saved to data/rule_1_deleted_data.csv
2024-12-02 12:45:50,982 - INFO - Rule 2: No rows to delete
2024-12-02 12:45:50,994 - INFO - Rule 3: Found 843 rows to delete, saved to data/rule_3_deleted_data.csv
2024-12-02 12:45:51,010 - INFO - Rule 4: Found 2362 rows to delete, saved to data/rule_4_deleted_data.csv
2024-12-02 12:45:51,031 - INFO - Rule 5: No rows to delete
2024-12-02 12:45:51,047 - INFO - Rule 6: Found 843 rows to delete, saved to data/rule_6_deleted_data.csv
2024-12-02 12:45:51,051 - INFO - =====validate_data_ranges:=====
2024-12-02 12:45:51,497 - INFO - 
Unique categories and counts per column:
2024-12-02 12:45:51,497 - INFO - residence_type: ['P', 'C'] (Total unique: 2)
2024-12-02 12:45:51,497 - INFO - family_composition: ['2', '0', '3', '4', '1', 'X', '5'] (Total unique: 7)
2024-12-02 12:45:51,497 - INFO - sex: [1, 2] (Total unique: 2)
2024-12-02 12:45:51,497 - INFO - age: [1, 2, 3, 4, 5, 6, 7, 8] (Total unique: 8)
2024-12-02 12:45:51,497 - INFO - marital_status: [1, 2, 3, 4, 5] (Total unique: 5)
2024-12-02 12:45:51,497 - INFO - student: [1, 2] (Total unique: 2)
2024-12-02 12:45:51,497 - INFO - country_of_birth: [1, 2] (Total unique: 2)
2024-12-02 12:45:51,497 - INFO - health: [1, 2, 3, 4, 5] (Total unique: 5)
2024-12-02 12:45:51,497 - INFO - ethnic_group: [1, 2, 3, 4, 5, 6] (Total unique: 6)
2024-12-02 12:45:51,497 - INFO - religion: [1, 2, 3, 4, 5, 6, 7, 8, 9] (Total unique: 9)
2024-12-02 12:45:51,497 - INFO - economic_activity: ['2', '9', '7', '3', '4', '6', '1', 'X', '8', '5'] (Total unique: 10)
2024-12-02 12:45:51,497 - INFO - occupation: ['2', '3', '9', '7', '4', '6', '1', 'X', '8', '5'] (Total unique: 10)
2024-12-02 12:45:51,497 - INFO - industry: ['2', '9', '11', '7', '3', '4', '6', '1', 'X', '10', '13', '8', '5', '12'] (Total unique: 14)
2024-12-02 12:45:51,497 - INFO - hours_worked_per_week: ['2', '3', '4', '1', 'X'] (Total unique: 5)
2024-12-02 12:45:51,497 - INFO - approximate_social_grade: ['2', '3', '4', '1', 'X'] (Total unique: 5)
2024-12-02 12:45:51,497 - INFO - 
All data ranges validated.
2024-12-02 12:45:51,498 - INFO - =====Verifying 'record_number' uniqueness:=====
2024-12-02 12:45:51,498 - INFO - Columns in batch: ['record_number', 'region', 'residence_type', 'family_composition', 'sex', 'age', 'marital_status', 'student', 'country_of_birth', 'health', 'ethnic_group', 'religion', 'economic_activity', 'occupation', 'industry', 'hours_worked_per_week', 'approximate_social_grade']
2024-12-02 12:45:51,500 - INFO - Record_Number is unique.
2024-12-02 12:45:51,511 - INFO - 'record_number' column reset.
2024-12-02 12:45:51,684 - INFO - Batch 1 cleaned and saved.
2024-12-02 12:45:51,687 - INFO - Progress saved to /cs/home/sz92/Documents/CS5002/P3/code/progress.json.
2024-12-02 12:45:51,688 - INFO - Data cleaning process completed. Total rows processed: 63388
2024-12-02 12:45:51,688 - INFO - Rows to drop: 5297
2024-12-02 12:45:51,688 - INFO - Cleaned data saved to ../data/output.csv
2024-12-02 12:45:51,689 - INFO - Progress file removed. Data processing complete.
2024-12-02 12:45:52,252 - INFO - Data clean code test passed. Congratulations! Result deatils in log/data_cleaning.log
2024-12-02 12:46:51,933 - WARNING - Progress file progress.json not found. Starting from the beginning.
2024-12-02 12:46:52,003 - INFO - Loaded data from row 0.
2024-12-02 12:46:52,004 - INFO - Columns in DataFrame: ['record_number', 'region', 'residence_type', 'family_composition', 'sex', 'age', 'marital_status', 'student', 'country_of_birth', 'health', 'ethnic_group', 'religion', 'economic_activity', 'occupation', 'industry', 'hours_worked_per_week', 'approximate_social_grade']
2024-12-02 12:46:52,015 - INFO - =====Checking data types:=====
2024-12-02 12:46:52,022 - INFO - Batch info:
None
2024-12-02 12:46:52,067 - INFO - =====Checking for missing value:=====
2024-12-02 12:46:52,071 - INFO - No missing values detected.
2024-12-02 12:46:52,081 - INFO - =====Checking for duplicate rows:=====
2024-12-02 12:46:52,087 - INFO - No duplicate rows detected.
2024-12-02 12:46:52,091 - INFO - =====Verifying 'record_number' uniqueness:=====
2024-12-02 12:46:52,091 - INFO - Columns in batch: ['record_number', 'region', 'residence_type', 'family_composition', 'sex', 'age', 'marital_status', 'student', 'country_of_birth', 'health', 'ethnic_group', 'religion', 'economic_activity', 'occupation', 'industry', 'hours_worked_per_week', 'approximate_social_grade']
2024-12-02 12:46:52,092 - INFO - Record_Number is unique.
2024-12-02 12:46:52,095 - INFO - =====validate_data_ranges:=====
2024-12-02 12:46:52,173 - INFO - 
Unique categories and counts per column:
2024-12-02 12:46:52,173 - INFO - residence_type: ['P', 'C'] (Total unique: 2)
2024-12-02 12:46:52,173 - INFO - family_composition: ['5', '2', '1', '4', '3', '0', 'X'] (Total unique: 7)
2024-12-02 12:46:52,173 - INFO - sex: [1, 2] (Total unique: 2)
2024-12-02 12:46:52,173 - INFO - age: [1, 2, 3, 4, 5, 6, 7, 8] (Total unique: 8)
2024-12-02 12:46:52,173 - INFO - marital_status: [1, 2, 3, 4, 5] (Total unique: 5)
2024-12-02 12:46:52,173 - INFO - student: [1, 2] (Total unique: 2)
2024-12-02 12:46:52,173 - INFO - country_of_birth: [1, 2] (Total unique: 2)
2024-12-02 12:46:52,173 - INFO - health: [1, 2, 3, 4, 5] (Total unique: 5)
2024-12-02 12:46:52,173 - INFO - ethnic_group: [1, 2, 3, 4, 5, 6] (Total unique: 6)
2024-12-02 12:46:52,173 - INFO - religion: [1, 2, 3, 4, 5, 6, 7, 8, 9] (Total unique: 9)
2024-12-02 12:46:52,173 - INFO - economic_activity: ['5', '9', '2', '1', '7', '4', '3', '6', '8', 'X'] (Total unique: 10)
2024-12-02 12:46:52,173 - INFO - occupation: ['5', '9', '2', '1', '7', '4', '3', '8', '6', 'X'] (Total unique: 10)
2024-12-02 12:46:52,173 - INFO - industry: ['5', '10', '9', '2', '1', '11', '4', '8', '6', '7', '3', '13', '12', 'X'] (Total unique: 14)
2024-12-02 12:46:52,173 - INFO - hours_worked_per_week: ['2', '1', '4', '3', 'X'] (Total unique: 5)
2024-12-02 12:46:52,173 - INFO - approximate_social_grade: ['2', '1', '4', '3', 'X'] (Total unique: 5)
2024-12-02 12:46:52,173 - INFO - 
All data ranges validated.
2024-12-02 12:46:52,182 - INFO -       record_number     region residence_type family_composition  sex  age  \
20               21  S92000003              P                  5    2    2   
47               48  S92000003              P                  0    1    2   
48               49  S92000003              P                  0    1    3   
85               86  S92000003              P                  1    1    2   
88               89  S92000003              P                  1    1    3   
...             ...        ...            ...                ...  ...  ...   
8818           8819  S92000003              P                  1    2    2   
8875           8876  S92000003              P                  1    2    2   
8886           8887  S92000003              P                  4    2    2   
8906           8907  S92000003              P                  4    1    2   
8930           8931  S92000003              P                  1    1    2   

      marital_status  student  country_of_birth  health  ethnic_group  \
20                 1        1                 2       2             1   
47                 1        1                 2       1             1   
48                 2        1                 2       1             4   
85                 1        1                 2       1             1   
88                 2        1                 1       2             1   
...              ...      ...               ...     ...           ...   
8818               1        1                 1       1             1   
8875               1        1                 2       1             1   
8886               1        1                 1       1             1   
8906               1        1                 1       1             1   
8930               1        1                 1       1             1   

      religion economic_activity occupation industry hours_worked_per_week  \
20           2                 6          X        X                     X   
47           1                 6          X        X                     X   
48           2                 6          2        8                     X   
85           2                 6          X        X                     X   
88           2                 6          2       10                     X   
...        ...               ...        ...      ...                   ...   
8818         2                 6          X        X                     X   
8875         1                 6          X        X                     X   
8886         1                 6          X        X                     X   
8906         2                 6          X        X                     X   
8930         1                 6          7        4                     X   

     approximate_social_grade  
20                          2  
47                          2  
48                          2  
85                          1  
88                          2  
...                       ...  
8818                        4  
8875                        2  
8886                        1  
8906                        4  
8930                        2  

[372 rows x 17 columns]
2024-12-02 12:46:52,187 - INFO - Rule 1: Found 372 rows to delete, saved to data/rule_1_deleted_data.csv
2024-12-02 12:46:52,189 - INFO - Rule 2: No rows to delete
2024-12-02 12:46:52,193 - INFO - Rule 3: Found 123 rows to delete, saved to data/rule_3_deleted_data.csv
2024-12-02 12:46:52,198 - INFO - Rule 4: Found 327 rows to delete, saved to data/rule_4_deleted_data.csv
2024-12-02 12:46:52,200 - INFO - Rule 5: No rows to delete
2024-12-02 12:46:52,205 - INFO - Rule 6: Found 123 rows to delete, saved to data/rule_6_deleted_data.csv
2024-12-02 12:46:52,216 - INFO - Starting data cleaning process...
2024-12-02 12:46:52,276 - INFO - Processing batch 1...
2024-12-02 12:46:52,276 - INFO - =====Checking for missing value:=====
2024-12-02 12:46:52,293 - INFO - No missing values detected.
2024-12-02 12:46:52,293 - INFO - =====Checking for duplicate rows:=====
2024-12-02 12:46:52,319 - INFO - No duplicate rows detected.
2024-12-02 12:46:52,327 - INFO -        record_number     region residence_type family_composition  sex  age  \
20                21  S92000003              P                  5    2    2   
47                48  S92000003              P                  0    1    2   
48                49  S92000003              P                  0    1    3   
85                86  S92000003              P                  1    1    2   
88                89  S92000003              P                  1    1    3   
...              ...        ...            ...                ...  ...  ...   
63295          63296  S92000003              P                  1    1    2   
63317          63318  S92000003              P                  0    2    2   
63350          63351  S92000003              P                  1    1    2   
63366          63367  S92000003              P                  4    2    2   
63383          63384  S92000003              P                  1    1    2   

       marital_status  student  country_of_birth  health  ethnic_group  \
20                  1        1                 2       2             1   
47                  1        1                 2       1             1   
48                  2        1                 2       1             4   
85                  1        1                 2       1             1   
88                  2        1                 1       2             1   
...               ...      ...               ...     ...           ...   
63295               1        1                 1       1             1   
63317               1        1                 2       2             3   
63350               1        1                 1       1             1   
63366               1        1                 1       1             1   
63383               1        1                 1       1             1   

       religion economic_activity occupation industry hours_worked_per_week  \
20            2                 6          X        X                     X   
47            1                 6          X        X                     X   
48            2                 6          2        8                     X   
85            2                 6          X        X                     X   
88            2                 6          2       10                     X   
...         ...               ...        ...      ...                   ...   
63295         2                 6          7        4                     X   
63317         1                 6          X        X                     X   
63350         1                 6          X        X                     X   
63366         1                 6          X        X                     X   
63383         2                 6          X        X                     X   

      approximate_social_grade  
20                           2  
47                           2  
48                           2  
85                           1  
88                           2  
...                        ...  
63295                        2  
63317                        2  
63350                        4  
63366                        2  
63383                        3  

[2598 rows x 17 columns]
2024-12-02 12:46:52,338 - INFO - Rule 1: Found 2598 rows to delete, saved to data/rule_1_deleted_data.csv
2024-12-02 12:46:52,345 - INFO - Rule 2: No rows to delete
2024-12-02 12:46:52,358 - INFO - Rule 3: Found 843 rows to delete, saved to data/rule_3_deleted_data.csv
2024-12-02 12:46:52,376 - INFO - Rule 4: Found 2362 rows to delete, saved to data/rule_4_deleted_data.csv
2024-12-02 12:46:52,383 - INFO - Rule 5: No rows to delete
2024-12-02 12:46:52,395 - INFO - Rule 6: Found 843 rows to delete, saved to data/rule_6_deleted_data.csv
2024-12-02 12:46:52,400 - INFO - =====validate_data_ranges:=====
2024-12-02 12:46:52,843 - INFO - 
Unique categories and counts per column:
2024-12-02 12:46:52,843 - INFO - residence_type: ['P', 'C'] (Total unique: 2)
2024-12-02 12:46:52,843 - INFO - family_composition: ['5', '2', '1', '4', '3', '0', 'X'] (Total unique: 7)
2024-12-02 12:46:52,843 - INFO - sex: [1, 2] (Total unique: 2)
2024-12-02 12:46:52,843 - INFO - age: [1, 2, 3, 4, 5, 6, 7, 8] (Total unique: 8)
2024-12-02 12:46:52,843 - INFO - marital_status: [1, 2, 3, 4, 5] (Total unique: 5)
2024-12-02 12:46:52,843 - INFO - student: [1, 2] (Total unique: 2)
2024-12-02 12:46:52,843 - INFO - country_of_birth: [1, 2] (Total unique: 2)
2024-12-02 12:46:52,843 - INFO - health: [1, 2, 3, 4, 5] (Total unique: 5)
2024-12-02 12:46:52,843 - INFO - ethnic_group: [1, 2, 3, 4, 5, 6] (Total unique: 6)
2024-12-02 12:46:52,843 - INFO - religion: [1, 2, 3, 4, 5, 6, 7, 8, 9] (Total unique: 9)
2024-12-02 12:46:52,844 - INFO - economic_activity: ['5', '9', '2', '1', '7', '4', '3', '6', '8', 'X'] (Total unique: 10)
2024-12-02 12:46:52,844 - INFO - occupation: ['5', '9', '2', '1', '7', '4', '3', '8', '6', 'X'] (Total unique: 10)
2024-12-02 12:46:52,844 - INFO - industry: ['5', '10', '9', '2', '1', '11', '4', '8', '6', '7', '3', '13', '12', 'X'] (Total unique: 14)
2024-12-02 12:46:52,844 - INFO - hours_worked_per_week: ['2', '1', '4', '3', 'X'] (Total unique: 5)
2024-12-02 12:46:52,844 - INFO - approximate_social_grade: ['2', '1', '4', '3', 'X'] (Total unique: 5)
2024-12-02 12:46:52,844 - INFO - 
All data ranges validated.
2024-12-02 12:46:52,844 - INFO - =====Verifying 'record_number' uniqueness:=====
2024-12-02 12:46:52,844 - INFO - Columns in batch: ['record_number', 'region', 'residence_type', 'family_composition', 'sex', 'age', 'marital_status', 'student', 'country_of_birth', 'health', 'ethnic_group', 'religion', 'economic_activity', 'occupation', 'industry', 'hours_worked_per_week', 'approximate_social_grade']
2024-12-02 12:46:52,845 - INFO - Record_Number is unique.
2024-12-02 12:46:52,854 - INFO - 'record_number' column reset.
2024-12-02 12:46:53,030 - INFO - Batch 1 cleaned and saved.
2024-12-02 12:46:53,033 - INFO - Progress saved to /cs/home/sz92/Documents/CS5002/P3/notebooks/progress.json.
2024-12-02 12:46:53,033 - INFO - Data cleaning process completed. Total rows processed: 63388
2024-12-02 12:46:53,033 - INFO - Rows to drop: 5297
2024-12-02 12:46:53,033 - INFO - Cleaned data saved to ../data/output.csv
2024-12-02 12:46:53,034 - INFO - Progress file removed. Data processing complete.
2024-12-02 12:46:53,074 - INFO - Data clean code test passed. Congratulations! Result deatils in log/data_cleaning.log
2024-12-02 12:54:09,876 - WARNING - Progress file progress.json not found. Starting from the beginning.
2024-12-02 12:54:09,936 - INFO - Loaded data from row 0.
2024-12-02 12:54:09,936 - INFO - Columns in DataFrame: ['record_number', 'region', 'residence_type', 'family_composition', 'sex', 'age', 'marital_status', 'student', 'country_of_birth', 'health', 'ethnic_group', 'religion', 'economic_activity', 'occupation', 'industry', 'hours_worked_per_week', 'approximate_social_grade']
2024-12-02 12:54:09,947 - INFO - =====Checking data types:=====
2024-12-02 12:54:09,954 - INFO - Batch info:
None
2024-12-02 12:54:10,001 - INFO - =====Checking for missing value:=====
2024-12-02 12:54:10,005 - INFO - No missing values detected.
2024-12-02 12:54:10,010 - INFO - =====Checking for duplicate rows:=====
2024-12-02 12:54:10,017 - INFO - No duplicate rows detected.
2024-12-02 12:54:10,020 - INFO - =====Verifying 'record_number' uniqueness:=====
2024-12-02 12:54:10,020 - INFO - Columns in batch: ['record_number', 'region', 'residence_type', 'family_composition', 'sex', 'age', 'marital_status', 'student', 'country_of_birth', 'health', 'ethnic_group', 'religion', 'economic_activity', 'occupation', 'industry', 'hours_worked_per_week', 'approximate_social_grade']
2024-12-02 12:54:10,021 - INFO - Record_Number is unique.
2024-12-02 12:54:10,024 - INFO - =====validate_data_ranges:=====
2024-12-02 12:54:10,123 - INFO - 
Unique categories and counts per column:
2024-12-02 12:54:10,123 - INFO - residence_type: ['P', 'C'] (Total unique: 2)
2024-12-02 12:54:10,124 - INFO - family_composition: ['2', '1', '3', '4', '0', '5', 'X'] (Total unique: 7)
2024-12-02 12:54:10,124 - INFO - sex: [1, 2] (Total unique: 2)
2024-12-02 12:54:10,124 - INFO - age: [1, 2, 3, 4, 5, 6, 7, 8] (Total unique: 8)
2024-12-02 12:54:10,124 - INFO - marital_status: [1, 2, 3, 4, 5] (Total unique: 5)
2024-12-02 12:54:10,124 - INFO - student: [1, 2] (Total unique: 2)
2024-12-02 12:54:10,124 - INFO - country_of_birth: [1, 2] (Total unique: 2)
2024-12-02 12:54:10,124 - INFO - health: [1, 2, 3, 4, 5] (Total unique: 5)
2024-12-02 12:54:10,124 - INFO - ethnic_group: [1, 2, 3, 4, 5, 6] (Total unique: 6)
2024-12-02 12:54:10,124 - INFO - religion: [1, 2, 3, 4, 5, 6, 7, 8, 9] (Total unique: 9)
2024-12-02 12:54:10,124 - INFO - economic_activity: ['2', '8', '1', '3', '4', '7', '5', '6', 'X', '9'] (Total unique: 10)
2024-12-02 12:54:10,124 - INFO - occupation: ['2', '8', '1', '3', '4', '7', '5', '6', 'X', '9'] (Total unique: 10)
2024-12-02 12:54:10,124 - INFO - industry: ['2', '12', '8', '11', '13', '3', '4', '1', '10', '7', '5', '6', 'X', '9'] (Total unique: 14)
2024-12-02 12:54:10,124 - INFO - hours_worked_per_week: ['2', '1', '3', '4', 'X'] (Total unique: 5)
2024-12-02 12:54:10,124 - INFO - approximate_social_grade: ['2', '1', '3', '4', 'X'] (Total unique: 5)
2024-12-02 12:54:10,124 - INFO - 
All data ranges validated.
2024-12-02 12:54:10,134 - INFO -       record_number     region residence_type family_composition  sex  age  \
20               21  S92000003              P                  5    2    2   
47               48  S92000003              P                  0    1    2   
48               49  S92000003              P                  0    1    3   
85               86  S92000003              P                  1    1    2   
88               89  S92000003              P                  1    1    3   
...             ...        ...            ...                ...  ...  ...   
8818           8819  S92000003              P                  1    2    2   
8875           8876  S92000003              P                  1    2    2   
8886           8887  S92000003              P                  4    2    2   
8906           8907  S92000003              P                  4    1    2   
8930           8931  S92000003              P                  1    1    2   

      marital_status  student  country_of_birth  health  ethnic_group  \
20                 1        1                 2       2             1   
47                 1        1                 2       1             1   
48                 2        1                 2       1             4   
85                 1        1                 2       1             1   
88                 2        1                 1       2             1   
...              ...      ...               ...     ...           ...   
8818               1        1                 1       1             1   
8875               1        1                 2       1             1   
8886               1        1                 1       1             1   
8906               1        1                 1       1             1   
8930               1        1                 1       1             1   

      religion economic_activity occupation industry hours_worked_per_week  \
20           2                 6          X        X                     X   
47           1                 6          X        X                     X   
48           2                 6          2        8                     X   
85           2                 6          X        X                     X   
88           2                 6          2       10                     X   
...        ...               ...        ...      ...                   ...   
8818         2                 6          X        X                     X   
8875         1                 6          X        X                     X   
8886         1                 6          X        X                     X   
8906         2                 6          X        X                     X   
8930         1                 6          7        4                     X   

     approximate_social_grade  
20                          2  
47                          2  
48                          2  
85                          1  
88                          2  
...                       ...  
8818                        4  
8875                        2  
8886                        1  
8906                        4  
8930                        2  

[372 rows x 17 columns]
2024-12-02 12:54:10,139 - INFO - Rule 1: Found 372 rows to delete, saved to data/rule_1_deleted_data.csv
2024-12-02 12:54:10,141 - INFO - Rule 2: No rows to delete
2024-12-02 12:54:10,145 - INFO - Rule 3: Found 123 rows to delete, saved to data/rule_3_deleted_data.csv
2024-12-02 12:54:10,151 - INFO - Rule 4: Found 327 rows to delete, saved to data/rule_4_deleted_data.csv
2024-12-02 12:54:10,152 - INFO - Rule 5: No rows to delete
2024-12-02 12:54:10,157 - INFO - Rule 6: Found 123 rows to delete, saved to data/rule_6_deleted_data.csv
2024-12-02 12:54:10,168 - INFO - Starting data cleaning process...
2024-12-02 12:54:10,228 - INFO - Processing batch 1...
2024-12-02 12:54:10,228 - INFO - =====Checking for missing value:=====
2024-12-02 12:54:10,245 - INFO - No missing values detected.
2024-12-02 12:54:10,246 - INFO - =====Checking for duplicate rows:=====
2024-12-02 12:54:10,272 - INFO - No duplicate rows detected.
2024-12-02 12:54:10,280 - INFO -        record_number     region residence_type family_composition  sex  age  \
20                21  S92000003              P                  5    2    2   
47                48  S92000003              P                  0    1    2   
48                49  S92000003              P                  0    1    3   
85                86  S92000003              P                  1    1    2   
88                89  S92000003              P                  1    1    3   
...              ...        ...            ...                ...  ...  ...   
63295          63296  S92000003              P                  1    1    2   
63317          63318  S92000003              P                  0    2    2   
63350          63351  S92000003              P                  1    1    2   
63366          63367  S92000003              P                  4    2    2   
63383          63384  S92000003              P                  1    1    2   

       marital_status  student  country_of_birth  health  ethnic_group  \
20                  1        1                 2       2             1   
47                  1        1                 2       1             1   
48                  2        1                 2       1             4   
85                  1        1                 2       1             1   
88                  2        1                 1       2             1   
...               ...      ...               ...     ...           ...   
63295               1        1                 1       1             1   
63317               1        1                 2       2             3   
63350               1        1                 1       1             1   
63366               1        1                 1       1             1   
63383               1        1                 1       1             1   

       religion economic_activity occupation industry hours_worked_per_week  \
20            2                 6          X        X                     X   
47            1                 6          X        X                     X   
48            2                 6          2        8                     X   
85            2                 6          X        X                     X   
88            2                 6          2       10                     X   
...         ...               ...        ...      ...                   ...   
63295         2                 6          7        4                     X   
63317         1                 6          X        X                     X   
63350         1                 6          X        X                     X   
63366         1                 6          X        X                     X   
63383         2                 6          X        X                     X   

      approximate_social_grade  
20                           2  
47                           2  
48                           2  
85                           1  
88                           2  
...                        ...  
63295                        2  
63317                        2  
63350                        4  
63366                        2  
63383                        3  

[2598 rows x 17 columns]
2024-12-02 12:54:10,298 - INFO - Rule 1: Found 2598 rows to delete, saved to data/rule_1_deleted_data.csv
2024-12-02 12:54:10,305 - INFO - Rule 2: No rows to delete
2024-12-02 12:54:10,324 - INFO - Rule 3: Found 843 rows to delete, saved to data/rule_3_deleted_data.csv
2024-12-02 12:54:10,353 - INFO - Rule 4: Found 2362 rows to delete, saved to data/rule_4_deleted_data.csv
2024-12-02 12:54:10,362 - INFO - Rule 5: No rows to delete
2024-12-02 12:54:10,496 - INFO - Rule 6: Found 843 rows to delete, saved to data/rule_6_deleted_data.csv
2024-12-02 12:54:10,511 - INFO - =====validate_data_ranges:=====
2024-12-02 12:54:10,974 - INFO - 
Unique categories and counts per column:
2024-12-02 12:54:10,974 - INFO - residence_type: ['P', 'C'] (Total unique: 2)
2024-12-02 12:54:10,974 - INFO - family_composition: ['2', '1', '3', '4', '0', '5', 'X'] (Total unique: 7)
2024-12-02 12:54:10,974 - INFO - sex: [1, 2] (Total unique: 2)
2024-12-02 12:54:10,974 - INFO - age: [1, 2, 3, 4, 5, 6, 7, 8] (Total unique: 8)
2024-12-02 12:54:10,974 - INFO - marital_status: [1, 2, 3, 4, 5] (Total unique: 5)
2024-12-02 12:54:10,974 - INFO - student: [1, 2] (Total unique: 2)
2024-12-02 12:54:10,974 - INFO - country_of_birth: [1, 2] (Total unique: 2)
2024-12-02 12:54:10,974 - INFO - health: [1, 2, 3, 4, 5] (Total unique: 5)
2024-12-02 12:54:10,974 - INFO - ethnic_group: [1, 2, 3, 4, 5, 6] (Total unique: 6)
2024-12-02 12:54:10,974 - INFO - religion: [1, 2, 3, 4, 5, 6, 7, 8, 9] (Total unique: 9)
2024-12-02 12:54:10,974 - INFO - economic_activity: ['2', '8', '1', '3', '4', '7', '5', '6', 'X', '9'] (Total unique: 10)
2024-12-02 12:54:10,974 - INFO - occupation: ['2', '8', '1', '3', '4', '7', '5', '6', 'X', '9'] (Total unique: 10)
2024-12-02 12:54:10,974 - INFO - industry: ['2', '12', '8', '11', '13', '3', '4', '1', '10', '7', '5', '6', 'X', '9'] (Total unique: 14)
2024-12-02 12:54:10,974 - INFO - hours_worked_per_week: ['2', '1', '3', '4', 'X'] (Total unique: 5)
2024-12-02 12:54:10,974 - INFO - approximate_social_grade: ['2', '1', '3', '4', 'X'] (Total unique: 5)
2024-12-02 12:54:10,974 - INFO - 
All data ranges validated.
2024-12-02 12:54:10,974 - INFO - =====Verifying 'record_number' uniqueness:=====
2024-12-02 12:54:10,974 - INFO - Columns in batch: ['record_number', 'region', 'residence_type', 'family_composition', 'sex', 'age', 'marital_status', 'student', 'country_of_birth', 'health', 'ethnic_group', 'religion', 'economic_activity', 'occupation', 'industry', 'hours_worked_per_week', 'approximate_social_grade']
2024-12-02 12:54:10,976 - INFO - Record_Number is unique.
2024-12-02 12:54:10,984 - INFO - 'record_number' column reset.
2024-12-02 12:54:11,176 - INFO - Batch 1 cleaned and saved.
2024-12-02 12:54:11,179 - INFO - Progress saved to /cs/home/sz92/Documents/CS5002/P3/notebooks/progress.json.
2024-12-02 12:54:11,179 - INFO - Data cleaning process completed. Total rows processed: 63388
2024-12-02 12:54:11,179 - INFO - Rows to drop: 5297
2024-12-02 12:54:11,179 - INFO - Cleaned data saved to ../data/output.csv
2024-12-02 12:54:11,180 - INFO - Progress file removed. Data processing complete.
2024-12-02 12:54:11,226 - INFO - Data clean code test passed. Congratulations! Result deatils in log/data_cleaning.log
2024-12-02 12:54:47,716 - INFO - =====Checking for missing value:=====
2024-12-02 12:54:47,729 - INFO - No missing values detected.
2024-12-02 12:54:56,565 - WARNING - Progress file progress.json not found. Starting from the beginning.
2024-12-02 12:54:56,625 - INFO - Loaded data from row 0.
2024-12-02 12:54:56,626 - INFO - Columns in DataFrame: ['record_number', 'region', 'residence_type', 'family_composition', 'sex', 'age', 'marital_status', 'student', 'country_of_birth', 'health', 'ethnic_group', 'religion', 'economic_activity', 'occupation', 'industry', 'hours_worked_per_week', 'approximate_social_grade']
2024-12-02 12:54:56,637 - INFO - =====Checking data types:=====
2024-12-02 12:54:56,644 - INFO - Batch info:
None
2024-12-02 12:54:56,689 - INFO - =====Checking for missing value:=====
2024-12-02 12:54:56,693 - INFO - No missing values detected.
2024-12-02 12:54:56,697 - INFO - =====Checking for duplicate rows:=====
2024-12-02 12:54:56,703 - INFO - No duplicate rows detected.
2024-12-02 12:54:56,707 - INFO - =====Verifying 'record_number' uniqueness:=====
2024-12-02 12:54:56,707 - INFO - Columns in batch: ['record_number', 'region', 'residence_type', 'family_composition', 'sex', 'age', 'marital_status', 'student', 'country_of_birth', 'health', 'ethnic_group', 'religion', 'economic_activity', 'occupation', 'industry', 'hours_worked_per_week', 'approximate_social_grade']
2024-12-02 12:54:56,708 - INFO - Record_Number is unique.
2024-12-02 12:54:56,712 - INFO - =====validate_data_ranges:=====
2024-12-02 12:54:56,801 - INFO - 
Unique categories and counts per column:
2024-12-02 12:54:56,801 - INFO - residence_type: ['P', 'C'] (Total unique: 2)
2024-12-02 12:54:56,801 - INFO - family_composition: ['4', '1', '3', '0', 'X', '5', '2'] (Total unique: 7)
2024-12-02 12:54:56,801 - INFO - sex: [1, 2] (Total unique: 2)
2024-12-02 12:54:56,801 - INFO - age: [1, 2, 3, 4, 5, 6, 7, 8] (Total unique: 8)
2024-12-02 12:54:56,801 - INFO - marital_status: [1, 2, 3, 4, 5] (Total unique: 5)
2024-12-02 12:54:56,801 - INFO - student: [1, 2] (Total unique: 2)
2024-12-02 12:54:56,801 - INFO - country_of_birth: [1, 2] (Total unique: 2)
2024-12-02 12:54:56,801 - INFO - health: [1, 2, 3, 4, 5] (Total unique: 5)
2024-12-02 12:54:56,801 - INFO - ethnic_group: [1, 2, 3, 4, 5, 6] (Total unique: 6)
2024-12-02 12:54:56,801 - INFO - religion: [1, 2, 3, 4, 5, 6, 7, 8, 9] (Total unique: 9)
2024-12-02 12:54:56,801 - INFO - economic_activity: ['4', '6', '1', '3', '8', '9', 'X', '5', '2', '7'] (Total unique: 10)
2024-12-02 12:54:56,801 - INFO - occupation: ['4', '6', '1', '3', '8', '9', 'X', '5', '2', '7'] (Total unique: 10)
2024-12-02 12:54:56,801 - INFO - industry: ['4', '6', '10', '1', '3', '8', '13', '11', '9', 'X', '5', '12', '2', '7'] (Total unique: 14)
2024-12-02 12:54:56,801 - INFO - hours_worked_per_week: ['4', '1', '3', 'X', '2'] (Total unique: 5)
2024-12-02 12:54:56,801 - INFO - approximate_social_grade: ['4', '1', '3', 'X', '2'] (Total unique: 5)
2024-12-02 12:54:56,802 - INFO - 
All data ranges validated.
2024-12-02 12:54:56,813 - INFO -       record_number     region residence_type family_composition  sex  age  \
20               21  S92000003              P                  5    2    2   
47               48  S92000003              P                  0    1    2   
48               49  S92000003              P                  0    1    3   
85               86  S92000003              P                  1    1    2   
88               89  S92000003              P                  1    1    3   
...             ...        ...            ...                ...  ...  ...   
8818           8819  S92000003              P                  1    2    2   
8875           8876  S92000003              P                  1    2    2   
8886           8887  S92000003              P                  4    2    2   
8906           8907  S92000003              P                  4    1    2   
8930           8931  S92000003              P                  1    1    2   

      marital_status  student  country_of_birth  health  ethnic_group  \
20                 1        1                 2       2             1   
47                 1        1                 2       1             1   
48                 2        1                 2       1             4   
85                 1        1                 2       1             1   
88                 2        1                 1       2             1   
...              ...      ...               ...     ...           ...   
8818               1        1                 1       1             1   
8875               1        1                 2       1             1   
8886               1        1                 1       1             1   
8906               1        1                 1       1             1   
8930               1        1                 1       1             1   

      religion economic_activity occupation industry hours_worked_per_week  \
20           2                 6          X        X                     X   
47           1                 6          X        X                     X   
48           2                 6          2        8                     X   
85           2                 6          X        X                     X   
88           2                 6          2       10                     X   
...        ...               ...        ...      ...                   ...   
8818         2                 6          X        X                     X   
8875         1                 6          X        X                     X   
8886         1                 6          X        X                     X   
8906         2                 6          X        X                     X   
8930         1                 6          7        4                     X   

     approximate_social_grade  
20                          2  
47                          2  
48                          2  
85                          1  
88                          2  
...                       ...  
8818                        4  
8875                        2  
8886                        1  
8906                        4  
8930                        2  

[372 rows x 17 columns]
2024-12-02 12:54:56,818 - INFO - Rule 1: Found 372 rows to delete, saved to data/rule_1_deleted_data.csv
2024-12-02 12:54:56,820 - INFO - Rule 2: No rows to delete
2024-12-02 12:54:56,825 - INFO - Rule 3: Found 123 rows to delete, saved to data/rule_3_deleted_data.csv
2024-12-02 12:54:56,830 - INFO - Rule 4: Found 327 rows to delete, saved to data/rule_4_deleted_data.csv
2024-12-02 12:54:56,832 - INFO - Rule 5: No rows to delete
2024-12-02 12:54:56,837 - INFO - Rule 6: Found 123 rows to delete, saved to data/rule_6_deleted_data.csv
2024-12-02 12:54:56,848 - INFO - Starting data cleaning process...
2024-12-02 12:54:56,906 - INFO - Processing batch 1...
2024-12-02 12:54:56,906 - INFO - =====Checking for missing value:=====
2024-12-02 12:54:56,924 - INFO - No missing values detected.
2024-12-02 12:54:56,924 - INFO - =====Checking for duplicate rows:=====
2024-12-02 12:54:56,950 - INFO - No duplicate rows detected.
2024-12-02 12:54:56,958 - INFO -        record_number     region residence_type family_composition  sex  age  \
20                21  S92000003              P                  5    2    2   
47                48  S92000003              P                  0    1    2   
48                49  S92000003              P                  0    1    3   
85                86  S92000003              P                  1    1    2   
88                89  S92000003              P                  1    1    3   
...              ...        ...            ...                ...  ...  ...   
63295          63296  S92000003              P                  1    1    2   
63317          63318  S92000003              P                  0    2    2   
63350          63351  S92000003              P                  1    1    2   
63366          63367  S92000003              P                  4    2    2   
63383          63384  S92000003              P                  1    1    2   

       marital_status  student  country_of_birth  health  ethnic_group  \
20                  1        1                 2       2             1   
47                  1        1                 2       1             1   
48                  2        1                 2       1             4   
85                  1        1                 2       1             1   
88                  2        1                 1       2             1   
...               ...      ...               ...     ...           ...   
63295               1        1                 1       1             1   
63317               1        1                 2       2             3   
63350               1        1                 1       1             1   
63366               1        1                 1       1             1   
63383               1        1                 1       1             1   

       religion economic_activity occupation industry hours_worked_per_week  \
20            2                 6          X        X                     X   
47            1                 6          X        X                     X   
48            2                 6          2        8                     X   
85            2                 6          X        X                     X   
88            2                 6          2       10                     X   
...         ...               ...        ...      ...                   ...   
63295         2                 6          7        4                     X   
63317         1                 6          X        X                     X   
63350         1                 6          X        X                     X   
63366         1                 6          X        X                     X   
63383         2                 6          X        X                     X   

      approximate_social_grade  
20                           2  
47                           2  
48                           2  
85                           1  
88                           2  
...                        ...  
63295                        2  
63317                        2  
63350                        4  
63366                        2  
63383                        3  

[2598 rows x 17 columns]
2024-12-02 12:54:56,968 - INFO - Rule 1: Found 2598 rows to delete, saved to data/rule_1_deleted_data.csv
2024-12-02 12:54:56,976 - INFO - Rule 2: No rows to delete
2024-12-02 12:54:56,987 - INFO - Rule 3: Found 843 rows to delete, saved to data/rule_3_deleted_data.csv
2024-12-02 12:54:57,004 - INFO - Rule 4: Found 2362 rows to delete, saved to data/rule_4_deleted_data.csv
2024-12-02 12:54:57,011 - INFO - Rule 5: No rows to delete
2024-12-02 12:54:57,023 - INFO - Rule 6: Found 843 rows to delete, saved to data/rule_6_deleted_data.csv
2024-12-02 12:54:57,028 - INFO - =====validate_data_ranges:=====
2024-12-02 12:54:57,480 - INFO - 
Unique categories and counts per column:
2024-12-02 12:54:57,480 - INFO - residence_type: ['P', 'C'] (Total unique: 2)
2024-12-02 12:54:57,480 - INFO - family_composition: ['4', '1', '3', '0', 'X', '5', '2'] (Total unique: 7)
2024-12-02 12:54:57,480 - INFO - sex: [1, 2] (Total unique: 2)
2024-12-02 12:54:57,480 - INFO - age: [1, 2, 3, 4, 5, 6, 7, 8] (Total unique: 8)
2024-12-02 12:54:57,480 - INFO - marital_status: [1, 2, 3, 4, 5] (Total unique: 5)
2024-12-02 12:54:57,480 - INFO - student: [1, 2] (Total unique: 2)
2024-12-02 12:54:57,480 - INFO - country_of_birth: [1, 2] (Total unique: 2)
2024-12-02 12:54:57,480 - INFO - health: [1, 2, 3, 4, 5] (Total unique: 5)
2024-12-02 12:54:57,480 - INFO - ethnic_group: [1, 2, 3, 4, 5, 6] (Total unique: 6)
2024-12-02 12:54:57,480 - INFO - religion: [1, 2, 3, 4, 5, 6, 7, 8, 9] (Total unique: 9)
2024-12-02 12:54:57,480 - INFO - economic_activity: ['4', '6', '1', '3', '8', '9', 'X', '5', '2', '7'] (Total unique: 10)
2024-12-02 12:54:57,480 - INFO - occupation: ['4', '6', '1', '3', '8', '9', 'X', '5', '2', '7'] (Total unique: 10)
2024-12-02 12:54:57,480 - INFO - industry: ['4', '6', '10', '1', '3', '8', '13', '11', '9', 'X', '5', '12', '2', '7'] (Total unique: 14)
2024-12-02 12:54:57,481 - INFO - hours_worked_per_week: ['4', '1', '3', 'X', '2'] (Total unique: 5)
2024-12-02 12:54:57,481 - INFO - approximate_social_grade: ['4', '1', '3', 'X', '2'] (Total unique: 5)
2024-12-02 12:54:57,481 - INFO - 
All data ranges validated.
2024-12-02 12:54:57,481 - INFO - =====Verifying 'record_number' uniqueness:=====
2024-12-02 12:54:57,481 - INFO - Columns in batch: ['record_number', 'region', 'residence_type', 'family_composition', 'sex', 'age', 'marital_status', 'student', 'country_of_birth', 'health', 'ethnic_group', 'religion', 'economic_activity', 'occupation', 'industry', 'hours_worked_per_week', 'approximate_social_grade']
2024-12-02 12:54:57,482 - INFO - Record_Number is unique.
2024-12-02 12:54:57,491 - INFO - 'record_number' column reset.
2024-12-02 12:54:57,708 - INFO - Batch 1 cleaned and saved.
2024-12-02 12:54:57,711 - INFO - Progress saved to /cs/home/sz92/Documents/CS5002/P3/notebooks/progress.json.
2024-12-02 12:54:57,711 - INFO - Data cleaning process completed. Total rows processed: 63388
2024-12-02 12:54:57,711 - INFO - Rows to drop: 5297
2024-12-02 12:54:57,711 - INFO - Cleaned data saved to ../data/output.csv
2024-12-02 12:54:57,712 - INFO - Progress file removed. Data processing complete.
2024-12-02 12:54:57,754 - INFO - Data clean code test passed. Congratulations! Result deatils in log/data_cleaning.log
2024-12-02 13:01:00,990 - WARNING - Progress file progress.json not found. Starting from the beginning.
2024-12-02 13:01:01,064 - INFO - Loaded data from row 0.
2024-12-02 13:01:01,064 - INFO - Columns in DataFrame: ['record_number', 'region', 'residence_type', 'family_composition', 'sex', 'age', 'marital_status', 'student', 'country_of_birth', 'health', 'ethnic_group', 'religion', 'economic_activity', 'occupation', 'industry', 'hours_worked_per_week', 'approximate_social_grade']
2024-12-02 13:01:01,076 - INFO - =====Checking data types:=====
2024-12-02 13:01:01,082 - INFO - Batch info:
None
2024-12-02 13:01:01,126 - INFO - =====Checking for missing value:=====
2024-12-02 13:01:01,130 - INFO - No missing values detected.
2024-12-02 13:01:01,135 - INFO - =====Checking for duplicate rows:=====
2024-12-02 13:01:01,151 - INFO - No duplicate rows detected.
2024-12-02 13:01:01,160 - INFO - =====Verifying 'record_number' uniqueness:=====
2024-12-02 13:01:01,160 - INFO - Columns in batch: ['record_number', 'region', 'residence_type', 'family_composition', 'sex', 'age', 'marital_status', 'student', 'country_of_birth', 'health', 'ethnic_group', 'religion', 'economic_activity', 'occupation', 'industry', 'hours_worked_per_week', 'approximate_social_grade']
2024-12-02 13:01:01,161 - INFO - Record_Number is unique.
2024-12-02 13:01:01,168 - INFO - =====validate_data_ranges:=====
2024-12-02 13:01:01,239 - INFO - 
Unique categories and counts per column:
2024-12-02 13:01:01,239 - INFO - residence_type: ['C', 'P'] (Total unique: 2)
2024-12-02 13:01:01,239 - INFO - family_composition: ['2', '1', '5', 'X', '0', '4', '3'] (Total unique: 7)
2024-12-02 13:01:01,239 - INFO - sex: [1, 2] (Total unique: 2)
2024-12-02 13:01:01,239 - INFO - age: [1, 2, 3, 4, 5, 6, 7, 8] (Total unique: 8)
2024-12-02 13:01:01,239 - INFO - marital_status: [1, 2, 3, 4, 5] (Total unique: 5)
2024-12-02 13:01:01,239 - INFO - student: [1, 2] (Total unique: 2)
2024-12-02 13:01:01,239 - INFO - country_of_birth: [1, 2] (Total unique: 2)
2024-12-02 13:01:01,239 - INFO - health: [1, 2, 3, 4, 5] (Total unique: 5)
2024-12-02 13:01:01,239 - INFO - ethnic_group: [1, 2, 3, 4, 5, 6] (Total unique: 6)
2024-12-02 13:01:01,239 - INFO - religion: [1, 2, 3, 4, 5, 6, 7, 8, 9] (Total unique: 9)
2024-12-02 13:01:01,239 - INFO - economic_activity: ['6', '2', '7', '8', '1', '5', '9', 'X', '4', '3'] (Total unique: 10)
2024-12-02 13:01:01,239 - INFO - occupation: ['6', '2', '8', '7', '1', '5', '9', 'X', '4', '3'] (Total unique: 10)
2024-12-02 13:01:01,239 - INFO - industry: ['6', '2', '8', '7', '12', '13', '1', '11', '5', '9', 'X', '10', '4', '3'] (Total unique: 14)
2024-12-02 13:01:01,239 - INFO - hours_worked_per_week: ['2', '1', 'X', '4', '3'] (Total unique: 5)
2024-12-02 13:01:01,239 - INFO - approximate_social_grade: ['2', '1', 'X', '4', '3'] (Total unique: 5)
2024-12-02 13:01:01,240 - INFO - 
All data ranges validated.
2024-12-02 13:01:01,248 - INFO -       record_number     region residence_type family_composition  sex  age  \
20               21  S92000003              P                  5    2    2   
47               48  S92000003              P                  0    1    2   
48               49  S92000003              P                  0    1    3   
85               86  S92000003              P                  1    1    2   
88               89  S92000003              P                  1    1    3   
...             ...        ...            ...                ...  ...  ...   
8818           8819  S92000003              P                  1    2    2   
8875           8876  S92000003              P                  1    2    2   
8886           8887  S92000003              P                  4    2    2   
8906           8907  S92000003              P                  4    1    2   
8930           8931  S92000003              P                  1    1    2   

      marital_status  student  country_of_birth  health  ethnic_group  \
20                 1        1                 2       2             1   
47                 1        1                 2       1             1   
48                 2        1                 2       1             4   
85                 1        1                 2       1             1   
88                 2        1                 1       2             1   
...              ...      ...               ...     ...           ...   
8818               1        1                 1       1             1   
8875               1        1                 2       1             1   
8886               1        1                 1       1             1   
8906               1        1                 1       1             1   
8930               1        1                 1       1             1   

      religion economic_activity occupation industry hours_worked_per_week  \
20           2                 6          X        X                     X   
47           1                 6          X        X                     X   
48           2                 6          2        8                     X   
85           2                 6          X        X                     X   
88           2                 6          2       10                     X   
...        ...               ...        ...      ...                   ...   
8818         2                 6          X        X                     X   
8875         1                 6          X        X                     X   
8886         1                 6          X        X                     X   
8906         2                 6          X        X                     X   
8930         1                 6          7        4                     X   

     approximate_social_grade  
20                          2  
47                          2  
48                          2  
85                          1  
88                          2  
...                       ...  
8818                        4  
8875                        2  
8886                        1  
8906                        4  
8930                        2  

[372 rows x 17 columns]
2024-12-02 13:01:01,254 - INFO - Rule 1: Found 372 rows to delete, saved to data/rule_1_deleted_data.csv
2024-12-02 13:01:01,258 - INFO - Rule 2: No rows to delete
2024-12-02 13:01:01,266 - INFO - Rule 3: Found 123 rows to delete, saved to data/rule_3_deleted_data.csv
2024-12-02 13:01:01,275 - INFO - Rule 4: Found 327 rows to delete, saved to data/rule_4_deleted_data.csv
2024-12-02 13:01:01,278 - INFO - Rule 5: No rows to delete
2024-12-02 13:01:01,285 - INFO - Rule 6: Found 123 rows to delete, saved to data/rule_6_deleted_data.csv
2024-12-02 13:01:01,302 - INFO - Starting data cleaning process...
2024-12-02 13:01:01,358 - INFO - Processing batch 1...
2024-12-02 13:01:01,358 - INFO - =====Checking for missing value:=====
2024-12-02 13:01:01,375 - INFO - No missing values detected.
2024-12-02 13:01:01,375 - INFO - =====Checking for duplicate rows:=====
2024-12-02 13:01:01,400 - INFO - No duplicate rows detected.
2024-12-02 13:01:01,408 - INFO -        record_number     region residence_type family_composition  sex  age  \
20                21  S92000003              P                  5    2    2   
47                48  S92000003              P                  0    1    2   
48                49  S92000003              P                  0    1    3   
85                86  S92000003              P                  1    1    2   
88                89  S92000003              P                  1    1    3   
...              ...        ...            ...                ...  ...  ...   
63295          63296  S92000003              P                  1    1    2   
63317          63318  S92000003              P                  0    2    2   
63350          63351  S92000003              P                  1    1    2   
63366          63367  S92000003              P                  4    2    2   
63383          63384  S92000003              P                  1    1    2   

       marital_status  student  country_of_birth  health  ethnic_group  \
20                  1        1                 2       2             1   
47                  1        1                 2       1             1   
48                  2        1                 2       1             4   
85                  1        1                 2       1             1   
88                  2        1                 1       2             1   
...               ...      ...               ...     ...           ...   
63295               1        1                 1       1             1   
63317               1        1                 2       2             3   
63350               1        1                 1       1             1   
63366               1        1                 1       1             1   
63383               1        1                 1       1             1   

       religion economic_activity occupation industry hours_worked_per_week  \
20            2                 6          X        X                     X   
47            1                 6          X        X                     X   
48            2                 6          2        8                     X   
85            2                 6          X        X                     X   
88            2                 6          2       10                     X   
...         ...               ...        ...      ...                   ...   
63295         2                 6          7        4                     X   
63317         1                 6          X        X                     X   
63350         1                 6          X        X                     X   
63366         1                 6          X        X                     X   
63383         2                 6          X        X                     X   

      approximate_social_grade  
20                           2  
47                           2  
48                           2  
85                           1  
88                           2  
...                        ...  
63295                        2  
63317                        2  
63350                        4  
63366                        2  
63383                        3  

[2598 rows x 17 columns]
2024-12-02 13:01:01,419 - INFO - Rule 1: Found 2598 rows to delete, saved to data/rule_1_deleted_data.csv
2024-12-02 13:01:01,426 - INFO - Rule 2: No rows to delete
2024-12-02 13:01:01,438 - INFO - Rule 3: Found 843 rows to delete, saved to data/rule_3_deleted_data.csv
2024-12-02 13:01:01,454 - INFO - Rule 4: Found 2362 rows to delete, saved to data/rule_4_deleted_data.csv
2024-12-02 13:01:01,461 - INFO - Rule 5: No rows to delete
2024-12-02 13:01:01,473 - INFO - Rule 6: Found 843 rows to delete, saved to data/rule_6_deleted_data.csv
2024-12-02 13:01:01,479 - INFO - =====validate_data_ranges:=====
2024-12-02 13:01:01,915 - INFO - 
Unique categories and counts per column:
2024-12-02 13:01:01,916 - INFO - residence_type: ['C', 'P'] (Total unique: 2)
2024-12-02 13:01:01,916 - INFO - family_composition: ['2', '1', '5', 'X', '0', '4', '3'] (Total unique: 7)
2024-12-02 13:01:01,916 - INFO - sex: [1, 2] (Total unique: 2)
2024-12-02 13:01:01,916 - INFO - age: [1, 2, 3, 4, 5, 6, 7, 8] (Total unique: 8)
2024-12-02 13:01:01,916 - INFO - marital_status: [1, 2, 3, 4, 5] (Total unique: 5)
2024-12-02 13:01:01,916 - INFO - student: [1, 2] (Total unique: 2)
2024-12-02 13:01:01,916 - INFO - country_of_birth: [1, 2] (Total unique: 2)
2024-12-02 13:01:01,916 - INFO - health: [1, 2, 3, 4, 5] (Total unique: 5)
2024-12-02 13:01:01,916 - INFO - ethnic_group: [1, 2, 3, 4, 5, 6] (Total unique: 6)
2024-12-02 13:01:01,916 - INFO - religion: [1, 2, 3, 4, 5, 6, 7, 8, 9] (Total unique: 9)
2024-12-02 13:01:01,916 - INFO - economic_activity: ['6', '2', '7', '8', '1', '5', '9', 'X', '4', '3'] (Total unique: 10)
2024-12-02 13:01:01,916 - INFO - occupation: ['6', '2', '8', '7', '1', '5', '9', 'X', '4', '3'] (Total unique: 10)
2024-12-02 13:01:01,916 - INFO - industry: ['6', '2', '8', '7', '12', '13', '1', '11', '5', '9', 'X', '10', '4', '3'] (Total unique: 14)
2024-12-02 13:01:01,916 - INFO - hours_worked_per_week: ['2', '1', 'X', '4', '3'] (Total unique: 5)
2024-12-02 13:01:01,916 - INFO - approximate_social_grade: ['2', '1', 'X', '4', '3'] (Total unique: 5)
2024-12-02 13:01:01,916 - INFO - 
All data ranges validated.
2024-12-02 13:01:01,916 - INFO - =====Verifying 'record_number' uniqueness:=====
2024-12-02 13:01:01,916 - INFO - Columns in batch: ['record_number', 'region', 'residence_type', 'family_composition', 'sex', 'age', 'marital_status', 'student', 'country_of_birth', 'health', 'ethnic_group', 'religion', 'economic_activity', 'occupation', 'industry', 'hours_worked_per_week', 'approximate_social_grade']
2024-12-02 13:01:01,918 - INFO - Record_Number is unique.
2024-12-02 13:01:01,927 - INFO - 'record_number' column reset.
2024-12-02 13:01:02,099 - INFO - Batch 1 cleaned and saved.
2024-12-02 13:01:02,103 - INFO - Progress saved to /cs/home/sz92/Documents/CS5002/P3/notebooks/progress.json.
2024-12-02 13:01:02,103 - INFO - Data cleaning process completed. Total rows processed: 63388
2024-12-02 13:01:02,104 - INFO - Rows to drop: 5297
2024-12-02 13:01:02,104 - INFO - Cleaned data saved to ../data/output.csv
2024-12-02 13:01:02,104 - INFO - Progress file removed. Data processing complete.
2024-12-02 13:01:02,145 - INFO - Data clean code test passed. Congratulations! Result deatils in log/data_cleaning.log
2024-12-02 13:01:50,441 - WARNING - Progress file progress.json not found. Starting from the beginning.
2024-12-02 13:01:50,499 - INFO - Loaded data from row 0.
2024-12-02 13:01:50,499 - INFO - Columns in DataFrame: ['record_number', 'region', 'residence_type', 'family_composition', 'sex', 'age', 'marital_status', 'student', 'country_of_birth', 'health', 'ethnic_group', 'religion', 'economic_activity', 'occupation', 'industry', 'hours_worked_per_week', 'approximate_social_grade']
2024-12-02 13:01:50,510 - INFO - =====Checking data types:=====
2024-12-02 13:01:50,517 - INFO - Batch info:
None
2024-12-02 13:01:50,562 - INFO - =====Checking for missing value:=====
2024-12-02 13:01:50,565 - INFO - No missing values detected.
2024-12-02 13:01:50,569 - INFO - =====Checking for duplicate rows:=====
2024-12-02 13:01:50,575 - INFO - No duplicate rows detected.
2024-12-02 13:01:50,579 - INFO - =====Verifying 'record_number' uniqueness:=====
2024-12-02 13:01:50,579 - INFO - Columns in batch: ['record_number', 'region', 'residence_type', 'family_composition', 'sex', 'age', 'marital_status', 'student', 'country_of_birth', 'health', 'ethnic_group', 'religion', 'economic_activity', 'occupation', 'industry', 'hours_worked_per_week', 'approximate_social_grade']
2024-12-02 13:01:50,580 - INFO - Record_Number is unique.
2024-12-02 13:01:50,584 - INFO - =====validate_data_ranges:=====
2024-12-02 13:01:50,664 - INFO - 
Unique categories and counts per column:
2024-12-02 13:01:50,664 - INFO - residence_type: ['P', 'C'] (Total unique: 2)
2024-12-02 13:01:50,664 - INFO - family_composition: ['X', '3', '1', '2', '5', '0', '4'] (Total unique: 7)
2024-12-02 13:01:50,664 - INFO - sex: [1, 2] (Total unique: 2)
2024-12-02 13:01:50,664 - INFO - age: [1, 2, 3, 4, 5, 6, 7, 8] (Total unique: 8)
2024-12-02 13:01:50,664 - INFO - marital_status: [1, 2, 3, 4, 5] (Total unique: 5)
2024-12-02 13:01:50,664 - INFO - student: [1, 2] (Total unique: 2)
2024-12-02 13:01:50,664 - INFO - country_of_birth: [1, 2] (Total unique: 2)
2024-12-02 13:01:50,664 - INFO - health: [1, 2, 3, 4, 5] (Total unique: 5)
2024-12-02 13:01:50,664 - INFO - ethnic_group: [1, 2, 3, 4, 5, 6] (Total unique: 6)
2024-12-02 13:01:50,664 - INFO - religion: [1, 2, 3, 4, 5, 6, 7, 8, 9] (Total unique: 9)
2024-12-02 13:01:50,664 - INFO - economic_activity: ['9', '7', 'X', '6', '3', '8', '1', '5', '2', '4'] (Total unique: 10)
2024-12-02 13:01:50,664 - INFO - occupation: ['9', '7', 'X', '6', '3', '8', '1', '2', '5', '4'] (Total unique: 10)
2024-12-02 13:01:50,664 - INFO - industry: ['9', '7', 'X', '10', '6', '11', '3', '8', '13', '1', '5', '2', '12', '4'] (Total unique: 14)
2024-12-02 13:01:50,664 - INFO - hours_worked_per_week: ['X', '3', '1', '2', '4'] (Total unique: 5)
2024-12-02 13:01:50,664 - INFO - approximate_social_grade: ['X', '3', '1', '2', '4'] (Total unique: 5)
2024-12-02 13:01:50,664 - INFO - 
All data ranges validated.
2024-12-02 13:01:50,673 - INFO -       record_number     region residence_type family_composition  sex  age  \
20               21  S92000003              P                  5    2    2   
47               48  S92000003              P                  0    1    2   
48               49  S92000003              P                  0    1    3   
85               86  S92000003              P                  1    1    2   
88               89  S92000003              P                  1    1    3   
...             ...        ...            ...                ...  ...  ...   
8818           8819  S92000003              P                  1    2    2   
8875           8876  S92000003              P                  1    2    2   
8886           8887  S92000003              P                  4    2    2   
8906           8907  S92000003              P                  4    1    2   
8930           8931  S92000003              P                  1    1    2   

      marital_status  student  country_of_birth  health  ethnic_group  \
20                 1        1                 2       2             1   
47                 1        1                 2       1             1   
48                 2        1                 2       1             4   
85                 1        1                 2       1             1   
88                 2        1                 1       2             1   
...              ...      ...               ...     ...           ...   
8818               1        1                 1       1             1   
8875               1        1                 2       1             1   
8886               1        1                 1       1             1   
8906               1        1                 1       1             1   
8930               1        1                 1       1             1   

      religion economic_activity occupation industry hours_worked_per_week  \
20           2                 6          X        X                     X   
47           1                 6          X        X                     X   
48           2                 6          2        8                     X   
85           2                 6          X        X                     X   
88           2                 6          2       10                     X   
...        ...               ...        ...      ...                   ...   
8818         2                 6          X        X                     X   
8875         1                 6          X        X                     X   
8886         1                 6          X        X                     X   
8906         2                 6          X        X                     X   
8930         1                 6          7        4                     X   

     approximate_social_grade  
20                          2  
47                          2  
48                          2  
85                          1  
88                          2  
...                       ...  
8818                        4  
8875                        2  
8886                        1  
8906                        4  
8930                        2  

[372 rows x 17 columns]
2024-12-02 13:01:50,679 - INFO - Rule 1: Found 372 rows to delete, saved to data/rule_1_deleted_data.csv
2024-12-02 13:01:50,680 - INFO - Rule 2: No rows to delete
2024-12-02 13:01:50,684 - INFO - Rule 3: Found 123 rows to delete, saved to data/rule_3_deleted_data.csv
2024-12-02 13:01:50,690 - INFO - Rule 4: Found 327 rows to delete, saved to data/rule_4_deleted_data.csv
2024-12-02 13:01:50,692 - INFO - Rule 5: No rows to delete
2024-12-02 13:01:50,697 - INFO - Rule 6: Found 123 rows to delete, saved to data/rule_6_deleted_data.csv
2024-12-02 13:01:50,713 - INFO - Starting data cleaning process...
2024-12-02 13:01:50,771 - INFO - Processing batch 1...
2024-12-02 13:01:50,771 - INFO - =====Checking for missing value:=====
2024-12-02 13:01:50,788 - INFO - No missing values detected.
2024-12-02 13:01:50,788 - INFO - =====Checking for duplicate rows:=====
2024-12-02 13:01:50,814 - INFO - No duplicate rows detected.
2024-12-02 13:01:50,822 - INFO -        record_number     region residence_type family_composition  sex  age  \
20                21  S92000003              P                  5    2    2   
47                48  S92000003              P                  0    1    2   
48                49  S92000003              P                  0    1    3   
85                86  S92000003              P                  1    1    2   
88                89  S92000003              P                  1    1    3   
...              ...        ...            ...                ...  ...  ...   
63295          63296  S92000003              P                  1    1    2   
63317          63318  S92000003              P                  0    2    2   
63350          63351  S92000003              P                  1    1    2   
63366          63367  S92000003              P                  4    2    2   
63383          63384  S92000003              P                  1    1    2   

       marital_status  student  country_of_birth  health  ethnic_group  \
20                  1        1                 2       2             1   
47                  1        1                 2       1             1   
48                  2        1                 2       1             4   
85                  1        1                 2       1             1   
88                  2        1                 1       2             1   
...               ...      ...               ...     ...           ...   
63295               1        1                 1       1             1   
63317               1        1                 2       2             3   
63350               1        1                 1       1             1   
63366               1        1                 1       1             1   
63383               1        1                 1       1             1   

       religion economic_activity occupation industry hours_worked_per_week  \
20            2                 6          X        X                     X   
47            1                 6          X        X                     X   
48            2                 6          2        8                     X   
85            2                 6          X        X                     X   
88            2                 6          2       10                     X   
...         ...               ...        ...      ...                   ...   
63295         2                 6          7        4                     X   
63317         1                 6          X        X                     X   
63350         1                 6          X        X                     X   
63366         1                 6          X        X                     X   
63383         2                 6          X        X                     X   

      approximate_social_grade  
20                           2  
47                           2  
48                           2  
85                           1  
88                           2  
...                        ...  
63295                        2  
63317                        2  
63350                        4  
63366                        2  
63383                        3  

[2598 rows x 17 columns]
2024-12-02 13:01:50,833 - INFO - Rule 1: Found 2598 rows to delete, saved to data/rule_1_deleted_data.csv
2024-12-02 13:01:50,840 - INFO - Rule 2: No rows to delete
2024-12-02 13:01:50,853 - INFO - Rule 3: Found 843 rows to delete, saved to data/rule_3_deleted_data.csv
2024-12-02 13:01:50,871 - INFO - Rule 4: Found 2362 rows to delete, saved to data/rule_4_deleted_data.csv
2024-12-02 13:01:50,878 - INFO - Rule 5: No rows to delete
2024-12-02 13:01:50,891 - INFO - Rule 6: Found 843 rows to delete, saved to data/rule_6_deleted_data.csv
2024-12-02 13:01:50,896 - INFO - =====validate_data_ranges:=====
2024-12-02 13:01:51,337 - INFO - 
Unique categories and counts per column:
2024-12-02 13:01:51,337 - INFO - residence_type: ['P', 'C'] (Total unique: 2)
2024-12-02 13:01:51,337 - INFO - family_composition: ['X', '3', '1', '2', '5', '0', '4'] (Total unique: 7)
2024-12-02 13:01:51,337 - INFO - sex: [1, 2] (Total unique: 2)
2024-12-02 13:01:51,337 - INFO - age: [1, 2, 3, 4, 5, 6, 7, 8] (Total unique: 8)
2024-12-02 13:01:51,337 - INFO - marital_status: [1, 2, 3, 4, 5] (Total unique: 5)
2024-12-02 13:01:51,337 - INFO - student: [1, 2] (Total unique: 2)
2024-12-02 13:01:51,337 - INFO - country_of_birth: [1, 2] (Total unique: 2)
2024-12-02 13:01:51,337 - INFO - health: [1, 2, 3, 4, 5] (Total unique: 5)
2024-12-02 13:01:51,337 - INFO - ethnic_group: [1, 2, 3, 4, 5, 6] (Total unique: 6)
2024-12-02 13:01:51,337 - INFO - religion: [1, 2, 3, 4, 5, 6, 7, 8, 9] (Total unique: 9)
2024-12-02 13:01:51,337 - INFO - economic_activity: ['9', '7', 'X', '6', '3', '8', '1', '5', '2', '4'] (Total unique: 10)
2024-12-02 13:01:51,337 - INFO - occupation: ['9', '7', 'X', '6', '3', '8', '1', '2', '5', '4'] (Total unique: 10)
2024-12-02 13:01:51,337 - INFO - industry: ['9', '7', 'X', '10', '6', '11', '3', '8', '13', '1', '5', '2', '12', '4'] (Total unique: 14)
2024-12-02 13:01:51,337 - INFO - hours_worked_per_week: ['X', '3', '1', '2', '4'] (Total unique: 5)
2024-12-02 13:01:51,337 - INFO - approximate_social_grade: ['X', '3', '1', '2', '4'] (Total unique: 5)
2024-12-02 13:01:51,337 - INFO - 
All data ranges validated.
2024-12-02 13:01:51,337 - INFO - =====Verifying 'record_number' uniqueness:=====
2024-12-02 13:01:51,337 - INFO - Columns in batch: ['record_number', 'region', 'residence_type', 'family_composition', 'sex', 'age', 'marital_status', 'student', 'country_of_birth', 'health', 'ethnic_group', 'religion', 'economic_activity', 'occupation', 'industry', 'hours_worked_per_week', 'approximate_social_grade']
2024-12-02 13:01:51,339 - INFO - Record_Number is unique.
2024-12-02 13:01:51,347 - INFO - 'record_number' column reset.
2024-12-02 13:01:51,522 - INFO - Batch 1 cleaned and saved.
2024-12-02 13:01:51,524 - INFO - Progress saved to /cs/home/sz92/Documents/CS5002/P3/code/progress.json.
2024-12-02 13:01:51,525 - INFO - Data cleaning process completed. Total rows processed: 63388
2024-12-02 13:01:51,525 - INFO - Rows to drop: 5297
2024-12-02 13:01:51,525 - INFO - Cleaned data saved to ../data/output.csv
2024-12-02 13:01:51,526 - INFO - Progress file removed. Data processing complete.
2024-12-02 13:01:52,088 - INFO - Data clean code test passed. Congratulations! Result deatils in log/data_cleaning.log
2024-12-02 13:02:37,655 - WARNING - Progress file progress.json not found. Starting from the beginning.
2024-12-02 13:02:37,713 - INFO - Loaded data from row 0.
2024-12-02 13:02:37,713 - INFO - Columns in DataFrame: ['record_number', 'region', 'residence_type', 'family_composition', 'sex', 'age', 'marital_status', 'student', 'country_of_birth', 'health', 'ethnic_group', 'religion', 'economic_activity', 'occupation', 'industry', 'hours_worked_per_week', 'approximate_social_grade']
2024-12-02 13:02:37,724 - INFO - =====Checking data types:=====
2024-12-02 13:02:37,731 - INFO - Batch info:
None
2024-12-02 13:02:37,776 - INFO - =====Checking for missing value:=====
2024-12-02 13:02:37,779 - INFO - No missing values detected.
2024-12-02 13:02:37,782 - INFO - =====Checking for duplicate rows:=====
2024-12-02 13:02:37,788 - INFO - No duplicate rows detected.
2024-12-02 13:02:37,792 - INFO - =====Verifying 'record_number' uniqueness:=====
2024-12-02 13:02:37,792 - INFO - Columns in batch: ['record_number', 'region', 'residence_type', 'family_composition', 'sex', 'age', 'marital_status', 'student', 'country_of_birth', 'health', 'ethnic_group', 'religion', 'economic_activity', 'occupation', 'industry', 'hours_worked_per_week', 'approximate_social_grade']
2024-12-02 13:02:37,793 - INFO - Record_Number is unique.
2024-12-02 13:02:37,796 - INFO - =====validate_data_ranges:=====
2024-12-02 13:02:37,876 - INFO - 
Unique categories and counts per column:
2024-12-02 13:02:37,876 - INFO - residence_type: ['P', 'C'] (Total unique: 2)
2024-12-02 13:02:37,876 - INFO - family_composition: ['X', '0', '2', '4', '3', '1', '5'] (Total unique: 7)
2024-12-02 13:02:37,876 - INFO - sex: [1, 2] (Total unique: 2)
2024-12-02 13:02:37,876 - INFO - age: [1, 2, 3, 4, 5, 6, 7, 8] (Total unique: 8)
2024-12-02 13:02:37,876 - INFO - marital_status: [1, 2, 3, 4, 5] (Total unique: 5)
2024-12-02 13:02:37,876 - INFO - student: [1, 2] (Total unique: 2)
2024-12-02 13:02:37,876 - INFO - country_of_birth: [1, 2] (Total unique: 2)
2024-12-02 13:02:37,876 - INFO - health: [1, 2, 3, 4, 5] (Total unique: 5)
2024-12-02 13:02:37,876 - INFO - ethnic_group: [1, 2, 3, 4, 5, 6] (Total unique: 6)
2024-12-02 13:02:37,876 - INFO - religion: [1, 2, 3, 4, 5, 6, 7, 8, 9] (Total unique: 9)
2024-12-02 13:02:37,876 - INFO - economic_activity: ['X', '7', '8', '6', '2', '4', '3', '1', '9', '5'] (Total unique: 10)
2024-12-02 13:02:37,876 - INFO - occupation: ['X', '7', '8', '6', '2', '4', '3', '5', '9', '1'] (Total unique: 10)
2024-12-02 13:02:37,876 - INFO - industry: ['9', 'X', '7', '6', '2', '4', '11', '3', '1', '10', '8', '13', '12', '5'] (Total unique: 14)
2024-12-02 13:02:37,876 - INFO - hours_worked_per_week: ['X', '2', '4', '3', '1'] (Total unique: 5)
2024-12-02 13:02:37,876 - INFO - approximate_social_grade: ['X', '2', '4', '3', '1'] (Total unique: 5)
2024-12-02 13:02:37,876 - INFO - 
All data ranges validated.
2024-12-02 13:02:37,886 - INFO -       record_number     region residence_type family_composition  sex  age  \
20               21  S92000003              P                  5    2    2   
47               48  S92000003              P                  0    1    2   
48               49  S92000003              P                  0    1    3   
85               86  S92000003              P                  1    1    2   
88               89  S92000003              P                  1    1    3   
...             ...        ...            ...                ...  ...  ...   
8818           8819  S92000003              P                  1    2    2   
8875           8876  S92000003              P                  1    2    2   
8886           8887  S92000003              P                  4    2    2   
8906           8907  S92000003              P                  4    1    2   
8930           8931  S92000003              P                  1    1    2   

      marital_status  student  country_of_birth  health  ethnic_group  \
20                 1        1                 2       2             1   
47                 1        1                 2       1             1   
48                 2        1                 2       1             4   
85                 1        1                 2       1             1   
88                 2        1                 1       2             1   
...              ...      ...               ...     ...           ...   
8818               1        1                 1       1             1   
8875               1        1                 2       1             1   
8886               1        1                 1       1             1   
8906               1        1                 1       1             1   
8930               1        1                 1       1             1   

      religion economic_activity occupation industry hours_worked_per_week  \
20           2                 6          X        X                     X   
47           1                 6          X        X                     X   
48           2                 6          2        8                     X   
85           2                 6          X        X                     X   
88           2                 6          2       10                     X   
...        ...               ...        ...      ...                   ...   
8818         2                 6          X        X                     X   
8875         1                 6          X        X                     X   
8886         1                 6          X        X                     X   
8906         2                 6          X        X                     X   
8930         1                 6          7        4                     X   

     approximate_social_grade  
20                          2  
47                          2  
48                          2  
85                          1  
88                          2  
...                       ...  
8818                        4  
8875                        2  
8886                        1  
8906                        4  
8930                        2  

[372 rows x 17 columns]
2024-12-02 13:02:37,891 - INFO - Rule 1: Found 372 rows to delete, saved to data/rule_1_deleted_data.csv
2024-12-02 13:02:37,893 - INFO - Rule 2: No rows to delete
2024-12-02 13:02:37,902 - INFO - Rule 3: Found 123 rows to delete, saved to data/rule_3_deleted_data.csv
2024-12-02 13:02:37,912 - INFO - Rule 4: Found 327 rows to delete, saved to data/rule_4_deleted_data.csv
2024-12-02 13:02:37,916 - INFO - Rule 5: No rows to delete
2024-12-02 13:02:37,924 - INFO - Rule 6: Found 123 rows to delete, saved to data/rule_6_deleted_data.csv
2024-12-02 13:02:37,944 - INFO - Starting data cleaning process...
2024-12-02 13:02:38,001 - INFO - Processing batch 1...
2024-12-02 13:02:38,002 - INFO - =====Checking for missing value:=====
2024-12-02 13:02:38,019 - INFO - No missing values detected.
2024-12-02 13:02:38,019 - INFO - =====Checking for duplicate rows:=====
2024-12-02 13:02:38,046 - INFO - No duplicate rows detected.
2024-12-02 13:02:38,054 - INFO -        record_number     region residence_type family_composition  sex  age  \
20                21  S92000003              P                  5    2    2   
47                48  S92000003              P                  0    1    2   
48                49  S92000003              P                  0    1    3   
85                86  S92000003              P                  1    1    2   
88                89  S92000003              P                  1    1    3   
...              ...        ...            ...                ...  ...  ...   
63295          63296  S92000003              P                  1    1    2   
63317          63318  S92000003              P                  0    2    2   
63350          63351  S92000003              P                  1    1    2   
63366          63367  S92000003              P                  4    2    2   
63383          63384  S92000003              P                  1    1    2   

       marital_status  student  country_of_birth  health  ethnic_group  \
20                  1        1                 2       2             1   
47                  1        1                 2       1             1   
48                  2        1                 2       1             4   
85                  1        1                 2       1             1   
88                  2        1                 1       2             1   
...               ...      ...               ...     ...           ...   
63295               1        1                 1       1             1   
63317               1        1                 2       2             3   
63350               1        1                 1       1             1   
63366               1        1                 1       1             1   
63383               1        1                 1       1             1   

       religion economic_activity occupation industry hours_worked_per_week  \
20            2                 6          X        X                     X   
47            1                 6          X        X                     X   
48            2                 6          2        8                     X   
85            2                 6          X        X                     X   
88            2                 6          2       10                     X   
...         ...               ...        ...      ...                   ...   
63295         2                 6          7        4                     X   
63317         1                 6          X        X                     X   
63350         1                 6          X        X                     X   
63366         1                 6          X        X                     X   
63383         2                 6          X        X                     X   

      approximate_social_grade  
20                           2  
47                           2  
48                           2  
85                           1  
88                           2  
...                        ...  
63295                        2  
63317                        2  
63350                        4  
63366                        2  
63383                        3  

[2598 rows x 17 columns]
2024-12-02 13:02:38,066 - INFO - Rule 1: Found 2598 rows to delete, saved to data/rule_1_deleted_data.csv
2024-12-02 13:02:38,073 - INFO - Rule 2: No rows to delete
2024-12-02 13:02:38,085 - INFO - Rule 3: Found 843 rows to delete, saved to data/rule_3_deleted_data.csv
2024-12-02 13:02:38,104 - INFO - Rule 4: Found 2362 rows to delete, saved to data/rule_4_deleted_data.csv
2024-12-02 13:02:38,110 - INFO - Rule 5: No rows to delete
2024-12-02 13:02:38,122 - INFO - Rule 6: Found 843 rows to delete, saved to data/rule_6_deleted_data.csv
2024-12-02 13:02:38,127 - INFO - =====validate_data_ranges:=====
2024-12-02 13:02:38,570 - INFO - 
Unique categories and counts per column:
2024-12-02 13:02:38,570 - INFO - residence_type: ['P', 'C'] (Total unique: 2)
2024-12-02 13:02:38,570 - INFO - family_composition: ['X', '0', '2', '4', '3', '1', '5'] (Total unique: 7)
2024-12-02 13:02:38,570 - INFO - sex: [1, 2] (Total unique: 2)
2024-12-02 13:02:38,570 - INFO - age: [1, 2, 3, 4, 5, 6, 7, 8] (Total unique: 8)
2024-12-02 13:02:38,570 - INFO - marital_status: [1, 2, 3, 4, 5] (Total unique: 5)
2024-12-02 13:02:38,570 - INFO - student: [1, 2] (Total unique: 2)
2024-12-02 13:02:38,570 - INFO - country_of_birth: [1, 2] (Total unique: 2)
2024-12-02 13:02:38,571 - INFO - health: [1, 2, 3, 4, 5] (Total unique: 5)
2024-12-02 13:02:38,571 - INFO - ethnic_group: [1, 2, 3, 4, 5, 6] (Total unique: 6)
2024-12-02 13:02:38,571 - INFO - religion: [1, 2, 3, 4, 5, 6, 7, 8, 9] (Total unique: 9)
2024-12-02 13:02:38,571 - INFO - economic_activity: ['X', '7', '8', '6', '2', '4', '3', '1', '9', '5'] (Total unique: 10)
2024-12-02 13:02:38,571 - INFO - occupation: ['X', '7', '8', '6', '2', '4', '3', '5', '9', '1'] (Total unique: 10)
2024-12-02 13:02:38,571 - INFO - industry: ['9', 'X', '7', '6', '2', '4', '11', '3', '1', '10', '8', '13', '12', '5'] (Total unique: 14)
2024-12-02 13:02:38,571 - INFO - hours_worked_per_week: ['X', '2', '4', '3', '1'] (Total unique: 5)
2024-12-02 13:02:38,571 - INFO - approximate_social_grade: ['X', '2', '4', '3', '1'] (Total unique: 5)
2024-12-02 13:02:38,571 - INFO - 
All data ranges validated.
2024-12-02 13:02:38,571 - INFO - =====Verifying 'record_number' uniqueness:=====
2024-12-02 13:02:38,571 - INFO - Columns in batch: ['record_number', 'region', 'residence_type', 'family_composition', 'sex', 'age', 'marital_status', 'student', 'country_of_birth', 'health', 'ethnic_group', 'religion', 'economic_activity', 'occupation', 'industry', 'hours_worked_per_week', 'approximate_social_grade']
2024-12-02 13:02:38,572 - INFO - Record_Number is unique.
2024-12-02 13:02:38,581 - INFO - 'record_number' column reset.
2024-12-02 13:02:38,757 - INFO - Batch 1 cleaned and saved.
2024-12-02 13:02:38,760 - INFO - Progress saved to /cs/home/sz92/Documents/CS5002/P3/code/progress.json.
2024-12-02 13:02:38,761 - INFO - Data cleaning process completed. Total rows processed: 63388
2024-12-02 13:02:38,761 - INFO - Rows to drop: 5297
2024-12-02 13:02:38,761 - INFO - Cleaned data saved to ../data/output.csv
2024-12-02 13:02:38,761 - INFO - Progress file removed. Data processing complete.
2024-12-02 13:02:39,365 - INFO - Data clean code test passed. Congratulations! Result deatils in log/data_cleaning.log
2024-12-02 13:04:22,172 - WARNING - Progress file progress.json not found. Starting from the beginning.
2024-12-02 13:04:22,234 - INFO - Loaded data from row 0.
2024-12-02 13:04:22,234 - INFO - Columns in DataFrame: ['record_number', 'region', 'residence_type', 'family_composition', 'sex', 'age', 'marital_status', 'student', 'country_of_birth', 'health', 'ethnic_group', 'religion', 'economic_activity', 'occupation', 'industry', 'hours_worked_per_week', 'approximate_social_grade']
2024-12-02 13:04:42,840 - WARNING - Progress file progress.json not found. Starting from the beginning.
2024-12-02 13:04:42,906 - INFO - Loaded data from row 0.
2024-12-02 13:04:42,906 - INFO - Columns in DataFrame: ['record_number', 'region', 'residence_type', 'family_composition', 'sex', 'age', 'marital_status', 'student', 'country_of_birth', 'health', 'ethnic_group', 'religion', 'economic_activity', 'occupation', 'industry', 'hours_worked_per_week', 'approximate_social_grade']
2024-12-02 13:04:42,920 - INFO - =====Checking data types:=====
2024-12-02 13:04:42,932 - INFO - Batch info:
None
2024-12-02 13:04:42,978 - INFO - =====Checking for missing value:=====
2024-12-02 13:04:42,982 - INFO - No missing values detected.
2024-12-02 13:04:42,986 - INFO - =====Checking for duplicate rows:=====
2024-12-02 13:04:42,992 - INFO - No duplicate rows detected.
2024-12-02 13:04:42,996 - INFO - =====Verifying 'record_number' uniqueness:=====
2024-12-02 13:04:42,996 - INFO - Columns in batch: ['record_number', 'region', 'residence_type', 'family_composition', 'sex', 'age', 'marital_status', 'student', 'country_of_birth', 'health', 'ethnic_group', 'religion', 'economic_activity', 'occupation', 'industry', 'hours_worked_per_week', 'approximate_social_grade']
2024-12-02 13:04:42,997 - INFO - Record_Number is unique.
2024-12-02 13:04:43,001 - INFO - =====validate_data_ranges:=====
2024-12-02 13:04:43,092 - INFO - 
Unique categories and counts per column:
2024-12-02 13:04:43,092 - INFO - residence_type: ['C', 'P'] (Total unique: 2)
2024-12-02 13:04:43,092 - INFO - family_composition: ['4', 'X', '5', '0', '2', '1', '3'] (Total unique: 7)
2024-12-02 13:04:43,092 - INFO - sex: [1, 2] (Total unique: 2)
2024-12-02 13:04:43,092 - INFO - age: [1, 2, 3, 4, 5, 6, 7, 8] (Total unique: 8)
2024-12-02 13:04:43,092 - INFO - marital_status: [1, 2, 3, 4, 5] (Total unique: 5)
2024-12-02 13:04:43,093 - INFO - student: [1, 2] (Total unique: 2)
2024-12-02 13:04:43,093 - INFO - country_of_birth: [1, 2] (Total unique: 2)
2024-12-02 13:04:43,093 - INFO - health: [1, 2, 3, 4, 5] (Total unique: 5)
2024-12-02 13:04:43,093 - INFO - ethnic_group: [1, 2, 3, 4, 5, 6] (Total unique: 6)
2024-12-02 13:04:43,093 - INFO - religion: [1, 2, 3, 4, 5, 6, 7, 8, 9] (Total unique: 9)
2024-12-02 13:04:43,093 - INFO - economic_activity: ['6', '4', 'X', '5', '8', '9', '1', '2', '7', '3'] (Total unique: 10)
2024-12-02 13:04:43,093 - INFO - occupation: ['6', '4', 'X', '5', '8', '9', '2', '1', '7', '3'] (Total unique: 10)
2024-12-02 13:04:43,093 - INFO - industry: ['6', '4', 'X', '5', '8', '12', '9', '10', '2', '13', '1', '7', '11', '3'] (Total unique: 14)
2024-12-02 13:04:43,093 - INFO - hours_worked_per_week: ['4', 'X', '1', '2', '3'] (Total unique: 5)
2024-12-02 13:04:43,093 - INFO - approximate_social_grade: ['4', 'X', '2', '1', '3'] (Total unique: 5)
2024-12-02 13:04:43,093 - INFO - 
All data ranges validated.
2024-12-02 13:04:43,102 - INFO -       record_number     region residence_type family_composition  sex  age  \
20               21  S92000003              P                  5    2    2   
47               48  S92000003              P                  0    1    2   
48               49  S92000003              P                  0    1    3   
85               86  S92000003              P                  1    1    2   
88               89  S92000003              P                  1    1    3   
...             ...        ...            ...                ...  ...  ...   
8818           8819  S92000003              P                  1    2    2   
8875           8876  S92000003              P                  1    2    2   
8886           8887  S92000003              P                  4    2    2   
8906           8907  S92000003              P                  4    1    2   
8930           8931  S92000003              P                  1    1    2   

      marital_status  student  country_of_birth  health  ethnic_group  \
20                 1        1                 2       2             1   
47                 1        1                 2       1             1   
48                 2        1                 2       1             4   
85                 1        1                 2       1             1   
88                 2        1                 1       2             1   
...              ...      ...               ...     ...           ...   
8818               1        1                 1       1             1   
8875               1        1                 2       1             1   
8886               1        1                 1       1             1   
8906               1        1                 1       1             1   
8930               1        1                 1       1             1   

      religion economic_activity occupation industry hours_worked_per_week  \
20           2                 6          X        X                     X   
47           1                 6          X        X                     X   
48           2                 6          2        8                     X   
85           2                 6          X        X                     X   
88           2                 6          2       10                     X   
...        ...               ...        ...      ...                   ...   
8818         2                 6          X        X                     X   
8875         1                 6          X        X                     X   
8886         1                 6          X        X                     X   
8906         2                 6          X        X                     X   
8930         1                 6          7        4                     X   

     approximate_social_grade  
20                          2  
47                          2  
48                          2  
85                          1  
88                          2  
...                       ...  
8818                        4  
8875                        2  
8886                        1  
8906                        4  
8930                        2  

[372 rows x 17 columns]
2024-12-02 13:04:43,150 - INFO - Rule 1: Found 372 rows to delete, saved to data/rule_1_deleted_data.csv
2024-12-02 13:04:43,155 - INFO - Rule 2: No rows to delete
2024-12-02 13:04:43,165 - INFO - Rule 3: Found 123 rows to delete, saved to data/rule_3_deleted_data.csv
2024-12-02 13:04:43,347 - INFO - Rule 4: Found 327 rows to delete, saved to data/rule_4_deleted_data.csv
2024-12-02 13:04:43,352 - INFO - Rule 5: No rows to delete
2024-12-02 13:04:43,428 - INFO - Rule 6: Found 123 rows to delete, saved to data/rule_6_deleted_data.csv
2024-12-02 13:04:43,457 - INFO - Starting data cleaning process...
2024-12-02 13:04:43,522 - INFO - Processing batch 1...
2024-12-02 13:04:43,522 - INFO - =====Checking for missing value:=====
2024-12-02 13:04:43,539 - INFO - No missing values detected.
2024-12-02 13:04:43,539 - INFO - =====Checking for duplicate rows:=====
2024-12-02 13:04:43,565 - INFO - No duplicate rows detected.
2024-12-02 13:04:43,573 - INFO -        record_number     region residence_type family_composition  sex  age  \
20                21  S92000003              P                  5    2    2   
47                48  S92000003              P                  0    1    2   
48                49  S92000003              P                  0    1    3   
85                86  S92000003              P                  1    1    2   
88                89  S92000003              P                  1    1    3   
...              ...        ...            ...                ...  ...  ...   
63295          63296  S92000003              P                  1    1    2   
63317          63318  S92000003              P                  0    2    2   
63350          63351  S92000003              P                  1    1    2   
63366          63367  S92000003              P                  4    2    2   
63383          63384  S92000003              P                  1    1    2   

       marital_status  student  country_of_birth  health  ethnic_group  \
20                  1        1                 2       2             1   
47                  1        1                 2       1             1   
48                  2        1                 2       1             4   
85                  1        1                 2       1             1   
88                  2        1                 1       2             1   
...               ...      ...               ...     ...           ...   
63295               1        1                 1       1             1   
63317               1        1                 2       2             3   
63350               1        1                 1       1             1   
63366               1        1                 1       1             1   
63383               1        1                 1       1             1   

       religion economic_activity occupation industry hours_worked_per_week  \
20            2                 6          X        X                     X   
47            1                 6          X        X                     X   
48            2                 6          2        8                     X   
85            2                 6          X        X                     X   
88            2                 6          2       10                     X   
...         ...               ...        ...      ...                   ...   
63295         2                 6          7        4                     X   
63317         1                 6          X        X                     X   
63350         1                 6          X        X                     X   
63366         1                 6          X        X                     X   
63383         2                 6          X        X                     X   

      approximate_social_grade  
20                           2  
47                           2  
48                           2  
85                           1  
88                           2  
...                        ...  
63295                        2  
63317                        2  
63350                        4  
63366                        2  
63383                        3  

[2598 rows x 17 columns]
2024-12-02 13:04:43,583 - INFO - Rule 1: Found 2598 rows to delete, saved to data/rule_1_deleted_data.csv
2024-12-02 13:04:43,590 - INFO - Rule 2: No rows to delete
2024-12-02 13:04:43,603 - INFO - Rule 3: Found 843 rows to delete, saved to data/rule_3_deleted_data.csv
2024-12-02 13:04:43,619 - INFO - Rule 4: Found 2362 rows to delete, saved to data/rule_4_deleted_data.csv
2024-12-02 13:04:43,626 - INFO - Rule 5: No rows to delete
2024-12-02 13:04:43,639 - INFO - Rule 6: Found 843 rows to delete, saved to data/rule_6_deleted_data.csv
2024-12-02 13:04:43,644 - INFO - =====validate_data_ranges:=====
2024-12-02 13:04:44,082 - INFO - 
Unique categories and counts per column:
2024-12-02 13:04:44,082 - INFO - residence_type: ['C', 'P'] (Total unique: 2)
2024-12-02 13:04:44,082 - INFO - family_composition: ['4', 'X', '5', '0', '2', '1', '3'] (Total unique: 7)
2024-12-02 13:04:44,082 - INFO - sex: [1, 2] (Total unique: 2)
2024-12-02 13:04:44,082 - INFO - age: [1, 2, 3, 4, 5, 6, 7, 8] (Total unique: 8)
2024-12-02 13:04:44,082 - INFO - marital_status: [1, 2, 3, 4, 5] (Total unique: 5)
2024-12-02 13:04:44,082 - INFO - student: [1, 2] (Total unique: 2)
2024-12-02 13:04:44,082 - INFO - country_of_birth: [1, 2] (Total unique: 2)
2024-12-02 13:04:44,082 - INFO - health: [1, 2, 3, 4, 5] (Total unique: 5)
2024-12-02 13:04:44,082 - INFO - ethnic_group: [1, 2, 3, 4, 5, 6] (Total unique: 6)
2024-12-02 13:04:44,082 - INFO - religion: [1, 2, 3, 4, 5, 6, 7, 8, 9] (Total unique: 9)
2024-12-02 13:04:44,082 - INFO - economic_activity: ['6', '4', 'X', '5', '8', '9', '1', '2', '7', '3'] (Total unique: 10)
2024-12-02 13:04:44,082 - INFO - occupation: ['6', '4', 'X', '5', '8', '9', '2', '1', '7', '3'] (Total unique: 10)
2024-12-02 13:04:44,082 - INFO - industry: ['6', '4', 'X', '5', '8', '12', '9', '10', '2', '13', '1', '7', '11', '3'] (Total unique: 14)
2024-12-02 13:04:44,082 - INFO - hours_worked_per_week: ['4', 'X', '1', '2', '3'] (Total unique: 5)
2024-12-02 13:04:44,082 - INFO - approximate_social_grade: ['4', 'X', '2', '1', '3'] (Total unique: 5)
2024-12-02 13:04:44,082 - INFO - 
All data ranges validated.
2024-12-02 13:04:44,082 - INFO - =====Verifying 'record_number' uniqueness:=====
2024-12-02 13:04:44,082 - INFO - Columns in batch: ['record_number', 'region', 'residence_type', 'family_composition', 'sex', 'age', 'marital_status', 'student', 'country_of_birth', 'health', 'ethnic_group', 'religion', 'economic_activity', 'occupation', 'industry', 'hours_worked_per_week', 'approximate_social_grade']
2024-12-02 13:04:44,084 - INFO - Record_Number is unique.
2024-12-02 13:04:44,092 - INFO - 'record_number' column reset.
2024-12-02 13:04:44,276 - INFO - Batch 1 cleaned and saved.
2024-12-02 13:04:44,280 - INFO - Progress saved to /cs/home/sz92/Documents/CS5002/P3/code/progress.json.
2024-12-02 13:04:44,280 - INFO - Data cleaning process completed. Total rows processed: 63388
2024-12-02 13:04:44,280 - INFO - Rows to drop: 5297
2024-12-02 13:04:44,281 - INFO - Cleaned data saved to ../data/output.csv
2024-12-02 13:04:44,281 - INFO - Progress file removed. Data processing complete.
2024-12-02 13:04:44,841 - INFO - Data clean code test passed. Congratulations! Result deatils in log/data_cleaning.log
2024-12-02 18:43:38,273 - WARNING - Progress file progress.json not found. Starting from the beginning.
2024-12-02 18:43:38,352 - INFO - Loaded data from row 0.
2024-12-02 18:43:38,353 - INFO - Columns in DataFrame: ['record_number', 'region', 'residence_type', 'family_composition', 'sex', 'age', 'marital_status', 'student', 'country_of_birth', 'health', 'ethnic_group', 'religion', 'economic_activity', 'occupation', 'industry', 'hours_worked_per_week', 'approximate_social_grade']
2024-12-02 18:43:38,353 - WARNING - Progress file progress.json not found. Starting from the beginning.
2024-12-02 18:43:38,362 - INFO - =====Checking data types:=====
2024-12-02 18:43:38,368 - INFO - Batch info:
None
2024-12-02 18:43:38,410 - INFO - =====Checking for missing value:=====
2024-12-02 18:43:38,414 - INFO - No missing values detected.
2024-12-02 18:43:38,414 - INFO - =====Checking for duplicate rows:=====
2024-12-02 18:43:38,418 - INFO - No duplicate rows detected.
2024-12-02 18:43:38,418 - INFO - =====Verifying 'record_number' uniqueness:=====
2024-12-02 18:43:38,419 - INFO - Columns in batch: ['record_number', 'region', 'residence_type', 'family_composition', 'sex', 'age', 'marital_status', 'student', 'country_of_birth', 'health', 'ethnic_group', 'religion', 'economic_activity', 'occupation', 'industry', 'hours_worked_per_week', 'approximate_social_grade']
2024-12-02 18:43:38,419 - INFO - Record_Number is unique.
2024-12-02 18:43:38,419 - INFO - =====validate_data_ranges:=====
2024-12-02 18:43:38,515 - INFO - 
Unique categories and counts per column:
2024-12-02 18:43:38,515 - INFO - residence_type: ['C', 'P'] (Total unique: 2)
2024-12-02 18:43:38,515 - INFO - family_composition: ['X', '1', '3', '5', '4', '2', '0'] (Total unique: 7)
2024-12-02 18:43:38,515 - INFO - sex: [1, 2] (Total unique: 2)
2024-12-02 18:43:38,516 - INFO - age: [1, 2, 3, 4, 5, 6, 7, 8] (Total unique: 8)
2024-12-02 18:43:38,516 - INFO - marital_status: [1, 2, 3, 4, 5] (Total unique: 5)
2024-12-02 18:43:38,516 - INFO - student: [1, 2] (Total unique: 2)
2024-12-02 18:43:38,516 - INFO - country_of_birth: [1, 2] (Total unique: 2)
2024-12-02 18:43:38,516 - INFO - health: [1, 2, 3, 4, 5] (Total unique: 5)
2024-12-02 18:43:38,516 - INFO - ethnic_group: [1, 2, 3, 4, 5, 6] (Total unique: 6)
2024-12-02 18:43:38,516 - INFO - religion: [1, 2, 3, 4, 5, 6, 7, 8, 9] (Total unique: 9)
2024-12-02 18:43:38,516 - INFO - economic_activity: ['8', '6', '7', 'X', '1', '3', '9', '5', '4', '2'] (Total unique: 10)
2024-12-02 18:43:38,516 - INFO - occupation: ['8', '6', '7', 'X', '1', '5', '9', '3', '4', '2'] (Total unique: 10)
2024-12-02 18:43:38,516 - INFO - industry: ['13', '11', '10', '8', '6', '7', 'X', '3', '12', '1', '9', '5', '4', '2'] (Total unique: 14)
2024-12-02 18:43:38,516 - INFO - hours_worked_per_week: ['X', '1', '3', '4', '2'] (Total unique: 5)
2024-12-02 18:43:38,516 - INFO - approximate_social_grade: ['X', '1', '3', '4', '2'] (Total unique: 5)
2024-12-02 18:43:38,516 - INFO - 
All data ranges validated.
2024-12-02 18:43:38,516 - INFO - Starting data cleaning process...
2024-12-02 18:43:38,527 - INFO - Processing batch 1...
2024-12-02 18:43:38,527 - INFO - =====Checking for missing value:=====
2024-12-02 18:43:38,530 - INFO - No missing values detected.
2024-12-02 18:43:38,530 - INFO - =====Checking for duplicate rows:=====
2024-12-02 18:43:38,534 - INFO - No duplicate rows detected.
2024-12-02 18:43:38,547 - INFO -       record_number     region  ... hours_worked_per_week approximate_social_grade
20               21  S92000003  ...                     X                        2
47               48  S92000003  ...                     X                        2
48               49  S92000003  ...                     X                        2
85               86  S92000003  ...                     X                        1
88               89  S92000003  ...                     X                        2
...             ...        ...  ...                   ...                      ...
8818           8819  S92000003  ...                     X                        4
8875           8876  S92000003  ...                     X                        2
8886           8887  S92000003  ...                     X                        1
8906           8907  S92000003  ...                     X                        4
8930           8931  S92000003  ...                     X                        2

[372 rows x 17 columns]
2024-12-02 18:43:38,551 - INFO - Rule 1: Found 372 rows to delete, saved to data/rule_1_deleted_data.csv
2024-12-02 18:43:38,553 - INFO - Rule 2: No rows to delete
2024-12-02 18:43:38,557 - INFO - Rule 3: Found 123 rows to delete, saved to data/rule_3_deleted_data.csv
2024-12-02 18:43:38,562 - INFO - Rule 4: Found 327 rows to delete, saved to data/rule_4_deleted_data.csv
2024-12-02 18:43:38,564 - INFO - Rule 5: No rows to delete
2024-12-02 18:43:38,568 - INFO - Rule 6: Found 123 rows to delete, saved to data/rule_6_deleted_data.csv
2024-12-02 18:43:38,573 - INFO - =====validate_data_ranges:=====
2024-12-02 18:43:38,657 - INFO - 
Unique categories and counts per column:
2024-12-02 18:43:38,657 - INFO - residence_type: ['C', 'P'] (Total unique: 2)
2024-12-02 18:43:38,657 - INFO - family_composition: ['X', '1', '3', '5', '4', '2', '0'] (Total unique: 7)
2024-12-02 18:43:38,657 - INFO - sex: [1, 2] (Total unique: 2)
2024-12-02 18:43:38,657 - INFO - age: [1, 2, 3, 4, 5, 6, 7, 8] (Total unique: 8)
2024-12-02 18:43:38,657 - INFO - marital_status: [1, 2, 3, 4, 5] (Total unique: 5)
2024-12-02 18:43:38,657 - INFO - student: [1, 2] (Total unique: 2)
2024-12-02 18:43:38,657 - INFO - country_of_birth: [1, 2] (Total unique: 2)
2024-12-02 18:43:38,657 - INFO - health: [1, 2, 3, 4, 5] (Total unique: 5)
2024-12-02 18:43:38,657 - INFO - ethnic_group: [1, 2, 3, 4, 5, 6] (Total unique: 6)
2024-12-02 18:43:38,657 - INFO - religion: [1, 2, 3, 4, 5, 6, 7, 8, 9] (Total unique: 9)
2024-12-02 18:43:38,657 - INFO - economic_activity: ['8', '6', '7', 'X', '1', '3', '9', '5', '4', '2'] (Total unique: 10)
2024-12-02 18:43:38,657 - INFO - occupation: ['8', '6', '7', 'X', '1', '5', '9', '3', '4', '2'] (Total unique: 10)
2024-12-02 18:43:38,657 - INFO - industry: ['13', '11', '10', '8', '6', '7', 'X', '3', '12', '1', '9', '5', '4', '2'] (Total unique: 14)
2024-12-02 18:43:38,657 - INFO - hours_worked_per_week: ['X', '1', '3', '4', '2'] (Total unique: 5)
2024-12-02 18:43:38,657 - INFO - approximate_social_grade: ['X', '1', '3', '4', '2'] (Total unique: 5)
2024-12-02 18:43:38,657 - INFO - 
All data ranges validated.
2024-12-02 18:43:38,657 - INFO - =====Verifying 'record_number' uniqueness:=====
2024-12-02 18:43:38,657 - INFO - Columns in batch: ['record_number', 'region', 'residence_type', 'family_composition', 'sex', 'age', 'marital_status', 'student', 'country_of_birth', 'health', 'ethnic_group', 'religion', 'economic_activity', 'occupation', 'industry', 'hours_worked_per_week', 'approximate_social_grade']
2024-12-02 18:43:38,658 - INFO - Record_Number is unique.
2024-12-02 18:43:38,659 - INFO - 'record_number' column reset.
2024-12-02 18:43:38,687 - INFO - Batch 1 cleaned and saved.
2024-12-02 18:43:38,768 - INFO - Progress saved to /cs/home/sz92/Documents/CS5002/P3/code/progress.json.
2024-12-02 18:43:38,794 - INFO - Processing batch 2...
2024-12-02 18:43:38,794 - INFO - =====Checking for missing value:=====
2024-12-02 18:43:38,799 - INFO - No missing values detected.
2024-12-02 18:43:38,799 - INFO - =====Checking for duplicate rows:=====
2024-12-02 18:43:38,808 - INFO - No duplicate rows detected.
2024-12-02 18:43:38,823 - INFO -        record_number     region  ... hours_worked_per_week approximate_social_grade
9004            9005  S92000003  ...                     X                        2
9007            9008  S92000003  ...                     X                        2
9010            9011  S92000003  ...                     X                        2
9014            9015  S92000003  ...                     X                        2
9026            9027  S92000003  ...                     X                        2
...              ...        ...  ...                   ...                      ...
17904          17905  S92000003  ...                     X                        2
17952          17953  S92000003  ...                     X                        2
17968          17969  S92000003  ...                     X                        1
17976          17977  S92000003  ...                     X                        2
17981          17982  S92000003  ...                     X                        3

[340 rows x 17 columns]
2024-12-02 18:43:38,829 - INFO - Rule 1: Found 340 rows to delete, saved to data/rule_1_deleted_data.csv
2024-12-02 18:43:38,831 - INFO - Rule 2: No rows to delete
2024-12-02 18:43:38,850 - INFO - Rule 3: Found 115 rows to delete, saved to data/rule_3_deleted_data.csv
2024-12-02 18:43:38,865 - INFO - Rule 4: Found 344 rows to delete, saved to data/rule_4_deleted_data.csv
2024-12-02 18:43:38,868 - INFO - Rule 5: No rows to delete
2024-12-02 18:43:38,877 - INFO - Rule 6: Found 115 rows to delete, saved to data/rule_6_deleted_data.csv
2024-12-02 18:43:38,881 - INFO - =====validate_data_ranges:=====
2024-12-02 18:43:38,959 - INFO - 
Unique categories and counts per column:
2024-12-02 18:43:38,959 - INFO - residence_type: ['C', 'P'] (Total unique: 2)
2024-12-02 18:43:38,959 - INFO - family_composition: ['X', '1', '5', '3', '4', '2', '0'] (Total unique: 7)
2024-12-02 18:43:38,959 - INFO - sex: [1, 2] (Total unique: 2)
2024-12-02 18:43:38,959 - INFO - age: [1, 2, 3, 4, 5, 6, 7, 8] (Total unique: 8)
2024-12-02 18:43:38,959 - INFO - marital_status: [1, 2, 3, 4, 5] (Total unique: 5)
2024-12-02 18:43:38,959 - INFO - student: [1, 2] (Total unique: 2)
2024-12-02 18:43:38,959 - INFO - country_of_birth: [1, 2] (Total unique: 2)
2024-12-02 18:43:38,959 - INFO - health: [1, 2, 3, 4, 5] (Total unique: 5)
2024-12-02 18:43:38,959 - INFO - ethnic_group: [1, 2, 3, 4, 5, 6] (Total unique: 6)
2024-12-02 18:43:38,959 - INFO - religion: [1, 2, 3, 4, 5, 6, 7, 8, 9] (Total unique: 9)
2024-12-02 18:43:38,959 - INFO - economic_activity: ['8', '6', '7', 'X', '1', '5', '9', '3', '4', '2'] (Total unique: 10)
2024-12-02 18:43:38,959 - INFO - occupation: ['8', '6', '7', 'X', '3', '1', '9', '5', '4', '2'] (Total unique: 10)
2024-12-02 18:43:38,959 - INFO - industry: ['13', '11', '10', '8', '6', '7', 'X', '12', '3', '1', '9', '5', '4', '2'] (Total unique: 14)
2024-12-02 18:43:38,959 - INFO - hours_worked_per_week: ['X', '1', '3', '4', '2'] (Total unique: 5)
2024-12-02 18:43:38,959 - INFO - approximate_social_grade: ['X', '1', '3', '4', '2'] (Total unique: 5)
2024-12-02 18:43:38,959 - INFO - 
All data ranges validated.
2024-12-02 18:43:38,960 - INFO - =====Verifying 'record_number' uniqueness:=====
2024-12-02 18:43:38,960 - INFO - Columns in batch: ['record_number', 'region', 'residence_type', 'family_composition', 'sex', 'age', 'marital_status', 'student', 'country_of_birth', 'health', 'ethnic_group', 'religion', 'economic_activity', 'occupation', 'industry', 'hours_worked_per_week', 'approximate_social_grade']
2024-12-02 18:43:38,960 - INFO - Record_Number is unique.
2024-12-02 18:43:38,962 - INFO - 'record_number' column reset.
2024-12-02 18:43:38,991 - INFO - Batch 2 cleaned and saved.
2024-12-02 18:43:38,994 - INFO - Progress saved to /cs/home/sz92/Documents/CS5002/P3/code/progress.json.
2024-12-02 18:43:39,005 - INFO - Processing batch 3...
2024-12-02 18:43:39,005 - INFO - =====Checking for missing value:=====
2024-12-02 18:43:39,008 - INFO - No missing values detected.
2024-12-02 18:43:39,008 - INFO - =====Checking for duplicate rows:=====
2024-12-02 18:43:39,013 - INFO - No duplicate rows detected.
2024-12-02 18:43:39,026 - INFO -        record_number     region  ... hours_worked_per_week approximate_social_grade
18012          18013  S92000003  ...                     X                        3
18032          18033  S92000003  ...                     X                        3
18058          18059  S92000003  ...                     X                        4
18131          18132  S92000003  ...                     X                        1
18142          18143  S92000003  ...                     X                        2
...              ...        ...  ...                   ...                      ...
26889          26890  S92000003  ...                     X                        2
26905          26906  S92000003  ...                     X                        2
26919          26920  S92000003  ...                     X                        3
26928          26929  S92000003  ...                     X                        3
26982          26983  S92000003  ...                     X                        2

[371 rows x 17 columns]
2024-12-02 18:43:39,031 - INFO - Rule 1: Found 371 rows to delete, saved to data/rule_1_deleted_data.csv
2024-12-02 18:43:39,032 - INFO - Rule 2: No rows to delete
2024-12-02 18:43:39,038 - INFO - Rule 3: Found 124 rows to delete, saved to data/rule_3_deleted_data.csv
2024-12-02 18:43:39,049 - INFO - Rule 4: Found 359 rows to delete, saved to data/rule_4_deleted_data.csv
2024-12-02 18:43:39,052 - INFO - Rule 5: No rows to delete
2024-12-02 18:43:39,060 - INFO - Rule 6: Found 124 rows to delete, saved to data/rule_6_deleted_data.csv
2024-12-02 18:43:39,065 - INFO - =====validate_data_ranges:=====
2024-12-02 18:43:39,147 - INFO - 
Unique categories and counts per column:
2024-12-02 18:43:39,147 - INFO - residence_type: ['C', 'P'] (Total unique: 2)
2024-12-02 18:43:39,147 - INFO - family_composition: ['X', '1', '5', '3', '4', '2', '0'] (Total unique: 7)
2024-12-02 18:43:39,147 - INFO - sex: [1, 2] (Total unique: 2)
2024-12-02 18:43:39,147 - INFO - age: [1, 2, 3, 4, 5, 6, 7, 8] (Total unique: 8)
2024-12-02 18:43:39,147 - INFO - marital_status: [1, 2, 3, 4, 5] (Total unique: 5)
2024-12-02 18:43:39,148 - INFO - student: [1, 2] (Total unique: 2)
2024-12-02 18:43:39,148 - INFO - country_of_birth: [1, 2] (Total unique: 2)
2024-12-02 18:43:39,148 - INFO - health: [1, 2, 3, 4, 5] (Total unique: 5)
2024-12-02 18:43:39,148 - INFO - ethnic_group: [1, 2, 3, 4, 5, 6] (Total unique: 6)
2024-12-02 18:43:39,148 - INFO - religion: [1, 2, 3, 4, 5, 6, 7, 8, 9] (Total unique: 9)
2024-12-02 18:43:39,148 - INFO - economic_activity: ['8', '6', '7', 'X', '1', '3', '9', '5', '4', '2'] (Total unique: 10)
2024-12-02 18:43:39,148 - INFO - occupation: ['8', '6', '7', 'X', '1', '3', '9', '5', '4', '2'] (Total unique: 10)
2024-12-02 18:43:39,148 - INFO - industry: ['13', '11', '10', '8', '6', '7', 'X', '12', '5', '1', '9', '3', '4', '2'] (Total unique: 14)
2024-12-02 18:43:39,148 - INFO - hours_worked_per_week: ['X', '1', '3', '4', '2'] (Total unique: 5)
2024-12-02 18:43:39,148 - INFO - approximate_social_grade: ['X', '1', '3', '4', '2'] (Total unique: 5)
2024-12-02 18:43:39,148 - INFO - 
All data ranges validated.
2024-12-02 18:43:39,148 - INFO - =====Verifying 'record_number' uniqueness:=====
2024-12-02 18:43:39,148 - INFO - Columns in batch: ['record_number', 'region', 'residence_type', 'family_composition', 'sex', 'age', 'marital_status', 'student', 'country_of_birth', 'health', 'ethnic_group', 'religion', 'economic_activity', 'occupation', 'industry', 'hours_worked_per_week', 'approximate_social_grade']
2024-12-02 18:43:39,148 - INFO - Record_Number is unique.
2024-12-02 18:43:39,150 - INFO - 'record_number' column reset.
2024-12-02 18:43:39,177 - INFO - Batch 3 cleaned and saved.
2024-12-02 18:43:39,181 - INFO - Progress saved to /cs/home/sz92/Documents/CS5002/P3/code/progress.json.
2024-12-02 18:43:39,190 - INFO - Processing batch 4...
2024-12-02 18:43:39,190 - INFO - =====Checking for missing value:=====
2024-12-02 18:43:39,194 - INFO - No missing values detected.
2024-12-02 18:43:39,194 - INFO - =====Checking for duplicate rows:=====
2024-12-02 18:43:39,198 - INFO - No duplicate rows detected.
2024-12-02 18:43:39,211 - INFO -        record_number     region  ... hours_worked_per_week approximate_social_grade
27017          27018  S92000003  ...                     X                        1
27085          27086  S92000003  ...                     X                        4
27104          27105  S92000003  ...                     X                        2
27187          27188  S92000003  ...                     X                        2
27206          27207  S92000003  ...                     X                        1
...              ...        ...  ...                   ...                      ...
35871          35872  S92000003  ...                     X                        2
35927          35928  S92000003  ...                     X                        2
35944          35945  S92000003  ...                     X                        1
35947          35948  S92000003  ...                     X                        1
35989          35990  S92000003  ...                     X                        2

[327 rows x 17 columns]
2024-12-02 18:43:39,216 - INFO - Rule 1: Found 327 rows to delete, saved to data/rule_1_deleted_data.csv
2024-12-02 18:43:39,218 - INFO - Rule 2: No rows to delete
2024-12-02 18:43:39,222 - INFO - Rule 3: Found 118 rows to delete, saved to data/rule_3_deleted_data.csv
2024-12-02 18:43:39,229 - INFO - Rule 4: Found 317 rows to delete, saved to data/rule_4_deleted_data.csv
2024-12-02 18:43:39,234 - INFO - Rule 5: No rows to delete
2024-12-02 18:43:39,243 - INFO - Rule 6: Found 118 rows to delete, saved to data/rule_6_deleted_data.csv
2024-12-02 18:43:39,247 - INFO - =====validate_data_ranges:=====
2024-12-02 18:43:39,325 - INFO - 
Unique categories and counts per column:
2024-12-02 18:43:39,325 - INFO - residence_type: ['C', 'P'] (Total unique: 2)
2024-12-02 18:43:39,325 - INFO - family_composition: ['X', '1', '5', '3', '4', '2', '0'] (Total unique: 7)
2024-12-02 18:43:39,325 - INFO - sex: [1, 2] (Total unique: 2)
2024-12-02 18:43:39,325 - INFO - age: [1, 2, 3, 4, 5, 6, 7, 8] (Total unique: 8)
2024-12-02 18:43:39,325 - INFO - marital_status: [1, 2, 3, 4, 5] (Total unique: 5)
2024-12-02 18:43:39,325 - INFO - student: [1, 2] (Total unique: 2)
2024-12-02 18:43:39,325 - INFO - country_of_birth: [1, 2] (Total unique: 2)
2024-12-02 18:43:39,325 - INFO - health: [1, 2, 3, 4, 5] (Total unique: 5)
2024-12-02 18:43:39,325 - INFO - ethnic_group: [1, 2, 3, 4, 5, 6] (Total unique: 6)
2024-12-02 18:43:39,325 - INFO - religion: [1, 2, 3, 4, 5, 6, 7, 8, 9] (Total unique: 9)
2024-12-02 18:43:39,325 - INFO - economic_activity: ['8', '6', '7', 'X', '1', '3', '9', '5', '4', '2'] (Total unique: 10)
2024-12-02 18:43:39,325 - INFO - occupation: ['8', '6', '7', 'X', '1', '5', '9', '3', '4', '2'] (Total unique: 10)
2024-12-02 18:43:39,325 - INFO - industry: ['13', '11', '10', '8', '6', '7', 'X', '3', '12', '1', '9', '5', '4', '2'] (Total unique: 14)
2024-12-02 18:43:39,325 - INFO - hours_worked_per_week: ['X', '1', '3', '4', '2'] (Total unique: 5)
2024-12-02 18:43:39,325 - INFO - approximate_social_grade: ['X', '1', '3', '4', '2'] (Total unique: 5)
2024-12-02 18:43:39,325 - INFO - 
All data ranges validated.
2024-12-02 18:43:39,325 - INFO - =====Verifying 'record_number' uniqueness:=====
2024-12-02 18:43:39,325 - INFO - Columns in batch: ['record_number', 'region', 'residence_type', 'family_composition', 'sex', 'age', 'marital_status', 'student', 'country_of_birth', 'health', 'ethnic_group', 'religion', 'economic_activity', 'occupation', 'industry', 'hours_worked_per_week', 'approximate_social_grade']
2024-12-02 18:43:39,326 - INFO - Record_Number is unique.
2024-12-02 18:43:39,327 - INFO - 'record_number' column reset.
2024-12-02 18:43:39,354 - INFO - Batch 4 cleaned and saved.
2024-12-02 18:43:39,358 - INFO - Progress saved to /cs/home/sz92/Documents/CS5002/P3/code/progress.json.
2024-12-02 18:43:39,368 - INFO - Processing batch 5...
2024-12-02 18:43:39,368 - INFO - =====Checking for missing value:=====
2024-12-02 18:43:39,372 - INFO - No missing values detected.
2024-12-02 18:43:39,372 - INFO - =====Checking for duplicate rows:=====
2024-12-02 18:43:39,376 - INFO - No duplicate rows detected.
2024-12-02 18:43:39,388 - INFO -        record_number     region  ... hours_worked_per_week approximate_social_grade
36006          36007  S92000003  ...                     X                        2
36017          36018  S92000003  ...                     X                        4
36074          36075  S92000003  ...                     X                        2
36124          36125  S92000003  ...                     X                        2
36127          36128  S92000003  ...                     X                        2
...              ...        ...  ...                   ...                      ...
44863          44864  S92000003  ...                     X                        2
44870          44871  S92000003  ...                     X                        3
44937          44938  S92000003  ...                     X                        2
44986          44987  S92000003  ...                     X                        2
44996          44997  S92000003  ...                     X                        3

[377 rows x 17 columns]
2024-12-02 18:43:39,393 - INFO - Rule 1: Found 377 rows to delete, saved to data/rule_1_deleted_data.csv
2024-12-02 18:43:39,394 - INFO - Rule 2: No rows to delete
2024-12-02 18:43:39,400 - INFO - Rule 3: Found 124 rows to delete, saved to data/rule_3_deleted_data.csv
2024-12-02 18:43:39,413 - INFO - Rule 4: Found 354 rows to delete, saved to data/rule_4_deleted_data.csv
2024-12-02 18:43:39,416 - INFO - Rule 5: No rows to delete
2024-12-02 18:43:39,423 - INFO - Rule 6: Found 124 rows to delete, saved to data/rule_6_deleted_data.csv
2024-12-02 18:43:39,427 - INFO - =====validate_data_ranges:=====
2024-12-02 18:43:39,502 - INFO - 
Unique categories and counts per column:
2024-12-02 18:43:39,502 - INFO - residence_type: ['C', 'P'] (Total unique: 2)
2024-12-02 18:43:39,502 - INFO - family_composition: ['X', '1', '5', '3', '4', '2', '0'] (Total unique: 7)
2024-12-02 18:43:39,502 - INFO - sex: [1, 2] (Total unique: 2)
2024-12-02 18:43:39,503 - INFO - age: [1, 2, 3, 4, 5, 6, 7, 8] (Total unique: 8)
2024-12-02 18:43:39,503 - INFO - marital_status: [1, 2, 3, 4, 5] (Total unique: 5)
2024-12-02 18:43:39,503 - INFO - student: [1, 2] (Total unique: 2)
2024-12-02 18:43:39,503 - INFO - country_of_birth: [1, 2] (Total unique: 2)
2024-12-02 18:43:39,503 - INFO - health: [1, 2, 3, 4, 5] (Total unique: 5)
2024-12-02 18:43:39,503 - INFO - ethnic_group: [1, 2, 3, 4, 5, 6] (Total unique: 6)
2024-12-02 18:43:39,503 - INFO - religion: [1, 2, 3, 4, 5, 6, 7, 8, 9] (Total unique: 9)
2024-12-02 18:43:39,503 - INFO - economic_activity: ['8', '6', '7', 'X', '1', '5', '9', '3', '4', '2'] (Total unique: 10)
2024-12-02 18:43:39,503 - INFO - occupation: ['8', '6', '7', 'X', '1', '5', '9', '3', '4', '2'] (Total unique: 10)
2024-12-02 18:43:39,503 - INFO - industry: ['13', '11', '10', '8', '6', '7', 'X', '12', '5', '1', '9', '3', '4', '2'] (Total unique: 14)
2024-12-02 18:43:39,503 - INFO - hours_worked_per_week: ['X', '1', '3', '4', '2'] (Total unique: 5)
2024-12-02 18:43:39,503 - INFO - approximate_social_grade: ['X', '1', '3', '4', '2'] (Total unique: 5)
2024-12-02 18:43:39,503 - INFO - 
All data ranges validated.
2024-12-02 18:43:39,503 - INFO - =====Verifying 'record_number' uniqueness:=====
2024-12-02 18:43:39,503 - INFO - Columns in batch: ['record_number', 'region', 'residence_type', 'family_composition', 'sex', 'age', 'marital_status', 'student', 'country_of_birth', 'health', 'ethnic_group', 'religion', 'economic_activity', 'occupation', 'industry', 'hours_worked_per_week', 'approximate_social_grade']
2024-12-02 18:43:39,503 - INFO - Record_Number is unique.
2024-12-02 18:43:39,505 - INFO - 'record_number' column reset.
2024-12-02 18:43:39,532 - INFO - Batch 5 cleaned and saved.
2024-12-02 18:43:39,535 - INFO - Progress saved to /cs/home/sz92/Documents/CS5002/P3/code/progress.json.
2024-12-02 18:43:39,544 - INFO - Processing batch 6...
2024-12-02 18:43:39,544 - INFO - =====Checking for missing value:=====
2024-12-02 18:43:39,547 - INFO - No missing values detected.
2024-12-02 18:43:39,547 - INFO - =====Checking for duplicate rows:=====
2024-12-02 18:43:39,552 - INFO - No duplicate rows detected.
2024-12-02 18:43:39,565 - INFO -        record_number     region  ... hours_worked_per_week approximate_social_grade
45024          45025  S92000003  ...                     X                        2
45030          45031  S92000003  ...                     X                        4
45047          45048  S92000003  ...                     X                        3
45072          45073  S92000003  ...                     X                        3
45124          45125  S92000003  ...                     X                        1
...              ...        ...  ...                   ...                      ...
53900          53901  S92000003  ...                     X                        4
53923          53924  S92000003  ...                     X                        4
53960          53961  S92000003  ...                     X                        4
53979          53980  S92000003  ...                     X                        3
53983          53984  S92000003  ...                     X                        4

[408 rows x 17 columns]
2024-12-02 18:43:39,570 - INFO - Rule 1: Found 408 rows to delete, saved to data/rule_1_deleted_data.csv
2024-12-02 18:43:39,572 - INFO - Rule 2: No rows to delete
2024-12-02 18:43:39,576 - INFO - Rule 3: Found 113 rows to delete, saved to data/rule_3_deleted_data.csv
2024-12-02 18:43:39,582 - INFO - Rule 4: Found 335 rows to delete, saved to data/rule_4_deleted_data.csv
2024-12-02 18:43:39,585 - INFO - Rule 5: No rows to delete
2024-12-02 18:43:39,595 - INFO - Rule 6: Found 113 rows to delete, saved to data/rule_6_deleted_data.csv
2024-12-02 18:43:39,599 - INFO - =====validate_data_ranges:=====
2024-12-02 18:43:39,678 - INFO - 
Unique categories and counts per column:
2024-12-02 18:43:39,678 - INFO - residence_type: ['C', 'P'] (Total unique: 2)
2024-12-02 18:43:39,678 - INFO - family_composition: ['X', '1', '3', '5', '4', '2', '0'] (Total unique: 7)
2024-12-02 18:43:39,678 - INFO - sex: [1, 2] (Total unique: 2)
2024-12-02 18:43:39,678 - INFO - age: [1, 2, 3, 4, 5, 6, 7, 8] (Total unique: 8)
2024-12-02 18:43:39,678 - INFO - marital_status: [1, 2, 3, 4, 5] (Total unique: 5)
2024-12-02 18:43:39,678 - INFO - student: [1, 2] (Total unique: 2)
2024-12-02 18:43:39,678 - INFO - country_of_birth: [1, 2] (Total unique: 2)
2024-12-02 18:43:39,678 - INFO - health: [1, 2, 3, 4, 5] (Total unique: 5)
2024-12-02 18:43:39,678 - INFO - ethnic_group: [1, 2, 3, 4, 5, 6] (Total unique: 6)
2024-12-02 18:43:39,678 - INFO - religion: [1, 2, 3, 4, 5, 6, 7, 8, 9] (Total unique: 9)
2024-12-02 18:43:39,678 - INFO - economic_activity: ['8', '6', '7', 'X', '1', '3', '9', '5', '4', '2'] (Total unique: 10)
2024-12-02 18:43:39,678 - INFO - occupation: ['8', '6', '7', 'X', '1', '5', '9', '3', '4', '2'] (Total unique: 10)
2024-12-02 18:43:39,678 - INFO - industry: ['13', '11', '10', '8', '6', '7', 'X', '3', '1', '12', '9', '5', '4', '2'] (Total unique: 14)
2024-12-02 18:43:39,678 - INFO - hours_worked_per_week: ['X', '1', '3', '4', '2'] (Total unique: 5)
2024-12-02 18:43:39,678 - INFO - approximate_social_grade: ['X', '1', '3', '4', '2'] (Total unique: 5)
2024-12-02 18:43:39,678 - INFO - 
All data ranges validated.
2024-12-02 18:43:39,678 - INFO - =====Verifying 'record_number' uniqueness:=====
2024-12-02 18:43:39,678 - INFO - Columns in batch: ['record_number', 'region', 'residence_type', 'family_composition', 'sex', 'age', 'marital_status', 'student', 'country_of_birth', 'health', 'ethnic_group', 'religion', 'economic_activity', 'occupation', 'industry', 'hours_worked_per_week', 'approximate_social_grade']
2024-12-02 18:43:39,679 - INFO - Record_Number is unique.
2024-12-02 18:43:39,681 - INFO - 'record_number' column reset.
2024-12-02 18:43:39,708 - INFO - Batch 6 cleaned and saved.
2024-12-02 18:43:39,711 - INFO - Progress saved to /cs/home/sz92/Documents/CS5002/P3/code/progress.json.
2024-12-02 18:43:39,719 - INFO - Processing batch 7...
2024-12-02 18:43:39,719 - INFO - =====Checking for missing value:=====
2024-12-02 18:43:39,722 - INFO - No missing values detected.
2024-12-02 18:43:39,722 - INFO - =====Checking for duplicate rows:=====
2024-12-02 18:43:39,727 - INFO - No duplicate rows detected.
2024-12-02 18:43:39,739 - INFO -        record_number     region  ... hours_worked_per_week approximate_social_grade
54010          54011  S92000003  ...                     X                        4
54023          54024  S92000003  ...                     X                        4
54132          54133  S92000003  ...                     X                        2
54137          54138  S92000003  ...                     X                        4
54153          54154  S92000003  ...                     X                        1
...              ...        ...  ...                   ...                      ...
62748          62749  S92000003  ...                     X                        1
62763          62764  S92000003  ...                     X                        2
62909          62910  S92000003  ...                     X                        2
62936          62937  S92000003  ...                     X                        2
62944          62945  S92000003  ...                     X                        2

[382 rows x 17 columns]
2024-12-02 18:43:39,744 - INFO - Rule 1: Found 382 rows to delete, saved to data/rule_1_deleted_data.csv
2024-12-02 18:43:39,745 - INFO - Rule 2: No rows to delete
2024-12-02 18:43:39,750 - INFO - Rule 3: Found 118 rows to delete, saved to data/rule_3_deleted_data.csv
2024-12-02 18:43:39,757 - INFO - Rule 4: Found 310 rows to delete, saved to data/rule_4_deleted_data.csv
2024-12-02 18:43:39,759 - INFO - Rule 5: No rows to delete
2024-12-02 18:43:39,763 - INFO - Rule 6: Found 118 rows to delete, saved to data/rule_6_deleted_data.csv
2024-12-02 18:43:39,765 - INFO - =====validate_data_ranges:=====
2024-12-02 18:43:39,833 - INFO - 
Unique categories and counts per column:
2024-12-02 18:43:39,833 - INFO - residence_type: ['C', 'P'] (Total unique: 2)
2024-12-02 18:43:39,833 - INFO - family_composition: ['X', '1', '3', '5', '4', '2', '0'] (Total unique: 7)
2024-12-02 18:43:39,833 - INFO - sex: [1, 2] (Total unique: 2)
2024-12-02 18:43:39,833 - INFO - age: [1, 2, 3, 4, 5, 6, 7, 8] (Total unique: 8)
2024-12-02 18:43:39,833 - INFO - marital_status: [1, 2, 3, 4, 5] (Total unique: 5)
2024-12-02 18:43:39,833 - INFO - student: [1, 2] (Total unique: 2)
2024-12-02 18:43:39,833 - INFO - country_of_birth: [1, 2] (Total unique: 2)
2024-12-02 18:43:39,833 - INFO - health: [1, 2, 3, 4, 5] (Total unique: 5)
2024-12-02 18:43:39,833 - INFO - ethnic_group: [1, 2, 3, 4, 5, 6] (Total unique: 6)
2024-12-02 18:43:39,833 - INFO - religion: [1, 2, 3, 4, 5, 6, 7, 8, 9] (Total unique: 9)
2024-12-02 18:43:39,833 - INFO - economic_activity: ['8', '6', '7', 'X', '1', '3', '9', '5', '4', '2'] (Total unique: 10)
2024-12-02 18:43:39,833 - INFO - occupation: ['8', '6', '7', 'X', '1', '3', '9', '5', '4', '2'] (Total unique: 10)
2024-12-02 18:43:39,833 - INFO - industry: ['13', '11', '10', '8', '6', '7', 'X', '1', '5', '12', '9', '3', '4', '2'] (Total unique: 14)
2024-12-02 18:43:39,833 - INFO - hours_worked_per_week: ['X', '1', '3', '4', '2'] (Total unique: 5)
2024-12-02 18:43:39,833 - INFO - approximate_social_grade: ['X', '1', '3', '4', '2'] (Total unique: 5)
2024-12-02 18:43:39,833 - INFO - 
All data ranges validated.
2024-12-02 18:43:39,833 - INFO - =====Verifying 'record_number' uniqueness:=====
2024-12-02 18:43:39,833 - INFO - Columns in batch: ['record_number', 'region', 'residence_type', 'family_composition', 'sex', 'age', 'marital_status', 'student', 'country_of_birth', 'health', 'ethnic_group', 'religion', 'economic_activity', 'occupation', 'industry', 'hours_worked_per_week', 'approximate_social_grade']
2024-12-02 18:43:39,834 - INFO - Record_Number is unique.
2024-12-02 18:43:39,835 - INFO - 'record_number' column reset.
2024-12-02 18:43:39,862 - INFO - Batch 7 cleaned and saved.
2024-12-02 18:43:39,866 - INFO - Progress saved to /cs/home/sz92/Documents/CS5002/P3/code/progress.json.
2024-12-02 18:43:39,869 - INFO - Processing batch 8...
2024-12-02 18:43:39,869 - INFO - =====Checking for missing value:=====
2024-12-02 18:43:39,872 - INFO - No missing values detected.
2024-12-02 18:43:39,872 - INFO - =====Checking for duplicate rows:=====
2024-12-02 18:43:39,877 - INFO - No duplicate rows detected.
2024-12-02 18:43:39,899 - INFO -        record_number     region  ... hours_worked_per_week approximate_social_grade
63092          63093  S92000003  ...                     X                        2
63106          63107  S92000003  ...                     X                        1
63112          63113  S92000003  ...                     X                        1
63124          63125  S92000003  ...                     X                        2
63127          63128  S92000003  ...                     X                        2
63129          63130  S92000003  ...                     X                        1
63139          63140  S92000003  ...                     X                        2
63140          63141  S92000003  ...                     X                        1
63142          63143  S92000003  ...                     X                        2
63152          63153  S92000003  ...                     X                        2
63159          63160  S92000003  ...                     X                        2
63163          63164  S92000003  ...                     X                        1
63168          63169  S92000003  ...                     X                        2
63171          63172  S92000003  ...                     X                        2
63235          63236  S92000003  ...                     X                        4
63241          63242  S92000003  ...                     X                        3
63295          63296  S92000003  ...                     X                        2
63317          63318  S92000003  ...                     X                        2
63350          63351  S92000003  ...                     X                        4
63366          63367  S92000003  ...                     X                        2
63383          63384  S92000003  ...                     X                        3

[21 rows x 17 columns]
2024-12-02 18:43:39,903 - INFO - Rule 1: Found 21 rows to delete, saved to data/rule_1_deleted_data.csv
2024-12-02 18:43:39,904 - INFO - Rule 2: No rows to delete
2024-12-02 18:43:39,907 - INFO - Rule 3: Found 8 rows to delete, saved to data/rule_3_deleted_data.csv
2024-12-02 18:43:39,914 - INFO - Rule 4: Found 16 rows to delete, saved to data/rule_4_deleted_data.csv
2024-12-02 18:43:39,916 - INFO - Rule 5: No rows to delete
2024-12-02 18:43:39,922 - INFO - Rule 6: Found 8 rows to delete, saved to data/rule_6_deleted_data.csv
2024-12-02 18:43:39,927 - INFO - =====validate_data_ranges:=====
2024-12-02 18:43:39,951 - INFO - 
Unique categories and counts per column:
2024-12-02 18:43:39,951 - INFO - residence_type: ['C', 'P'] (Total unique: 2)
2024-12-02 18:43:39,951 - INFO - family_composition: ['X', '1', '5', '3', '4', '2', '0'] (Total unique: 7)
2024-12-02 18:43:39,951 - INFO - sex: [1, 2] (Total unique: 2)
2024-12-02 18:43:39,951 - INFO - age: [1, 2, 3, 4, 5, 6, 7, 8] (Total unique: 8)
2024-12-02 18:43:39,951 - INFO - marital_status: [1, 2, 3, 4, 5] (Total unique: 5)
2024-12-02 18:43:39,951 - INFO - student: [1, 2] (Total unique: 2)
2024-12-02 18:43:39,951 - INFO - country_of_birth: [1, 2] (Total unique: 2)
2024-12-02 18:43:39,952 - INFO - health: [1, 2, 3, 4] (Total unique: 4)
2024-12-02 18:43:39,952 - INFO - ethnic_group: [1, 3, 4] (Total unique: 3)
2024-12-02 18:43:39,952 - INFO - religion: [1, 2, 3, 4, 5, 6, 8, 9] (Total unique: 8)
2024-12-02 18:43:39,952 - INFO - economic_activity: ['8', '6', '7', 'X', '1', '3', '9', '5', '4', '2'] (Total unique: 10)
2024-12-02 18:43:39,952 - INFO - occupation: ['8', '6', '7', 'X', '1', '5', '9', '3', '4', '2'] (Total unique: 10)
2024-12-02 18:43:39,952 - INFO - industry: ['13', '11', '10', '8', '6', '7', 'X', '3', '1', '12', '9', '5', '4', '2'] (Total unique: 14)
2024-12-02 18:43:39,952 - INFO - hours_worked_per_week: ['X', '1', '3', '4', '2'] (Total unique: 5)
2024-12-02 18:43:39,952 - INFO - approximate_social_grade: ['X', '1', '3', '4', '2'] (Total unique: 5)
2024-12-02 18:43:39,952 - INFO - 
All data ranges validated.
2024-12-02 18:43:39,952 - INFO - =====Verifying 'record_number' uniqueness:=====
2024-12-02 18:43:39,952 - INFO - Columns in batch: ['record_number', 'region', 'residence_type', 'family_composition', 'sex', 'age', 'marital_status', 'student', 'country_of_birth', 'health', 'ethnic_group', 'religion', 'economic_activity', 'occupation', 'industry', 'hours_worked_per_week', 'approximate_social_grade']
2024-12-02 18:43:39,952 - INFO - Record_Number is unique.
2024-12-02 18:43:39,954 - INFO - 'record_number' column reset.
2024-12-02 18:43:39,958 - INFO - Batch 8 cleaned and saved.
2024-12-02 18:43:39,961 - INFO - Progress saved to /cs/home/sz92/Documents/CS5002/P3/code/progress.json.
2024-12-02 18:43:39,961 - INFO - Data cleaning process completed. Total rows processed: 63388
2024-12-02 18:43:39,961 - INFO - Rows to drop: 5297
2024-12-02 18:43:39,961 - INFO - Cleaned data saved to ../data/output.csv
2024-12-02 18:43:39,961 - INFO - Progress file removed. Data processing complete.
2024-12-02 18:43:40,543 - INFO - Data clean code test passed. Congratulations! Result deatils in log/data_cleaning.log
2024-12-02 18:43:40,574 - INFO - =====Checking data types:=====
2024-12-02 18:43:40,582 - INFO - Batch info:
None
2024-12-02 18:43:40,622 - INFO - =====Checking for missing value:=====
2024-12-02 18:43:40,626 - INFO - No missing values detected.
2024-12-02 18:43:40,626 - INFO - =====Checking for duplicate rows:=====
2024-12-02 18:43:40,630 - INFO - No duplicate rows detected.
2024-12-02 18:43:40,630 - INFO - =====Verifying 'record_number' uniqueness:=====
2024-12-02 18:43:40,630 - INFO - Columns in batch: ['record_number', 'region', 'residence_type', 'family_composition', 'sex', 'age', 'marital_status', 'student', 'country_of_birth', 'health', 'ethnic_group', 'religion', 'economic_activity', 'occupation', 'industry', 'hours_worked_per_week', 'approximate_social_grade']
2024-12-02 18:43:40,631 - INFO - Record_Number is unique.
2024-12-02 18:43:40,631 - INFO - =====validate_data_ranges:=====
2024-12-02 18:43:40,702 - INFO - 
Unique categories and counts per column:
2024-12-02 18:43:40,702 - INFO - residence_type: ['C', 'P'] (Total unique: 2)
2024-12-02 18:43:40,702 - INFO - family_composition: ['X', '1', '5', '3', '4', '2', '0'] (Total unique: 7)
2024-12-02 18:43:40,702 - INFO - sex: [1, 2] (Total unique: 2)
2024-12-02 18:43:40,702 - INFO - age: [1, 2, 3, 4, 5, 6, 7, 8] (Total unique: 8)
2024-12-02 18:43:40,702 - INFO - marital_status: [1, 2, 3, 4, 5] (Total unique: 5)
2024-12-02 18:43:40,702 - INFO - student: [1, 2] (Total unique: 2)
2024-12-02 18:43:40,702 - INFO - country_of_birth: [1, 2] (Total unique: 2)
2024-12-02 18:43:40,702 - INFO - health: [1, 2, 3, 4, 5] (Total unique: 5)
2024-12-02 18:43:40,702 - INFO - ethnic_group: [1, 2, 3, 4, 5, 6] (Total unique: 6)
2024-12-02 18:43:40,702 - INFO - religion: [1, 2, 3, 4, 5, 6, 7, 8, 9] (Total unique: 9)
2024-12-02 18:43:40,702 - INFO - economic_activity: ['8', '6', '7', 'X', '1', '5', '9', '3', '4', '2'] (Total unique: 10)
2024-12-02 18:43:40,702 - INFO - occupation: ['8', '6', '7', 'X', '3', '1', '9', '5', '4', '2'] (Total unique: 10)
2024-12-02 18:43:40,702 - INFO - industry: ['13', '11', '10', '8', '6', '7', 'X', '12', '3', '1', '9', '5', '4', '2'] (Total unique: 14)
2024-12-02 18:43:40,702 - INFO - hours_worked_per_week: ['X', '1', '3', '4', '2'] (Total unique: 5)
2024-12-02 18:43:40,702 - INFO - approximate_social_grade: ['X', '1', '3', '4', '2'] (Total unique: 5)
2024-12-02 18:43:40,702 - INFO - 
All data ranges validated.
2024-12-02 18:43:40,702 - INFO - Starting data cleaning process...
2024-12-02 18:43:40,725 - INFO - Processing batch 1...
2024-12-02 18:43:40,725 - INFO - =====Checking for missing value:=====
2024-12-02 18:43:40,726 - INFO - No missing values detected.
2024-12-02 18:43:40,726 - INFO - =====Checking for duplicate rows:=====
2024-12-02 18:43:40,726 - INFO - No duplicate rows detected.
2024-12-02 18:49:11,846 - WARNING - Progress file progress.json not found. Starting from the beginning.
2024-12-02 18:49:11,912 - INFO - Loaded data from row 0.
2024-12-02 18:49:11,912 - INFO - Columns in DataFrame: ['record_number', 'region', 'residence_type', 'family_composition', 'sex', 'age', 'marital_status', 'student', 'country_of_birth', 'health', 'ethnic_group', 'religion', 'economic_activity', 'occupation', 'industry', 'hours_worked_per_week', 'approximate_social_grade']
2024-12-02 18:49:11,912 - WARNING - Progress file progress.json not found. Starting from the beginning.
2024-12-02 18:49:11,920 - INFO - =====Checking data types:=====
2024-12-02 18:49:11,927 - INFO - Batch info:
None
2024-12-02 18:49:11,960 - INFO - =====Checking for missing value:=====
2024-12-02 18:49:11,964 - INFO - No missing values detected.
2024-12-02 18:49:11,964 - INFO - =====Checking for duplicate rows:=====
2024-12-02 18:49:11,968 - INFO - No duplicate rows detected.
2024-12-02 18:49:11,968 - INFO - =====Verifying 'record_number' uniqueness:=====
2024-12-02 18:49:11,968 - INFO - Columns in batch: ['record_number', 'region', 'residence_type', 'family_composition', 'sex', 'age', 'marital_status', 'student', 'country_of_birth', 'health', 'ethnic_group', 'religion', 'economic_activity', 'occupation', 'industry', 'hours_worked_per_week', 'approximate_social_grade']
2024-12-02 18:49:11,969 - INFO - Record_Number is unique.
2024-12-02 18:49:11,969 - INFO - =====validate_data_ranges:=====
2024-12-02 18:49:12,065 - INFO - 
Unique categories and counts per column:
2024-12-02 18:49:12,065 - INFO - residence_type: ['P', 'C'] (Total unique: 2)
2024-12-02 18:49:12,065 - INFO - family_composition: ['0', '4', '1', '3', '2', '5', 'X'] (Total unique: 7)
2024-12-02 18:49:12,065 - INFO - sex: [1, 2] (Total unique: 2)
2024-12-02 18:49:12,065 - INFO - age: [1, 2, 3, 4, 5, 6, 7, 8] (Total unique: 8)
2024-12-02 18:49:12,065 - INFO - marital_status: [1, 2, 3, 4, 5] (Total unique: 5)
2024-12-02 18:49:12,065 - INFO - student: [1, 2] (Total unique: 2)
2024-12-02 18:49:12,065 - INFO - country_of_birth: [1, 2] (Total unique: 2)
2024-12-02 18:49:12,065 - INFO - health: [1, 2, 3, 4, 5] (Total unique: 5)
2024-12-02 18:49:12,065 - INFO - ethnic_group: [1, 2, 3, 4, 5, 6] (Total unique: 6)
2024-12-02 18:49:12,065 - INFO - religion: [1, 2, 3, 4, 5, 6, 7, 8, 9] (Total unique: 9)
2024-12-02 18:49:12,065 - INFO - economic_activity: ['8', '4', '1', '9', '3', '6', '2', '5', '7', 'X'] (Total unique: 10)
2024-12-02 18:49:12,065 - INFO - occupation: ['8', '4', '1', '9', '3', '6', '2', '5', '7', 'X'] (Total unique: 10)
2024-12-02 18:49:12,065 - INFO - industry: ['10', '8', '4', '1', '9', '3', '6', '11', '2', '5', '7', '12', 'X', '13'] (Total unique: 14)
2024-12-02 18:49:12,065 - INFO - hours_worked_per_week: ['4', '1', '3', '2', 'X'] (Total unique: 5)
2024-12-02 18:49:12,066 - INFO - approximate_social_grade: ['4', '1', '3', '2', 'X'] (Total unique: 5)
2024-12-02 18:49:12,066 - INFO - 
All data ranges validated.
2024-12-02 18:49:12,066 - INFO - Starting data cleaning process...
2024-12-02 18:49:12,076 - INFO - Processing batch 1...
2024-12-02 18:49:12,076 - INFO - =====Checking for missing value:=====
2024-12-02 18:49:12,079 - INFO - No missing values detected.
2024-12-02 18:49:12,079 - INFO - =====Checking for duplicate rows:=====
2024-12-02 18:49:12,083 - INFO - No duplicate rows detected.
2024-12-02 18:49:12,096 - INFO -       record_number     region  ... hours_worked_per_week approximate_social_grade
20               21  S92000003  ...                     X                        2
47               48  S92000003  ...                     X                        2
48               49  S92000003  ...                     X                        2
85               86  S92000003  ...                     X                        1
88               89  S92000003  ...                     X                        2
...             ...        ...  ...                   ...                      ...
8818           8819  S92000003  ...                     X                        4
8875           8876  S92000003  ...                     X                        2
8886           8887  S92000003  ...                     X                        1
8906           8907  S92000003  ...                     X                        4
8930           8931  S92000003  ...                     X                        2

[372 rows x 17 columns]
2024-12-02 18:49:12,184 - INFO - Rule 1: Found 372 rows to delete, saved to data/rule_1_deleted_data.csv
2024-12-02 18:49:12,189 - INFO - Rule 2: No rows to delete
2024-12-02 18:49:12,199 - INFO - Rule 3: Found 123 rows to delete, saved to data/rule_3_deleted_data.csv
2024-12-02 18:49:12,210 - INFO - Rule 4: Found 327 rows to delete, saved to data/rule_4_deleted_data.csv
2024-12-02 18:49:12,213 - INFO - Rule 5: No rows to delete
2024-12-02 18:49:12,221 - INFO - Rule 6: Found 123 rows to delete, saved to data/rule_6_deleted_data.csv
2024-12-02 18:49:12,225 - INFO - =====validate_data_ranges:=====
2024-12-02 18:49:12,306 - INFO - 
Unique categories and counts per column:
2024-12-02 18:49:12,306 - INFO - residence_type: ['P', 'C'] (Total unique: 2)
2024-12-02 18:49:12,306 - INFO - family_composition: ['0', '4', '1', '3', '2', '5', 'X'] (Total unique: 7)
2024-12-02 18:49:12,306 - INFO - sex: [1, 2] (Total unique: 2)
2024-12-02 18:49:12,306 - INFO - age: [1, 2, 3, 4, 5, 6, 7, 8] (Total unique: 8)
2024-12-02 18:49:12,306 - INFO - marital_status: [1, 2, 3, 4, 5] (Total unique: 5)
2024-12-02 18:49:12,306 - INFO - student: [1, 2] (Total unique: 2)
2024-12-02 18:49:12,306 - INFO - country_of_birth: [1, 2] (Total unique: 2)
2024-12-02 18:49:12,306 - INFO - health: [1, 2, 3, 4, 5] (Total unique: 5)
2024-12-02 18:49:12,306 - INFO - ethnic_group: [1, 2, 3, 4, 5, 6] (Total unique: 6)
2024-12-02 18:49:12,306 - INFO - religion: [1, 2, 3, 4, 5, 6, 7, 8, 9] (Total unique: 9)
2024-12-02 18:49:12,306 - INFO - economic_activity: ['8', '4', '1', '9', '3', '6', '2', '5', '7', 'X'] (Total unique: 10)
2024-12-02 18:49:12,306 - INFO - occupation: ['8', '4', '1', '9', '3', '6', '2', '5', '7', 'X'] (Total unique: 10)
2024-12-02 18:49:12,306 - INFO - industry: ['10', '8', '4', '1', '9', '3', '6', '11', '2', '5', '7', '12', 'X', '13'] (Total unique: 14)
2024-12-02 18:49:12,306 - INFO - hours_worked_per_week: ['4', '1', '3', '2', 'X'] (Total unique: 5)
2024-12-02 18:49:12,306 - INFO - approximate_social_grade: ['4', '1', '3', '2', 'X'] (Total unique: 5)
2024-12-02 18:49:12,306 - INFO - 
All data ranges validated.
2024-12-02 18:49:12,306 - INFO - =====Verifying 'record_number' uniqueness:=====
2024-12-02 18:49:12,306 - INFO - Columns in batch: ['record_number', 'region', 'residence_type', 'family_composition', 'sex', 'age', 'marital_status', 'student', 'country_of_birth', 'health', 'ethnic_group', 'religion', 'economic_activity', 'occupation', 'industry', 'hours_worked_per_week', 'approximate_social_grade']
2024-12-02 18:49:12,307 - INFO - Record_Number is unique.
2024-12-02 18:49:12,308 - INFO - 'record_number' column reset.
2024-12-02 18:49:12,338 - INFO - Batch 1 cleaned and saved.
2024-12-02 18:49:12,341 - INFO - Progress saved to /cs/home/sz92/Documents/CS5002/P3/code/progress.json.
2024-12-02 18:49:12,351 - INFO - Processing batch 2...
2024-12-02 18:49:12,351 - INFO - =====Checking for missing value:=====
2024-12-02 18:49:12,354 - INFO - No missing values detected.
2024-12-02 18:49:12,354 - INFO - =====Checking for duplicate rows:=====
2024-12-02 18:49:12,358 - INFO - No duplicate rows detected.
2024-12-02 18:49:12,369 - INFO -        record_number     region  ... hours_worked_per_week approximate_social_grade
9004            9005  S92000003  ...                     X                        2
9007            9008  S92000003  ...                     X                        2
9010            9011  S92000003  ...                     X                        2
9014            9015  S92000003  ...                     X                        2
9026            9027  S92000003  ...                     X                        2
...              ...        ...  ...                   ...                      ...
17904          17905  S92000003  ...                     X                        2
17952          17953  S92000003  ...                     X                        2
17968          17969  S92000003  ...                     X                        1
17976          17977  S92000003  ...                     X                        2
17981          17982  S92000003  ...                     X                        3

[340 rows x 17 columns]
2024-12-02 18:49:12,375 - INFO - Rule 1: Found 340 rows to delete, saved to data/rule_1_deleted_data.csv
2024-12-02 18:49:12,376 - INFO - Rule 2: No rows to delete
2024-12-02 18:49:12,382 - INFO - Rule 3: Found 115 rows to delete, saved to data/rule_3_deleted_data.csv
2024-12-02 18:49:12,389 - INFO - Rule 4: Found 344 rows to delete, saved to data/rule_4_deleted_data.csv
2024-12-02 18:49:12,393 - INFO - Rule 5: No rows to delete
2024-12-02 18:49:12,407 - INFO - Rule 6: Found 115 rows to delete, saved to data/rule_6_deleted_data.csv
2024-12-02 18:49:12,412 - INFO - =====validate_data_ranges:=====
2024-12-02 18:49:12,490 - INFO - 
Unique categories and counts per column:
2024-12-02 18:49:12,490 - INFO - residence_type: ['P', 'C'] (Total unique: 2)
2024-12-02 18:49:12,490 - INFO - family_composition: ['0', '4', '1', '3', '2', '5', 'X'] (Total unique: 7)
2024-12-02 18:49:12,490 - INFO - sex: [1, 2] (Total unique: 2)
2024-12-02 18:49:12,490 - INFO - age: [1, 2, 3, 4, 5, 6, 7, 8] (Total unique: 8)
2024-12-02 18:49:12,490 - INFO - marital_status: [1, 2, 3, 4, 5] (Total unique: 5)
2024-12-02 18:49:12,490 - INFO - student: [1, 2] (Total unique: 2)
2024-12-02 18:49:12,490 - INFO - country_of_birth: [1, 2] (Total unique: 2)
2024-12-02 18:49:12,490 - INFO - health: [1, 2, 3, 4, 5] (Total unique: 5)
2024-12-02 18:49:12,490 - INFO - ethnic_group: [1, 2, 3, 4, 5, 6] (Total unique: 6)
2024-12-02 18:49:12,490 - INFO - religion: [1, 2, 3, 4, 5, 6, 7, 8, 9] (Total unique: 9)
2024-12-02 18:49:12,490 - INFO - economic_activity: ['8', '4', '1', '9', '3', '6', '7', '2', '5', 'X'] (Total unique: 10)
2024-12-02 18:49:12,490 - INFO - occupation: ['8', '4', '1', '9', '3', '6', '2', '5', '7', 'X'] (Total unique: 10)
2024-12-02 18:49:12,490 - INFO - industry: ['10', '8', '4', '1', '9', '3', '6', '11', '2', '5', '7', '12', 'X', '13'] (Total unique: 14)
2024-12-02 18:49:12,490 - INFO - hours_worked_per_week: ['4', '1', '3', '2', 'X'] (Total unique: 5)
2024-12-02 18:49:12,490 - INFO - approximate_social_grade: ['4', '1', '3', '2', 'X'] (Total unique: 5)
2024-12-02 18:49:12,490 - INFO - 
All data ranges validated.
2024-12-02 18:49:12,490 - INFO - =====Verifying 'record_number' uniqueness:=====
2024-12-02 18:49:12,490 - INFO - Columns in batch: ['record_number', 'region', 'residence_type', 'family_composition', 'sex', 'age', 'marital_status', 'student', 'country_of_birth', 'health', 'ethnic_group', 'religion', 'economic_activity', 'occupation', 'industry', 'hours_worked_per_week', 'approximate_social_grade']
2024-12-02 18:49:12,491 - INFO - Record_Number is unique.
2024-12-02 18:49:12,493 - INFO - 'record_number' column reset.
2024-12-02 18:49:12,520 - INFO - Batch 2 cleaned and saved.
2024-12-02 18:49:12,523 - INFO - Progress saved to /cs/home/sz92/Documents/CS5002/P3/code/progress.json.
2024-12-02 18:49:12,531 - INFO - Processing batch 3...
2024-12-02 18:49:12,531 - INFO - =====Checking for missing value:=====
2024-12-02 18:49:12,534 - INFO - No missing values detected.
2024-12-02 18:49:12,534 - INFO - =====Checking for duplicate rows:=====
2024-12-02 18:49:12,539 - INFO - No duplicate rows detected.
2024-12-02 18:49:12,551 - INFO -        record_number     region  ... hours_worked_per_week approximate_social_grade
18012          18013  S92000003  ...                     X                        3
18032          18033  S92000003  ...                     X                        3
18058          18059  S92000003  ...                     X                        4
18131          18132  S92000003  ...                     X                        1
18142          18143  S92000003  ...                     X                        2
...              ...        ...  ...                   ...                      ...
26889          26890  S92000003  ...                     X                        2
26905          26906  S92000003  ...                     X                        2
26919          26920  S92000003  ...                     X                        3
26928          26929  S92000003  ...                     X                        3
26982          26983  S92000003  ...                     X                        2

[371 rows x 17 columns]
2024-12-02 18:49:12,556 - INFO - Rule 1: Found 371 rows to delete, saved to data/rule_1_deleted_data.csv
2024-12-02 18:49:12,557 - INFO - Rule 2: No rows to delete
2024-12-02 18:49:12,563 - INFO - Rule 3: Found 124 rows to delete, saved to data/rule_3_deleted_data.csv
2024-12-02 18:49:12,570 - INFO - Rule 4: Found 359 rows to delete, saved to data/rule_4_deleted_data.csv
2024-12-02 18:49:12,571 - INFO - Rule 5: No rows to delete
2024-12-02 18:49:12,577 - INFO - Rule 6: Found 124 rows to delete, saved to data/rule_6_deleted_data.csv
2024-12-02 18:49:12,579 - INFO - =====validate_data_ranges:=====
2024-12-02 18:49:12,647 - INFO - 
Unique categories and counts per column:
2024-12-02 18:49:12,647 - INFO - residence_type: ['P', 'C'] (Total unique: 2)
2024-12-02 18:49:12,647 - INFO - family_composition: ['0', '4', '1', '3', '2', '5', 'X'] (Total unique: 7)
2024-12-02 18:49:12,647 - INFO - sex: [1, 2] (Total unique: 2)
2024-12-02 18:49:12,647 - INFO - age: [1, 2, 3, 4, 5, 6, 7, 8] (Total unique: 8)
2024-12-02 18:49:12,647 - INFO - marital_status: [1, 2, 3, 4, 5] (Total unique: 5)
2024-12-02 18:49:12,647 - INFO - student: [1, 2] (Total unique: 2)
2024-12-02 18:49:12,647 - INFO - country_of_birth: [1, 2] (Total unique: 2)
2024-12-02 18:49:12,647 - INFO - health: [1, 2, 3, 4, 5] (Total unique: 5)
2024-12-02 18:49:12,647 - INFO - ethnic_group: [1, 2, 3, 4, 5, 6] (Total unique: 6)
2024-12-02 18:49:12,647 - INFO - religion: [1, 2, 3, 4, 5, 6, 7, 8, 9] (Total unique: 9)
2024-12-02 18:49:12,647 - INFO - economic_activity: ['8', '4', '1', '9', '3', '6', '7', '5', '2', 'X'] (Total unique: 10)
2024-12-02 18:49:12,647 - INFO - occupation: ['8', '4', '1', '9', '3', '6', '7', '2', '5', 'X'] (Total unique: 10)
2024-12-02 18:49:12,647 - INFO - industry: ['10', '8', '4', '1', '9', '3', '6', '11', '7', '2', '5', '12', 'X', '13'] (Total unique: 14)
2024-12-02 18:49:12,647 - INFO - hours_worked_per_week: ['4', '1', '3', '2', 'X'] (Total unique: 5)
2024-12-02 18:49:12,647 - INFO - approximate_social_grade: ['4', '1', '3', '2', 'X'] (Total unique: 5)
2024-12-02 18:49:12,647 - INFO - 
All data ranges validated.
2024-12-02 18:49:12,647 - INFO - =====Verifying 'record_number' uniqueness:=====
2024-12-02 18:49:12,647 - INFO - Columns in batch: ['record_number', 'region', 'residence_type', 'family_composition', 'sex', 'age', 'marital_status', 'student', 'country_of_birth', 'health', 'ethnic_group', 'religion', 'economic_activity', 'occupation', 'industry', 'hours_worked_per_week', 'approximate_social_grade']
2024-12-02 18:49:12,648 - INFO - Record_Number is unique.
2024-12-02 18:49:12,649 - INFO - 'record_number' column reset.
2024-12-02 18:49:12,676 - INFO - Batch 3 cleaned and saved.
2024-12-02 18:49:12,679 - INFO - Progress saved to /cs/home/sz92/Documents/CS5002/P3/code/progress.json.
2024-12-02 18:49:12,690 - INFO - Processing batch 4...
2024-12-02 18:49:12,690 - INFO - =====Checking for missing value:=====
2024-12-02 18:49:12,694 - INFO - No missing values detected.
2024-12-02 18:49:12,694 - INFO - =====Checking for duplicate rows:=====
2024-12-02 18:49:12,698 - INFO - No duplicate rows detected.
2024-12-02 18:49:12,710 - INFO -        record_number     region  ... hours_worked_per_week approximate_social_grade
27017          27018  S92000003  ...                     X                        1
27085          27086  S92000003  ...                     X                        4
27104          27105  S92000003  ...                     X                        2
27187          27188  S92000003  ...                     X                        2
27206          27207  S92000003  ...                     X                        1
...              ...        ...  ...                   ...                      ...
35871          35872  S92000003  ...                     X                        2
35927          35928  S92000003  ...                     X                        2
35944          35945  S92000003  ...                     X                        1
35947          35948  S92000003  ...                     X                        1
35989          35990  S92000003  ...                     X                        2

[327 rows x 17 columns]
2024-12-02 18:49:12,715 - INFO - Rule 1: Found 327 rows to delete, saved to data/rule_1_deleted_data.csv
2024-12-02 18:49:12,718 - INFO - Rule 2: No rows to delete
2024-12-02 18:49:12,725 - INFO - Rule 3: Found 118 rows to delete, saved to data/rule_3_deleted_data.csv
2024-12-02 18:49:12,733 - INFO - Rule 4: Found 317 rows to delete, saved to data/rule_4_deleted_data.csv
2024-12-02 18:49:12,736 - INFO - Rule 5: No rows to delete
2024-12-02 18:49:12,743 - INFO - Rule 6: Found 118 rows to delete, saved to data/rule_6_deleted_data.csv
2024-12-02 18:49:12,747 - INFO - =====validate_data_ranges:=====
2024-12-02 18:49:12,820 - INFO - 
Unique categories and counts per column:
2024-12-02 18:49:12,820 - INFO - residence_type: ['P', 'C'] (Total unique: 2)
2024-12-02 18:49:12,820 - INFO - family_composition: ['0', '4', '1', '3', '2', '5', 'X'] (Total unique: 7)
2024-12-02 18:49:12,820 - INFO - sex: [1, 2] (Total unique: 2)
2024-12-02 18:49:12,820 - INFO - age: [1, 2, 3, 4, 5, 6, 7, 8] (Total unique: 8)
2024-12-02 18:49:12,820 - INFO - marital_status: [1, 2, 3, 4, 5] (Total unique: 5)
2024-12-02 18:49:12,820 - INFO - student: [1, 2] (Total unique: 2)
2024-12-02 18:49:12,820 - INFO - country_of_birth: [1, 2] (Total unique: 2)
2024-12-02 18:49:12,820 - INFO - health: [1, 2, 3, 4, 5] (Total unique: 5)
2024-12-02 18:49:12,820 - INFO - ethnic_group: [1, 2, 3, 4, 5, 6] (Total unique: 6)
2024-12-02 18:49:12,820 - INFO - religion: [1, 2, 3, 4, 5, 6, 7, 8, 9] (Total unique: 9)
2024-12-02 18:49:12,820 - INFO - economic_activity: ['8', '4', '1', '9', '3', '6', '2', '5', '7', 'X'] (Total unique: 10)
2024-12-02 18:49:12,820 - INFO - occupation: ['8', '4', '1', '9', '3', '6', '2', '5', '7', 'X'] (Total unique: 10)
2024-12-02 18:49:12,820 - INFO - industry: ['10', '8', '4', '1', '9', '3', '6', '11', '7', '5', '2', '12', 'X', '13'] (Total unique: 14)
2024-12-02 18:49:12,820 - INFO - hours_worked_per_week: ['4', '1', '3', '2', 'X'] (Total unique: 5)
2024-12-02 18:49:12,820 - INFO - approximate_social_grade: ['4', '1', '3', '2', 'X'] (Total unique: 5)
2024-12-02 18:49:12,821 - INFO - 
All data ranges validated.
2024-12-02 18:49:12,821 - INFO - =====Verifying 'record_number' uniqueness:=====
2024-12-02 18:49:12,821 - INFO - Columns in batch: ['record_number', 'region', 'residence_type', 'family_composition', 'sex', 'age', 'marital_status', 'student', 'country_of_birth', 'health', 'ethnic_group', 'religion', 'economic_activity', 'occupation', 'industry', 'hours_worked_per_week', 'approximate_social_grade']
2024-12-02 18:49:12,821 - INFO - Record_Number is unique.
2024-12-02 18:49:12,823 - INFO - 'record_number' column reset.
2024-12-02 18:49:12,850 - INFO - Batch 4 cleaned and saved.
2024-12-02 18:49:12,853 - INFO - Progress saved to /cs/home/sz92/Documents/CS5002/P3/code/progress.json.
2024-12-02 18:49:12,861 - INFO - Processing batch 5...
2024-12-02 18:49:12,861 - INFO - =====Checking for missing value:=====
2024-12-02 18:49:12,864 - INFO - No missing values detected.
2024-12-02 18:49:12,864 - INFO - =====Checking for duplicate rows:=====
2024-12-02 18:49:12,868 - INFO - No duplicate rows detected.
2024-12-02 18:49:12,880 - INFO -        record_number     region  ... hours_worked_per_week approximate_social_grade
36006          36007  S92000003  ...                     X                        2
36017          36018  S92000003  ...                     X                        4
36074          36075  S92000003  ...                     X                        2
36124          36125  S92000003  ...                     X                        2
36127          36128  S92000003  ...                     X                        2
...              ...        ...  ...                   ...                      ...
44863          44864  S92000003  ...                     X                        2
44870          44871  S92000003  ...                     X                        3
44937          44938  S92000003  ...                     X                        2
44986          44987  S92000003  ...                     X                        2
44996          44997  S92000003  ...                     X                        3

[377 rows x 17 columns]
2024-12-02 18:49:12,885 - INFO - Rule 1: Found 377 rows to delete, saved to data/rule_1_deleted_data.csv
2024-12-02 18:49:12,886 - INFO - Rule 2: No rows to delete
2024-12-02 18:49:12,892 - INFO - Rule 3: Found 124 rows to delete, saved to data/rule_3_deleted_data.csv
2024-12-02 18:49:12,898 - INFO - Rule 4: Found 354 rows to delete, saved to data/rule_4_deleted_data.csv
2024-12-02 18:49:12,899 - INFO - Rule 5: No rows to delete
2024-12-02 18:49:12,904 - INFO - Rule 6: Found 124 rows to delete, saved to data/rule_6_deleted_data.csv
2024-12-02 18:49:12,906 - INFO - =====validate_data_ranges:=====
2024-12-02 18:49:12,973 - INFO - 
Unique categories and counts per column:
2024-12-02 18:49:12,973 - INFO - residence_type: ['P', 'C'] (Total unique: 2)
2024-12-02 18:49:12,973 - INFO - family_composition: ['0', '4', '1', '3', '2', '5', 'X'] (Total unique: 7)
2024-12-02 18:49:12,973 - INFO - sex: [1, 2] (Total unique: 2)
2024-12-02 18:49:12,973 - INFO - age: [1, 2, 3, 4, 5, 6, 7, 8] (Total unique: 8)
2024-12-02 18:49:12,973 - INFO - marital_status: [1, 2, 3, 4, 5] (Total unique: 5)
2024-12-02 18:49:12,973 - INFO - student: [1, 2] (Total unique: 2)
2024-12-02 18:49:12,973 - INFO - country_of_birth: [1, 2] (Total unique: 2)
2024-12-02 18:49:12,973 - INFO - health: [1, 2, 3, 4, 5] (Total unique: 5)
2024-12-02 18:49:12,973 - INFO - ethnic_group: [1, 2, 3, 4, 5, 6] (Total unique: 6)
2024-12-02 18:49:12,973 - INFO - religion: [1, 2, 3, 4, 5, 6, 7, 8, 9] (Total unique: 9)
2024-12-02 18:49:12,973 - INFO - economic_activity: ['8', '4', '1', '9', '3', '6', '2', '5', '7', 'X'] (Total unique: 10)
2024-12-02 18:49:12,973 - INFO - occupation: ['8', '4', '1', '9', '3', '6', '2', '7', '5', 'X'] (Total unique: 10)
2024-12-02 18:49:12,973 - INFO - industry: ['10', '8', '4', '1', '9', '3', '6', '11', '2', '5', '7', '12', 'X', '13'] (Total unique: 14)
2024-12-02 18:49:12,973 - INFO - hours_worked_per_week: ['4', '1', '3', '2', 'X'] (Total unique: 5)
2024-12-02 18:49:12,973 - INFO - approximate_social_grade: ['4', '1', '3', '2', 'X'] (Total unique: 5)
2024-12-02 18:49:12,973 - INFO - 
All data ranges validated.
2024-12-02 18:49:12,973 - INFO - =====Verifying 'record_number' uniqueness:=====
2024-12-02 18:49:12,973 - INFO - Columns in batch: ['record_number', 'region', 'residence_type', 'family_composition', 'sex', 'age', 'marital_status', 'student', 'country_of_birth', 'health', 'ethnic_group', 'religion', 'economic_activity', 'occupation', 'industry', 'hours_worked_per_week', 'approximate_social_grade']
2024-12-02 18:49:12,974 - INFO - Record_Number is unique.
2024-12-02 18:49:12,975 - INFO - 'record_number' column reset.
2024-12-02 18:49:13,002 - INFO - Batch 5 cleaned and saved.
2024-12-02 18:49:13,005 - INFO - Progress saved to /cs/home/sz92/Documents/CS5002/P3/code/progress.json.
2024-12-02 18:49:13,014 - INFO - Processing batch 6...
2024-12-02 18:49:13,015 - INFO - =====Checking for missing value:=====
2024-12-02 18:49:13,018 - INFO - No missing values detected.
2024-12-02 18:49:13,018 - INFO - =====Checking for duplicate rows:=====
2024-12-02 18:49:13,023 - INFO - No duplicate rows detected.
2024-12-02 18:49:13,035 - INFO -        record_number     region  ... hours_worked_per_week approximate_social_grade
45024          45025  S92000003  ...                     X                        2
45030          45031  S92000003  ...                     X                        4
45047          45048  S92000003  ...                     X                        3
45072          45073  S92000003  ...                     X                        3
45124          45125  S92000003  ...                     X                        1
...              ...        ...  ...                   ...                      ...
53900          53901  S92000003  ...                     X                        4
53923          53924  S92000003  ...                     X                        4
53960          53961  S92000003  ...                     X                        4
53979          53980  S92000003  ...                     X                        3
53983          53984  S92000003  ...                     X                        4

[408 rows x 17 columns]
2024-12-02 18:49:13,040 - INFO - Rule 1: Found 408 rows to delete, saved to data/rule_1_deleted_data.csv
2024-12-02 18:49:13,042 - INFO - Rule 2: No rows to delete
2024-12-02 18:49:13,047 - INFO - Rule 3: Found 113 rows to delete, saved to data/rule_3_deleted_data.csv
2024-12-02 18:49:13,052 - INFO - Rule 4: Found 335 rows to delete, saved to data/rule_4_deleted_data.csv
2024-12-02 18:49:13,055 - INFO - Rule 5: No rows to delete
2024-12-02 18:49:13,059 - INFO - Rule 6: Found 113 rows to delete, saved to data/rule_6_deleted_data.csv
2024-12-02 18:49:13,061 - INFO - =====validate_data_ranges:=====
2024-12-02 18:49:13,129 - INFO - 
Unique categories and counts per column:
2024-12-02 18:49:13,129 - INFO - residence_type: ['P', 'C'] (Total unique: 2)
2024-12-02 18:49:13,129 - INFO - family_composition: ['0', '4', '1', '3', '2', '5', 'X'] (Total unique: 7)
2024-12-02 18:49:13,129 - INFO - sex: [1, 2] (Total unique: 2)
2024-12-02 18:49:13,129 - INFO - age: [1, 2, 3, 4, 5, 6, 7, 8] (Total unique: 8)
2024-12-02 18:49:13,129 - INFO - marital_status: [1, 2, 3, 4, 5] (Total unique: 5)
2024-12-02 18:49:13,129 - INFO - student: [1, 2] (Total unique: 2)
2024-12-02 18:49:13,129 - INFO - country_of_birth: [1, 2] (Total unique: 2)
2024-12-02 18:49:13,129 - INFO - health: [1, 2, 3, 4, 5] (Total unique: 5)
2024-12-02 18:49:13,129 - INFO - ethnic_group: [1, 2, 3, 4, 5, 6] (Total unique: 6)
2024-12-02 18:49:13,129 - INFO - religion: [1, 2, 3, 4, 5, 6, 7, 8, 9] (Total unique: 9)
2024-12-02 18:49:13,129 - INFO - economic_activity: ['8', '4', '1', '9', '3', '6', '2', '5', '7', 'X'] (Total unique: 10)
2024-12-02 18:49:13,129 - INFO - occupation: ['8', '4', '1', '9', '3', '6', '2', '5', '7', 'X'] (Total unique: 10)
2024-12-02 18:49:13,129 - INFO - industry: ['10', '8', '4', '1', '9', '3', '6', '11', '2', '5', '7', '12', 'X', '13'] (Total unique: 14)
2024-12-02 18:49:13,129 - INFO - hours_worked_per_week: ['4', '1', '3', '2', 'X'] (Total unique: 5)
2024-12-02 18:49:13,129 - INFO - approximate_social_grade: ['4', '1', '3', '2', 'X'] (Total unique: 5)
2024-12-02 18:49:13,129 - INFO - 
All data ranges validated.
2024-12-02 18:49:13,129 - INFO - =====Verifying 'record_number' uniqueness:=====
2024-12-02 18:49:13,129 - INFO - Columns in batch: ['record_number', 'region', 'residence_type', 'family_composition', 'sex', 'age', 'marital_status', 'student', 'country_of_birth', 'health', 'ethnic_group', 'religion', 'economic_activity', 'occupation', 'industry', 'hours_worked_per_week', 'approximate_social_grade']
2024-12-02 18:49:13,130 - INFO - Record_Number is unique.
2024-12-02 18:49:13,132 - INFO - 'record_number' column reset.
2024-12-02 18:49:13,157 - INFO - Batch 6 cleaned and saved.
2024-12-02 18:49:13,160 - INFO - Progress saved to /cs/home/sz92/Documents/CS5002/P3/code/progress.json.
2024-12-02 18:49:13,175 - INFO - Processing batch 7...
2024-12-02 18:49:13,175 - INFO - =====Checking for missing value:=====
2024-12-02 18:49:13,180 - INFO - No missing values detected.
2024-12-02 18:49:13,180 - INFO - =====Checking for duplicate rows:=====
2024-12-02 18:49:13,185 - INFO - No duplicate rows detected.
2024-12-02 18:49:13,197 - INFO -        record_number     region  ... hours_worked_per_week approximate_social_grade
54010          54011  S92000003  ...                     X                        4
54023          54024  S92000003  ...                     X                        4
54132          54133  S92000003  ...                     X                        2
54137          54138  S92000003  ...                     X                        4
54153          54154  S92000003  ...                     X                        1
...              ...        ...  ...                   ...                      ...
62748          62749  S92000003  ...                     X                        1
62763          62764  S92000003  ...                     X                        2
62909          62910  S92000003  ...                     X                        2
62936          62937  S92000003  ...                     X                        2
62944          62945  S92000003  ...                     X                        2

[382 rows x 17 columns]
2024-12-02 18:49:13,204 - INFO - Rule 1: Found 382 rows to delete, saved to data/rule_1_deleted_data.csv
2024-12-02 18:49:13,207 - INFO - Rule 2: No rows to delete
2024-12-02 18:49:13,214 - INFO - Rule 3: Found 118 rows to delete, saved to data/rule_3_deleted_data.csv
2024-12-02 18:49:13,223 - INFO - Rule 4: Found 310 rows to delete, saved to data/rule_4_deleted_data.csv
2024-12-02 18:49:13,225 - INFO - Rule 5: No rows to delete
2024-12-02 18:49:13,231 - INFO - Rule 6: Found 118 rows to delete, saved to data/rule_6_deleted_data.csv
2024-12-02 18:49:13,235 - INFO - =====validate_data_ranges:=====
2024-12-02 18:49:13,308 - INFO - 
Unique categories and counts per column:
2024-12-02 18:49:13,308 - INFO - residence_type: ['P', 'C'] (Total unique: 2)
2024-12-02 18:49:13,308 - INFO - family_composition: ['0', '4', '1', '3', '2', '5', 'X'] (Total unique: 7)
2024-12-02 18:49:13,308 - INFO - sex: [1, 2] (Total unique: 2)
2024-12-02 18:49:13,308 - INFO - age: [1, 2, 3, 4, 5, 6, 7, 8] (Total unique: 8)
2024-12-02 18:49:13,308 - INFO - marital_status: [1, 2, 3, 4, 5] (Total unique: 5)
2024-12-02 18:49:13,308 - INFO - student: [1, 2] (Total unique: 2)
2024-12-02 18:49:13,308 - INFO - country_of_birth: [1, 2] (Total unique: 2)
2024-12-02 18:49:13,308 - INFO - health: [1, 2, 3, 4, 5] (Total unique: 5)
2024-12-02 18:49:13,308 - INFO - ethnic_group: [1, 2, 3, 4, 5, 6] (Total unique: 6)
2024-12-02 18:49:13,308 - INFO - religion: [1, 2, 3, 4, 5, 6, 7, 8, 9] (Total unique: 9)
2024-12-02 18:49:13,308 - INFO - economic_activity: ['8', '4', '1', '9', '3', '6', '2', '5', '7', 'X'] (Total unique: 10)
2024-12-02 18:49:13,308 - INFO - occupation: ['8', '4', '1', '9', '3', '6', '7', '5', '2', 'X'] (Total unique: 10)
2024-12-02 18:49:13,308 - INFO - industry: ['10', '8', '4', '1', '9', '3', '6', '11', '7', '5', '2', '12', 'X', '13'] (Total unique: 14)
2024-12-02 18:49:13,308 - INFO - hours_worked_per_week: ['4', '1', '3', '2', 'X'] (Total unique: 5)
2024-12-02 18:49:13,308 - INFO - approximate_social_grade: ['4', '1', '3', '2', 'X'] (Total unique: 5)
2024-12-02 18:49:13,308 - INFO - 
All data ranges validated.
2024-12-02 18:49:13,308 - INFO - =====Verifying 'record_number' uniqueness:=====
2024-12-02 18:49:13,308 - INFO - Columns in batch: ['record_number', 'region', 'residence_type', 'family_composition', 'sex', 'age', 'marital_status', 'student', 'country_of_birth', 'health', 'ethnic_group', 'religion', 'economic_activity', 'occupation', 'industry', 'hours_worked_per_week', 'approximate_social_grade']
2024-12-02 18:49:13,309 - INFO - Record_Number is unique.
2024-12-02 18:49:13,311 - INFO - 'record_number' column reset.
2024-12-02 18:49:13,337 - INFO - Batch 7 cleaned and saved.
2024-12-02 18:49:13,340 - INFO - Progress saved to /cs/home/sz92/Documents/CS5002/P3/code/progress.json.
2024-12-02 18:49:13,341 - INFO - Processing batch 8...
2024-12-02 18:49:13,341 - INFO - =====Checking for missing value:=====
2024-12-02 18:49:13,342 - INFO - No missing values detected.
2024-12-02 18:49:13,342 - INFO - =====Checking for duplicate rows:=====
2024-12-02 18:49:13,344 - INFO - No duplicate rows detected.
2024-12-02 18:49:13,359 - INFO -        record_number     region  ... hours_worked_per_week approximate_social_grade
63092          63093  S92000003  ...                     X                        2
63106          63107  S92000003  ...                     X                        1
63112          63113  S92000003  ...                     X                        1
63124          63125  S92000003  ...                     X                        2
63127          63128  S92000003  ...                     X                        2
63129          63130  S92000003  ...                     X                        1
63139          63140  S92000003  ...                     X                        2
63140          63141  S92000003  ...                     X                        1
63142          63143  S92000003  ...                     X                        2
63152          63153  S92000003  ...                     X                        2
63159          63160  S92000003  ...                     X                        2
63163          63164  S92000003  ...                     X                        1
63168          63169  S92000003  ...                     X                        2
63171          63172  S92000003  ...                     X                        2
63235          63236  S92000003  ...                     X                        4
63241          63242  S92000003  ...                     X                        3
63295          63296  S92000003  ...                     X                        2
63317          63318  S92000003  ...                     X                        2
63350          63351  S92000003  ...                     X                        4
63366          63367  S92000003  ...                     X                        2
63383          63384  S92000003  ...                     X                        3

[21 rows x 17 columns]
2024-12-02 18:49:13,363 - INFO - Rule 1: Found 21 rows to delete, saved to data/rule_1_deleted_data.csv
2024-12-02 18:49:13,364 - INFO - Rule 2: No rows to delete
2024-12-02 18:49:13,370 - INFO - Rule 3: Found 8 rows to delete, saved to data/rule_3_deleted_data.csv
2024-12-02 18:49:13,376 - INFO - Rule 4: Found 16 rows to delete, saved to data/rule_4_deleted_data.csv
2024-12-02 18:49:13,378 - INFO - Rule 5: No rows to delete
2024-12-02 18:49:13,383 - INFO - Rule 6: Found 8 rows to delete, saved to data/rule_6_deleted_data.csv
2024-12-02 18:49:13,387 - INFO - =====validate_data_ranges:=====
2024-12-02 18:49:13,413 - INFO - 
Unique categories and counts per column:
2024-12-02 18:49:13,413 - INFO - residence_type: ['P', 'C'] (Total unique: 2)
2024-12-02 18:49:13,413 - INFO - family_composition: ['0', '4', '1', '3', '2', '5', 'X'] (Total unique: 7)
2024-12-02 18:49:13,413 - INFO - sex: [1, 2] (Total unique: 2)
2024-12-02 18:49:13,413 - INFO - age: [1, 2, 3, 4, 5, 6, 7, 8] (Total unique: 8)
2024-12-02 18:49:13,413 - INFO - marital_status: [1, 2, 3, 4, 5] (Total unique: 5)
2024-12-02 18:49:13,413 - INFO - student: [1, 2] (Total unique: 2)
2024-12-02 18:49:13,413 - INFO - country_of_birth: [1, 2] (Total unique: 2)
2024-12-02 18:49:13,413 - INFO - health: [1, 2, 3, 4] (Total unique: 4)
2024-12-02 18:49:13,413 - INFO - ethnic_group: [1, 3, 4] (Total unique: 3)
2024-12-02 18:49:13,413 - INFO - religion: [1, 2, 3, 4, 5, 6, 8, 9] (Total unique: 8)
2024-12-02 18:49:13,413 - INFO - economic_activity: ['8', '4', '1', '9', '3', '6', '7', '5', '2', 'X'] (Total unique: 10)
2024-12-02 18:49:13,413 - INFO - occupation: ['8', '4', '1', '9', '3', '6', '7', '2', '5', 'X'] (Total unique: 10)
2024-12-02 18:49:13,413 - INFO - industry: ['10', '8', '4', '1', '9', '3', '6', '11', '2', '5', '7', '12', 'X', '13'] (Total unique: 14)
2024-12-02 18:49:13,413 - INFO - hours_worked_per_week: ['4', '1', '3', '2', 'X'] (Total unique: 5)
2024-12-02 18:49:13,413 - INFO - approximate_social_grade: ['4', '1', '3', '2', 'X'] (Total unique: 5)
2024-12-02 18:49:13,413 - INFO - 
All data ranges validated.
2024-12-02 18:49:13,413 - INFO - =====Verifying 'record_number' uniqueness:=====
2024-12-02 18:49:13,413 - INFO - Columns in batch: ['record_number', 'region', 'residence_type', 'family_composition', 'sex', 'age', 'marital_status', 'student', 'country_of_birth', 'health', 'ethnic_group', 'religion', 'economic_activity', 'occupation', 'industry', 'hours_worked_per_week', 'approximate_social_grade']
2024-12-02 18:49:13,414 - INFO - Record_Number is unique.
2024-12-02 18:49:13,415 - INFO - 'record_number' column reset.
2024-12-02 18:49:13,419 - INFO - Batch 8 cleaned and saved.
2024-12-02 18:49:13,422 - INFO - Progress saved to /cs/home/sz92/Documents/CS5002/P3/code/progress.json.
2024-12-02 18:49:13,422 - INFO - Data cleaning process completed. Total rows processed: 63388
2024-12-02 18:49:13,422 - INFO - Rows to drop: 5297
2024-12-02 18:49:13,422 - INFO - Cleaned data saved to ../data/output.csv
2024-12-02 18:49:13,423 - INFO - Progress file removed. Data processing complete.
2024-12-02 18:49:13,977 - INFO - Data clean code test passed. Congratulations! Result deatils in log/data_cleaning.log
2024-12-02 18:49:14,007 - INFO - =====Checking data types:=====
2024-12-02 18:49:14,015 - INFO - Batch info:
None
2024-12-02 18:49:14,050 - INFO - =====Checking for missing value:=====
2024-12-02 18:49:14,053 - INFO - No missing values detected.
2024-12-02 18:49:14,053 - INFO - =====Checking for duplicate rows:=====
2024-12-02 18:49:14,058 - INFO - No duplicate rows detected.
2024-12-02 18:49:14,058 - INFO - =====Verifying 'record_number' uniqueness:=====
2024-12-02 18:49:14,058 - INFO - Columns in batch: ['record_number', 'region', 'residence_type', 'family_composition', 'sex', 'age', 'marital_status', 'student', 'country_of_birth', 'health', 'ethnic_group', 'religion', 'economic_activity', 'occupation', 'industry', 'hours_worked_per_week', 'approximate_social_grade']
2024-12-02 18:49:14,058 - INFO - Record_Number is unique.
2024-12-02 18:49:14,059 - INFO - =====validate_data_ranges:=====
2024-12-02 18:49:14,128 - INFO - 
Unique categories and counts per column:
2024-12-02 18:49:14,128 - INFO - residence_type: ['P', 'C'] (Total unique: 2)
2024-12-02 18:49:14,128 - INFO - family_composition: ['0', '4', '1', '3', '2', '5', 'X'] (Total unique: 7)
2024-12-02 18:49:14,128 - INFO - sex: [1, 2] (Total unique: 2)
2024-12-02 18:49:14,128 - INFO - age: [1, 2, 3, 4, 5, 6, 7, 8] (Total unique: 8)
2024-12-02 18:49:14,128 - INFO - marital_status: [1, 2, 3, 4, 5] (Total unique: 5)
2024-12-02 18:49:14,128 - INFO - student: [1, 2] (Total unique: 2)
2024-12-02 18:49:14,128 - INFO - country_of_birth: [1, 2] (Total unique: 2)
2024-12-02 18:49:14,128 - INFO - health: [1, 2, 3, 4, 5] (Total unique: 5)
2024-12-02 18:49:14,128 - INFO - ethnic_group: [1, 2, 3, 4, 5, 6] (Total unique: 6)
2024-12-02 18:49:14,128 - INFO - religion: [1, 2, 3, 4, 5, 6, 7, 8, 9] (Total unique: 9)
2024-12-02 18:49:14,128 - INFO - economic_activity: ['8', '4', '1', '9', '3', '6', '7', '2', '5', 'X'] (Total unique: 10)
2024-12-02 18:49:14,128 - INFO - occupation: ['8', '4', '1', '9', '3', '6', '2', '5', '7', 'X'] (Total unique: 10)
2024-12-02 18:49:14,128 - INFO - industry: ['10', '8', '4', '1', '9', '3', '6', '11', '2', '5', '7', '12', 'X', '13'] (Total unique: 14)
2024-12-02 18:49:14,128 - INFO - hours_worked_per_week: ['4', '1', '3', '2', 'X'] (Total unique: 5)
2024-12-02 18:49:14,128 - INFO - approximate_social_grade: ['4', '1', '3', '2', 'X'] (Total unique: 5)
2024-12-02 18:49:14,128 - INFO - 
All data ranges validated.
2024-12-02 18:49:14,128 - INFO - Starting data cleaning process...
2024-12-02 18:49:14,148 - INFO - Processing batch 1...
2024-12-02 18:49:14,148 - INFO - =====Checking for missing value:=====
2024-12-02 18:49:14,149 - INFO - No missing values detected.
2024-12-02 18:49:14,149 - INFO - =====Checking for duplicate rows:=====
2024-12-02 18:49:14,149 - INFO - No duplicate rows detected.
2024-12-02 19:02:55,329 - WARNING - Progress file progress.json not found. Starting from the beginning.
2024-12-02 19:02:55,395 - INFO - Loaded data from row 0.
2024-12-02 19:02:55,395 - INFO - Columns in DataFrame: ['record_number', 'region', 'residence_type', 'family_composition', 'sex', 'age', 'marital_status', 'student', 'country_of_birth', 'health', 'ethnic_group', 'religion', 'economic_activity', 'occupation', 'industry', 'hours_worked_per_week', 'approximate_social_grade']
2024-12-02 19:02:55,395 - WARNING - Progress file progress.json not found. Starting from the beginning.
2024-12-02 19:02:55,404 - INFO - =====Checking data types:=====
2024-12-02 19:02:55,410 - INFO - Batch info:
None
2024-12-02 19:02:55,445 - INFO - =====Checking for missing value:=====
2024-12-02 19:02:55,449 - INFO - No missing values detected.
2024-12-02 19:02:55,449 - INFO - =====Checking for duplicate rows:=====
2024-12-02 19:02:55,453 - INFO - No duplicate rows detected.
2024-12-02 19:02:55,453 - INFO - =====Verifying 'record_number' uniqueness:=====
2024-12-02 19:02:55,453 - INFO - Columns in batch: ['record_number', 'region', 'residence_type', 'family_composition', 'sex', 'age', 'marital_status', 'student', 'country_of_birth', 'health', 'ethnic_group', 'religion', 'economic_activity', 'occupation', 'industry', 'hours_worked_per_week', 'approximate_social_grade']
2024-12-02 19:02:55,454 - INFO - Record_Number is unique.
2024-12-02 19:02:55,454 - INFO - =====validate_data_ranges:=====
2024-12-02 19:02:55,551 - INFO - 
Unique categories and counts per column:
2024-12-02 19:02:55,551 - INFO - residence_type: ['C', 'P'] (Total unique: 2)
2024-12-02 19:02:55,551 - INFO - family_composition: ['1', '3', '0', '4', 'X', '5', '2'] (Total unique: 7)
2024-12-02 19:02:55,552 - INFO - sex: [1, 2] (Total unique: 2)
2024-12-02 19:02:55,552 - INFO - age: [1, 2, 3, 4, 5, 6, 7, 8] (Total unique: 8)
2024-12-02 19:02:55,552 - INFO - marital_status: [1, 2, 3, 4, 5] (Total unique: 5)
2024-12-02 19:02:55,552 - INFO - student: [1, 2] (Total unique: 2)
2024-12-02 19:02:55,552 - INFO - country_of_birth: [1, 2] (Total unique: 2)
2024-12-02 19:02:55,552 - INFO - health: [1, 2, 3, 4, 5] (Total unique: 5)
2024-12-02 19:02:55,552 - INFO - ethnic_group: [1, 2, 3, 4, 5, 6] (Total unique: 6)
2024-12-02 19:02:55,552 - INFO - religion: [1, 2, 3, 4, 5, 6, 7, 8, 9] (Total unique: 9)
2024-12-02 19:02:55,552 - INFO - economic_activity: ['1', '3', '6', '4', '7', '8', 'X', '9', '5', '2'] (Total unique: 10)
2024-12-02 19:02:55,552 - INFO - occupation: ['1', '3', '6', '4', '8', '7', 'X', '9', '5', '2'] (Total unique: 10)
2024-12-02 19:02:55,552 - INFO - industry: ['1', '10', '3', '6', '4', '8', '7', '12', 'X', '13', '9', '5', '2', '11'] (Total unique: 14)
2024-12-02 19:02:55,552 - INFO - hours_worked_per_week: ['1', '3', '4', 'X', '2'] (Total unique: 5)
2024-12-02 19:02:55,552 - INFO - approximate_social_grade: ['1', '3', '4', 'X', '2'] (Total unique: 5)
2024-12-02 19:02:55,552 - INFO - 
All data ranges validated.
2024-12-02 19:02:55,552 - INFO - Starting data cleaning process...
2024-12-02 19:02:55,562 - INFO - Processing batch 1...
2024-12-02 19:02:55,562 - INFO - =====Checking for missing value:=====
2024-12-02 19:02:55,565 - INFO - No missing values detected.
2024-12-02 19:02:55,565 - INFO - =====Checking for duplicate rows:=====
2024-12-02 19:02:55,570 - INFO - No duplicate rows detected.
2024-12-02 19:02:55,582 - INFO -       record_number     region residence_type family_composition  sex  age  marital_status  ...  ethnic_group  religion  economic_activity  occupation  industry hours_worked_per_week approximate_social_grade
20               21  S92000003              P                  5    2    2               1  ...             1         2                  6           X         X                     X                        2
47               48  S92000003              P                  0    1    2               1  ...             1         1                  6           X         X                     X                        2
48               49  S92000003              P                  0    1    3               2  ...             4         2                  6           2         8                     X                        2
85               86  S92000003              P                  1    1    2               1  ...             1         2                  6           X         X                     X                        1
88               89  S92000003              P                  1    1    3               2  ...             1         2                  6           2        10                     X                        2
...             ...        ...            ...                ...  ...  ...             ...  ...           ...       ...                ...         ...       ...                   ...                      ...
8818           8819  S92000003              P                  1    2    2               1  ...             1         2                  6           X         X                     X                        4
8875           8876  S92000003              P                  1    2    2               1  ...             1         1                  6           X         X                     X                        2
8886           8887  S92000003              P                  4    2    2               1  ...             1         1                  6           X         X                     X                        1
8906           8907  S92000003              P                  4    1    2               1  ...             1         2                  6           X         X                     X                        4
8930           8931  S92000003              P                  1    1    2               1  ...             1         1                  6           7         4                     X                        2

[372 rows x 17 columns]
2024-12-02 19:02:55,614 - INFO - Rule 1: Found 372 rows to delete, saved to data/rule_1_deleted_data.csv
2024-12-02 19:02:55,619 - INFO - Rule 2: No rows to delete
2024-12-02 19:02:55,631 - INFO - Rule 3: Found 123 rows to delete, saved to data/rule_3_deleted_data.csv
2024-12-02 19:02:55,650 - INFO - Rule 4: Found 327 rows to delete, saved to data/rule_4_deleted_data.csv
2024-12-02 19:02:55,655 - INFO - Rule 5: No rows to delete
2024-12-02 19:02:55,666 - INFO - Rule 6: Found 123 rows to delete, saved to data/rule_6_deleted_data.csv
2024-12-02 19:02:55,671 - INFO - =====validate_data_ranges:=====
2024-12-02 19:02:55,753 - INFO - 
Unique categories and counts per column:
2024-12-02 19:02:55,753 - INFO - residence_type: ['C', 'P'] (Total unique: 2)
2024-12-02 19:02:55,753 - INFO - family_composition: ['1', '3', '0', '4', 'X', '5', '2'] (Total unique: 7)
2024-12-02 19:02:55,753 - INFO - sex: [1, 2] (Total unique: 2)
2024-12-02 19:02:55,753 - INFO - age: [1, 2, 3, 4, 5, 6, 7, 8] (Total unique: 8)
2024-12-02 19:02:55,753 - INFO - marital_status: [1, 2, 3, 4, 5] (Total unique: 5)
2024-12-02 19:02:55,753 - INFO - student: [1, 2] (Total unique: 2)
2024-12-02 19:02:55,753 - INFO - country_of_birth: [1, 2] (Total unique: 2)
2024-12-02 19:02:55,753 - INFO - health: [1, 2, 3, 4, 5] (Total unique: 5)
2024-12-02 19:02:55,753 - INFO - ethnic_group: [1, 2, 3, 4, 5, 6] (Total unique: 6)
2024-12-02 19:02:55,753 - INFO - religion: [1, 2, 3, 4, 5, 6, 7, 8, 9] (Total unique: 9)
2024-12-02 19:02:55,753 - INFO - economic_activity: ['1', '3', '6', '4', '7', '8', 'X', '9', '5', '2'] (Total unique: 10)
2024-12-02 19:02:55,753 - INFO - occupation: ['1', '3', '6', '4', '8', '7', 'X', '9', '5', '2'] (Total unique: 10)
2024-12-02 19:02:55,753 - INFO - industry: ['1', '10', '3', '6', '4', '8', '7', '12', 'X', '13', '9', '5', '2', '11'] (Total unique: 14)
2024-12-02 19:02:55,753 - INFO - hours_worked_per_week: ['1', '3', '4', 'X', '2'] (Total unique: 5)
2024-12-02 19:02:55,753 - INFO - approximate_social_grade: ['1', '3', '4', 'X', '2'] (Total unique: 5)
2024-12-02 19:02:55,753 - INFO - 
All data ranges validated.
2024-12-02 19:02:55,753 - INFO - =====Verifying 'record_number' uniqueness:=====
2024-12-02 19:02:55,753 - INFO - Columns in batch: ['record_number', 'region', 'residence_type', 'family_composition', 'sex', 'age', 'marital_status', 'student', 'country_of_birth', 'health', 'ethnic_group', 'religion', 'economic_activity', 'occupation', 'industry', 'hours_worked_per_week', 'approximate_social_grade']
2024-12-02 19:02:55,754 - INFO - Record_Number is unique.
2024-12-02 19:02:55,755 - INFO - 'record_number' column reset.
2024-12-02 19:02:55,783 - INFO - Batch 1 cleaned and saved.
2024-12-02 19:02:55,786 - INFO - Progress saved to /cs/home/sz92/Documents/CS5002/P3/code/progress.json.
2024-12-02 19:02:55,797 - INFO - Processing batch 2...
2024-12-02 19:02:55,797 - INFO - =====Checking for missing value:=====
2024-12-02 19:02:55,800 - INFO - No missing values detected.
2024-12-02 19:02:55,801 - INFO - =====Checking for duplicate rows:=====
2024-12-02 19:02:55,805 - INFO - No duplicate rows detected.
2024-12-02 19:02:55,816 - INFO -        record_number     region residence_type family_composition  sex  age  marital_status  ...  ethnic_group  religion  economic_activity  occupation  industry hours_worked_per_week approximate_social_grade
9004            9005  S92000003              P                  0    2    2               1  ...             1         9                  6           8         4                     X                        2
9007            9008  S92000003              P                  0    1    3               1  ...             1         1                  6           X         X                     X                        2
9010            9011  S92000003              P                  0    2    2               1  ...             3         1                  6           9         5                     X                        2
9014            9015  S92000003              P                  0    1    2               1  ...             1         1                  6           2         6                     X                        2
9026            9027  S92000003              P                  2    2    3               1  ...             1         1                  6           9         5                     X                        2
...              ...        ...            ...                ...  ...  ...             ...  ...           ...       ...                ...         ...       ...                   ...                      ...
17904          17905  S92000003              P                  4    2    2               1  ...             1         1                  6           X         X                     X                        2
17952          17953  S92000003              P                  1    2    2               1  ...             1         1                  6           X         X                     X                        2
17968          17969  S92000003              P                  1    1    2               1  ...             1         2                  6           3         8                     X                        1
17976          17977  S92000003              P                  1    1    2               1  ...             1         2                  6           X         X                     X                        2
17981          17982  S92000003              P                  4    2    2               1  ...             1         1                  6           X         X                     X                        3

[340 rows x 17 columns]
2024-12-02 19:02:55,825 - INFO - Rule 1: Found 340 rows to delete, saved to data/rule_1_deleted_data.csv
2024-12-02 19:02:55,826 - INFO - Rule 2: No rows to delete
2024-12-02 19:02:55,831 - INFO - Rule 3: Found 115 rows to delete, saved to data/rule_3_deleted_data.csv
2024-12-02 19:02:55,838 - INFO - Rule 4: Found 344 rows to delete, saved to data/rule_4_deleted_data.csv
2024-12-02 19:02:55,842 - INFO - Rule 5: No rows to delete
2024-12-02 19:02:55,852 - INFO - Rule 6: Found 115 rows to delete, saved to data/rule_6_deleted_data.csv
2024-12-02 19:02:55,856 - INFO - =====validate_data_ranges:=====
2024-12-02 19:02:55,935 - INFO - 
Unique categories and counts per column:
2024-12-02 19:02:55,935 - INFO - residence_type: ['C', 'P'] (Total unique: 2)
2024-12-02 19:02:55,935 - INFO - family_composition: ['1', '3', '0', '4', 'X', '5', '2'] (Total unique: 7)
2024-12-02 19:02:55,935 - INFO - sex: [1, 2] (Total unique: 2)
2024-12-02 19:02:55,935 - INFO - age: [1, 2, 3, 4, 5, 6, 7, 8] (Total unique: 8)
2024-12-02 19:02:55,935 - INFO - marital_status: [1, 2, 3, 4, 5] (Total unique: 5)
2024-12-02 19:02:55,936 - INFO - student: [1, 2] (Total unique: 2)
2024-12-02 19:02:55,936 - INFO - country_of_birth: [1, 2] (Total unique: 2)
2024-12-02 19:02:55,936 - INFO - health: [1, 2, 3, 4, 5] (Total unique: 5)
2024-12-02 19:02:55,936 - INFO - ethnic_group: [1, 2, 3, 4, 5, 6] (Total unique: 6)
2024-12-02 19:02:55,936 - INFO - religion: [1, 2, 3, 4, 5, 6, 7, 8, 9] (Total unique: 9)
2024-12-02 19:02:55,936 - INFO - economic_activity: ['1', '3', '6', '4', '7', '8', 'X', '9', '5', '2'] (Total unique: 10)
2024-12-02 19:02:55,936 - INFO - occupation: ['1', '3', '6', '4', '8', '7', 'X', '9', '5', '2'] (Total unique: 10)
2024-12-02 19:02:55,936 - INFO - industry: ['1', '10', '3', '6', '4', '8', '7', '12', 'X', '13', '9', '5', '2', '11'] (Total unique: 14)
2024-12-02 19:02:55,936 - INFO - hours_worked_per_week: ['1', '3', '4', 'X', '2'] (Total unique: 5)
2024-12-02 19:02:55,936 - INFO - approximate_social_grade: ['1', '3', '4', 'X', '2'] (Total unique: 5)
2024-12-02 19:02:55,936 - INFO - 
All data ranges validated.
2024-12-02 19:02:55,936 - INFO - =====Verifying 'record_number' uniqueness:=====
2024-12-02 19:02:55,936 - INFO - Columns in batch: ['record_number', 'region', 'residence_type', 'family_composition', 'sex', 'age', 'marital_status', 'student', 'country_of_birth', 'health', 'ethnic_group', 'religion', 'economic_activity', 'occupation', 'industry', 'hours_worked_per_week', 'approximate_social_grade']
2024-12-02 19:02:55,936 - INFO - Record_Number is unique.
2024-12-02 19:02:55,938 - INFO - 'record_number' column reset.
2024-12-02 19:02:55,977 - INFO - Batch 2 cleaned and saved.
2024-12-02 19:02:55,980 - INFO - Progress saved to /cs/home/sz92/Documents/CS5002/P3/code/progress.json.
2024-12-02 19:02:55,996 - INFO - Processing batch 3...
2024-12-02 19:02:55,996 - INFO - =====Checking for missing value:=====
2024-12-02 19:02:56,000 - INFO - No missing values detected.
2024-12-02 19:02:56,001 - INFO - =====Checking for duplicate rows:=====
2024-12-02 19:02:56,005 - INFO - No duplicate rows detected.
2024-12-02 19:02:56,018 - INFO -        record_number     region residence_type family_composition  sex  age  marital_status  ...  ethnic_group  religion  economic_activity  occupation  industry hours_worked_per_week approximate_social_grade
18012          18013  S92000003              P                  2    1    2               1  ...             1         2                  6           X         X                     X                        3
18032          18033  S92000003              P                  1    1    3               1  ...             1         1                  6           9         4                     X                        3
18058          18059  S92000003              P                  1    1    2               1  ...             1         2                  6           X         X                     X                        4
18131          18132  S92000003              P                  1    1    2               1  ...             1         9                  6           X         X                     X                        1
18142          18143  S92000003              P                  0    2    5               1  ...             1         2                  6           3        13                     X                        2
...              ...        ...            ...                ...  ...  ...             ...  ...           ...       ...                ...         ...       ...                   ...                      ...
26889          26890  S92000003              P                  1    1    2               1  ...             1         2                  6           9        12                     X                        2
26905          26906  S92000003              P                  4    2    2               1  ...             1         1                  6           X         X                     X                        2
26919          26920  S92000003              P                  1    1    2               1  ...             1         2                  6           X         X                     X                        3
26928          26929  S92000003              P                  1    1    2               1  ...             1         2                  6           X         X                     X                        3
26982          26983  S92000003              P                  4    2    6               5  ...             1         9                  6           5         3                     X                        2

[371 rows x 17 columns]
2024-12-02 19:02:56,022 - INFO - Rule 1: Found 371 rows to delete, saved to data/rule_1_deleted_data.csv
2024-12-02 19:02:56,025 - INFO - Rule 2: No rows to delete
2024-12-02 19:02:56,034 - INFO - Rule 3: Found 124 rows to delete, saved to data/rule_3_deleted_data.csv
2024-12-02 19:02:56,043 - INFO - Rule 4: Found 359 rows to delete, saved to data/rule_4_deleted_data.csv
2024-12-02 19:02:56,046 - INFO - Rule 5: No rows to delete
2024-12-02 19:02:56,052 - INFO - Rule 6: Found 124 rows to delete, saved to data/rule_6_deleted_data.csv
2024-12-02 19:02:56,058 - INFO - =====validate_data_ranges:=====
2024-12-02 19:02:56,142 - INFO - 
Unique categories and counts per column:
2024-12-02 19:02:56,142 - INFO - residence_type: ['C', 'P'] (Total unique: 2)
2024-12-02 19:02:56,142 - INFO - family_composition: ['1', '3', '0', '4', 'X', '5', '2'] (Total unique: 7)
2024-12-02 19:02:56,142 - INFO - sex: [1, 2] (Total unique: 2)
2024-12-02 19:02:56,142 - INFO - age: [1, 2, 3, 4, 5, 6, 7, 8] (Total unique: 8)
2024-12-02 19:02:56,142 - INFO - marital_status: [1, 2, 3, 4, 5] (Total unique: 5)
2024-12-02 19:02:56,142 - INFO - student: [1, 2] (Total unique: 2)
2024-12-02 19:02:56,142 - INFO - country_of_birth: [1, 2] (Total unique: 2)
2024-12-02 19:02:56,142 - INFO - health: [1, 2, 3, 4, 5] (Total unique: 5)
2024-12-02 19:02:56,142 - INFO - ethnic_group: [1, 2, 3, 4, 5, 6] (Total unique: 6)
2024-12-02 19:02:56,142 - INFO - religion: [1, 2, 3, 4, 5, 6, 7, 8, 9] (Total unique: 9)
2024-12-02 19:02:56,142 - INFO - economic_activity: ['1', '3', '6', '4', '8', '7', 'X', '9', '5', '2'] (Total unique: 10)
2024-12-02 19:02:56,143 - INFO - occupation: ['1', '3', '6', '4', '7', '8', 'X', '9', '5', '2'] (Total unique: 10)
2024-12-02 19:02:56,143 - INFO - industry: ['1', '10', '3', '6', '4', '7', '8', '12', 'X', '13', '9', '5', '2', '11'] (Total unique: 14)
2024-12-02 19:02:56,143 - INFO - hours_worked_per_week: ['1', '3', '4', 'X', '2'] (Total unique: 5)
2024-12-02 19:02:56,143 - INFO - approximate_social_grade: ['1', '3', '4', 'X', '2'] (Total unique: 5)
2024-12-02 19:02:56,143 - INFO - 
All data ranges validated.
2024-12-02 19:02:56,143 - INFO - =====Verifying 'record_number' uniqueness:=====
2024-12-02 19:02:56,143 - INFO - Columns in batch: ['record_number', 'region', 'residence_type', 'family_composition', 'sex', 'age', 'marital_status', 'student', 'country_of_birth', 'health', 'ethnic_group', 'religion', 'economic_activity', 'occupation', 'industry', 'hours_worked_per_week', 'approximate_social_grade']
2024-12-02 19:02:56,143 - INFO - Record_Number is unique.
2024-12-02 19:02:56,145 - INFO - 'record_number' column reset.
2024-12-02 19:02:56,172 - INFO - Batch 3 cleaned and saved.
2024-12-02 19:02:56,175 - INFO - Progress saved to /cs/home/sz92/Documents/CS5002/P3/code/progress.json.
2024-12-02 19:02:56,184 - INFO - Processing batch 4...
2024-12-02 19:02:56,184 - INFO - =====Checking for missing value:=====
2024-12-02 19:02:56,187 - INFO - No missing values detected.
2024-12-02 19:02:56,187 - INFO - =====Checking for duplicate rows:=====
2024-12-02 19:02:56,192 - INFO - No duplicate rows detected.
2024-12-02 19:02:56,204 - INFO -        record_number     region residence_type family_composition  sex  age  marital_status  ...  ethnic_group  religion  economic_activity  occupation  industry hours_worked_per_week approximate_social_grade
27017          27018  S92000003              P                  1    1    2               1  ...             1         1                  6           7         4                     X                        1
27085          27086  S92000003              P                  2    2    3               1  ...             1         1                  6           2        11                     X                        4
27104          27105  S92000003              P                  4    2    3               1  ...             1         2                  6           7         4                     X                        2
27187          27188  S92000003              P                  1    2    2               1  ...             1         2                  6           7         4                     X                        2
27206          27207  S92000003              P                  1    2    4               2  ...             1         2                  6           4        10                     X                        1
...              ...        ...            ...                ...  ...  ...             ...  ...           ...       ...                ...         ...       ...                   ...                      ...
35871          35872  S92000003              P                  4    1    2               1  ...             1         9                  6           X         X                     X                        2
35927          35928  S92000003              P                  1    2    2               1  ...             1         2                  6           X         X                     X                        2
35944          35945  S92000003              P                  1    2    2               1  ...             1         2                  6           X         X                     X                        1
35947          35948  S92000003              P                  1    2    2               1  ...             1         2                  6           X         X                     X                        1
35989          35990  S92000003              P                  4    2    2               1  ...             1         1                  6           1         4                     X                        2

[327 rows x 17 columns]
2024-12-02 19:02:56,209 - INFO - Rule 1: Found 327 rows to delete, saved to data/rule_1_deleted_data.csv
2024-12-02 19:02:56,210 - INFO - Rule 2: No rows to delete
2024-12-02 19:02:56,214 - INFO - Rule 3: Found 118 rows to delete, saved to data/rule_3_deleted_data.csv
2024-12-02 19:02:56,220 - INFO - Rule 4: Found 317 rows to delete, saved to data/rule_4_deleted_data.csv
2024-12-02 19:02:56,221 - INFO - Rule 5: No rows to delete
2024-12-02 19:02:56,226 - INFO - Rule 6: Found 118 rows to delete, saved to data/rule_6_deleted_data.csv
2024-12-02 19:02:56,228 - INFO - =====validate_data_ranges:=====
2024-12-02 19:02:56,298 - INFO - 
Unique categories and counts per column:
2024-12-02 19:02:56,298 - INFO - residence_type: ['C', 'P'] (Total unique: 2)
2024-12-02 19:02:56,298 - INFO - family_composition: ['1', '3', '0', '4', 'X', '5', '2'] (Total unique: 7)
2024-12-02 19:02:56,298 - INFO - sex: [1, 2] (Total unique: 2)
2024-12-02 19:02:56,298 - INFO - age: [1, 2, 3, 4, 5, 6, 7, 8] (Total unique: 8)
2024-12-02 19:02:56,298 - INFO - marital_status: [1, 2, 3, 4, 5] (Total unique: 5)
2024-12-02 19:02:56,298 - INFO - student: [1, 2] (Total unique: 2)
2024-12-02 19:02:56,298 - INFO - country_of_birth: [1, 2] (Total unique: 2)
2024-12-02 19:02:56,298 - INFO - health: [1, 2, 3, 4, 5] (Total unique: 5)
2024-12-02 19:02:56,298 - INFO - ethnic_group: [1, 2, 3, 4, 5, 6] (Total unique: 6)
2024-12-02 19:02:56,298 - INFO - religion: [1, 2, 3, 4, 5, 6, 7, 8, 9] (Total unique: 9)
2024-12-02 19:02:56,298 - INFO - economic_activity: ['1', '3', '6', '4', '8', '7', 'X', '9', '5', '2'] (Total unique: 10)
2024-12-02 19:02:56,298 - INFO - occupation: ['1', '3', '6', '4', '7', '8', 'X', '9', '5', '2'] (Total unique: 10)
2024-12-02 19:02:56,298 - INFO - industry: ['1', '10', '3', '6', '4', '7', '8', '12', 'X', '13', '9', '5', '2', '11'] (Total unique: 14)
2024-12-02 19:02:56,298 - INFO - hours_worked_per_week: ['1', '3', '4', 'X', '2'] (Total unique: 5)
2024-12-02 19:02:56,298 - INFO - approximate_social_grade: ['1', '3', '4', 'X', '2'] (Total unique: 5)
2024-12-02 19:02:56,298 - INFO - 
All data ranges validated.
2024-12-02 19:02:56,298 - INFO - =====Verifying 'record_number' uniqueness:=====
2024-12-02 19:02:56,298 - INFO - Columns in batch: ['record_number', 'region', 'residence_type', 'family_composition', 'sex', 'age', 'marital_status', 'student', 'country_of_birth', 'health', 'ethnic_group', 'religion', 'economic_activity', 'occupation', 'industry', 'hours_worked_per_week', 'approximate_social_grade']
2024-12-02 19:02:56,299 - INFO - Record_Number is unique.
2024-12-02 19:02:56,300 - INFO - 'record_number' column reset.
2024-12-02 19:02:56,328 - INFO - Batch 4 cleaned and saved.
2024-12-02 19:02:56,331 - INFO - Progress saved to /cs/home/sz92/Documents/CS5002/P3/code/progress.json.
2024-12-02 19:02:56,341 - INFO - Processing batch 5...
2024-12-02 19:02:56,341 - INFO - =====Checking for missing value:=====
2024-12-02 19:02:56,345 - INFO - No missing values detected.
2024-12-02 19:02:56,345 - INFO - =====Checking for duplicate rows:=====
2024-12-02 19:02:56,350 - INFO - No duplicate rows detected.
2024-12-02 19:02:56,362 - INFO -        record_number     region residence_type family_composition  sex  age  marital_status  ...  ethnic_group  religion  economic_activity  occupation  industry hours_worked_per_week approximate_social_grade
36006          36007  S92000003              P                  1    2    2               1  ...             1         1                  6           X         X                     X                        2
36017          36018  S92000003              P                  1    2    2               1  ...             1         1                  6           X         X                     X                        4
36074          36075  S92000003              P                  4    1    2               1  ...             1         2                  6           X         X                     X                        2
36124          36125  S92000003              P                  4    2    2               1  ...             1         1                  6           9         5                     X                        2
36127          36128  S92000003              P                  1    1    2               1  ...             1         2                  6           X         X                     X                        2
...              ...        ...            ...                ...  ...  ...             ...  ...           ...       ...                ...         ...       ...                   ...                      ...
44863          44864  S92000003              P                  0    1    3               1  ...             1         1                  6           9         5                     X                        2
44870          44871  S92000003              P                  2    2    2               1  ...             1         2                  6           7         4                     X                        3
44937          44938  S92000003              P                  4    2    2               1  ...             1         9                  6           X         X                     X                        2
44986          44987  S92000003              P                  4    1    2               1  ...             1         2                  6           X         X                     X                        2
44996          44997  S92000003              P                  1    1    2               1  ...             1         2                  6           X         X                     X                        3

[377 rows x 17 columns]
2024-12-02 19:02:56,367 - INFO - Rule 1: Found 377 rows to delete, saved to data/rule_1_deleted_data.csv
2024-12-02 19:02:56,370 - INFO - Rule 2: No rows to delete
2024-12-02 19:02:56,377 - INFO - Rule 3: Found 124 rows to delete, saved to data/rule_3_deleted_data.csv
2024-12-02 19:02:56,389 - INFO - Rule 4: Found 354 rows to delete, saved to data/rule_4_deleted_data.csv
2024-12-02 19:02:56,392 - INFO - Rule 5: No rows to delete
2024-12-02 19:02:56,400 - INFO - Rule 6: Found 124 rows to delete, saved to data/rule_6_deleted_data.csv
2024-12-02 19:02:56,403 - INFO - =====validate_data_ranges:=====
2024-12-02 19:02:56,481 - INFO - 
Unique categories and counts per column:
2024-12-02 19:02:56,481 - INFO - residence_type: ['C', 'P'] (Total unique: 2)
2024-12-02 19:02:56,481 - INFO - family_composition: ['1', '3', '0', '4', 'X', '5', '2'] (Total unique: 7)
2024-12-02 19:02:56,481 - INFO - sex: [1, 2] (Total unique: 2)
2024-12-02 19:02:56,481 - INFO - age: [1, 2, 3, 4, 5, 6, 7, 8] (Total unique: 8)
2024-12-02 19:02:56,481 - INFO - marital_status: [1, 2, 3, 4, 5] (Total unique: 5)
2024-12-02 19:02:56,481 - INFO - student: [1, 2] (Total unique: 2)
2024-12-02 19:02:56,481 - INFO - country_of_birth: [1, 2] (Total unique: 2)
2024-12-02 19:02:56,481 - INFO - health: [1, 2, 3, 4, 5] (Total unique: 5)
2024-12-02 19:02:56,481 - INFO - ethnic_group: [1, 2, 3, 4, 5, 6] (Total unique: 6)
2024-12-02 19:02:56,481 - INFO - religion: [1, 2, 3, 4, 5, 6, 7, 8, 9] (Total unique: 9)
2024-12-02 19:02:56,481 - INFO - economic_activity: ['1', '3', '6', '4', '8', '7', 'X', '9', '5', '2'] (Total unique: 10)
2024-12-02 19:02:56,481 - INFO - occupation: ['1', '3', '6', '4', '8', '7', 'X', '9', '5', '2'] (Total unique: 10)
2024-12-02 19:02:56,481 - INFO - industry: ['1', '10', '3', '6', '4', '8', '7', '12', 'X', '13', '9', '5', '2', '11'] (Total unique: 14)
2024-12-02 19:02:56,481 - INFO - hours_worked_per_week: ['1', '3', '4', 'X', '2'] (Total unique: 5)
2024-12-02 19:02:56,481 - INFO - approximate_social_grade: ['1', '3', '4', 'X', '2'] (Total unique: 5)
2024-12-02 19:02:56,481 - INFO - 
All data ranges validated.
2024-12-02 19:02:56,481 - INFO - =====Verifying 'record_number' uniqueness:=====
2024-12-02 19:02:56,481 - INFO - Columns in batch: ['record_number', 'region', 'residence_type', 'family_composition', 'sex', 'age', 'marital_status', 'student', 'country_of_birth', 'health', 'ethnic_group', 'religion', 'economic_activity', 'occupation', 'industry', 'hours_worked_per_week', 'approximate_social_grade']
2024-12-02 19:02:56,482 - INFO - Record_Number is unique.
2024-12-02 19:02:56,483 - INFO - 'record_number' column reset.
2024-12-02 19:02:56,509 - INFO - Batch 5 cleaned and saved.
2024-12-02 19:02:56,512 - INFO - Progress saved to /cs/home/sz92/Documents/CS5002/P3/code/progress.json.
2024-12-02 19:02:56,520 - INFO - Processing batch 6...
2024-12-02 19:02:56,520 - INFO - =====Checking for missing value:=====
2024-12-02 19:02:56,523 - INFO - No missing values detected.
2024-12-02 19:02:56,523 - INFO - =====Checking for duplicate rows:=====
2024-12-02 19:02:56,527 - INFO - No duplicate rows detected.
2024-12-02 19:02:56,539 - INFO -        record_number     region residence_type family_composition  sex  age  marital_status  ...  ethnic_group  religion  economic_activity  occupation  industry hours_worked_per_week approximate_social_grade
45024          45025  S92000003              P                  1    2    2               1  ...             1         1                  6           X         X                     X                        2
45030          45031  S92000003              P                  4    1    2               1  ...             1         1                  6           X         X                     X                        4
45047          45048  S92000003              P                  1    2    3               2  ...             1         1                  6           6        10                     X                        3
45072          45073  S92000003              P                  2    1    2               1  ...             2         1                  6           7         8                     X                        3
45124          45125  S92000003              P                  3    1    2               1  ...             1         2                  6           X         X                     X                        1
...              ...        ...            ...                ...  ...  ...             ...  ...           ...       ...                ...         ...       ...                   ...                      ...
53900          53901  S92000003              P                  1    2    2               1  ...             1         2                  6           X         X                     X                        4
53923          53924  S92000003              P                  2    1    2               1  ...             1         2                  6           X         X                     X                        4
53960          53961  S92000003              P                  4    1    2               1  ...             1         2                  6           X         X                     X                        4
53979          53980  S92000003              P                  1    2    2               1  ...             1         9                  6           7         4                     X                        3
53983          53984  S92000003              P                  3    1    2               1  ...             1         2                  6           X         X                     X                        4

[408 rows x 17 columns]
2024-12-02 19:02:56,544 - INFO - Rule 1: Found 408 rows to delete, saved to data/rule_1_deleted_data.csv
2024-12-02 19:02:56,546 - INFO - Rule 2: No rows to delete
2024-12-02 19:02:56,551 - INFO - Rule 3: Found 113 rows to delete, saved to data/rule_3_deleted_data.csv
2024-12-02 19:02:56,556 - INFO - Rule 4: Found 335 rows to delete, saved to data/rule_4_deleted_data.csv
2024-12-02 19:02:56,558 - INFO - Rule 5: No rows to delete
2024-12-02 19:02:56,563 - INFO - Rule 6: Found 113 rows to delete, saved to data/rule_6_deleted_data.csv
2024-12-02 19:02:56,565 - INFO - =====validate_data_ranges:=====
2024-12-02 19:02:56,633 - INFO - 
Unique categories and counts per column:
2024-12-02 19:02:56,633 - INFO - residence_type: ['C', 'P'] (Total unique: 2)
2024-12-02 19:02:56,633 - INFO - family_composition: ['1', '3', '0', '4', 'X', '5', '2'] (Total unique: 7)
2024-12-02 19:02:56,633 - INFO - sex: [1, 2] (Total unique: 2)
2024-12-02 19:02:56,633 - INFO - age: [1, 2, 3, 4, 5, 6, 7, 8] (Total unique: 8)
2024-12-02 19:02:56,633 - INFO - marital_status: [1, 2, 3, 4, 5] (Total unique: 5)
2024-12-02 19:02:56,633 - INFO - student: [1, 2] (Total unique: 2)
2024-12-02 19:02:56,633 - INFO - country_of_birth: [1, 2] (Total unique: 2)
2024-12-02 19:02:56,633 - INFO - health: [1, 2, 3, 4, 5] (Total unique: 5)
2024-12-02 19:02:56,633 - INFO - ethnic_group: [1, 2, 3, 4, 5, 6] (Total unique: 6)
2024-12-02 19:02:56,633 - INFO - religion: [1, 2, 3, 4, 5, 6, 7, 8, 9] (Total unique: 9)
2024-12-02 19:02:56,633 - INFO - economic_activity: ['1', '3', '6', '4', '8', '7', 'X', '9', '5', '2'] (Total unique: 10)
2024-12-02 19:02:56,633 - INFO - occupation: ['1', '3', '6', '4', '8', '7', 'X', '9', '5', '2'] (Total unique: 10)
2024-12-02 19:02:56,633 - INFO - industry: ['1', '3', '10', '6', '4', '8', '7', '12', 'X', '13', '9', '5', '2', '11'] (Total unique: 14)
2024-12-02 19:02:56,633 - INFO - hours_worked_per_week: ['1', '3', '4', 'X', '2'] (Total unique: 5)
2024-12-02 19:02:56,633 - INFO - approximate_social_grade: ['1', '3', '4', 'X', '2'] (Total unique: 5)
2024-12-02 19:02:56,633 - INFO - 
All data ranges validated.
2024-12-02 19:02:56,633 - INFO - =====Verifying 'record_number' uniqueness:=====
2024-12-02 19:02:56,633 - INFO - Columns in batch: ['record_number', 'region', 'residence_type', 'family_composition', 'sex', 'age', 'marital_status', 'student', 'country_of_birth', 'health', 'ethnic_group', 'religion', 'economic_activity', 'occupation', 'industry', 'hours_worked_per_week', 'approximate_social_grade']
2024-12-02 19:02:56,634 - INFO - Record_Number is unique.
2024-12-02 19:02:56,636 - INFO - 'record_number' column reset.
2024-12-02 19:02:56,662 - INFO - Batch 6 cleaned and saved.
2024-12-02 19:02:56,665 - INFO - Progress saved to /cs/home/sz92/Documents/CS5002/P3/code/progress.json.
2024-12-02 19:02:56,674 - INFO - Processing batch 7...
2024-12-02 19:02:56,674 - INFO - =====Checking for missing value:=====
2024-12-02 19:02:56,678 - INFO - No missing values detected.
2024-12-02 19:02:56,678 - INFO - =====Checking for duplicate rows:=====
2024-12-02 19:02:56,683 - INFO - No duplicate rows detected.
2024-12-02 19:02:56,694 - INFO -        record_number     region residence_type family_composition  sex  age  marital_status  ...  ethnic_group  religion  economic_activity  occupation  industry hours_worked_per_week approximate_social_grade
54010          54011  S92000003              P                  1    1    2               1  ...             1         2                  6           X         X                     X                        4
54023          54024  S92000003              P                  5    2    2               1  ...             1         9                  6           X         X                     X                        4
54132          54133  S92000003              P                  1    1    2               1  ...             1         2                  6           X         X                     X                        2
54137          54138  S92000003              P                  1    1    2               1  ...             1         1                  6           X         X                     X                        4
54153          54154  S92000003              P                  1    2    2               1  ...             1         1                  6           X         X                     X                        1
...              ...        ...            ...                ...  ...  ...             ...  ...           ...       ...                ...         ...       ...                   ...                      ...
62748          62749  S92000003              P                  4    2    2               1  ...             1         9                  6           X         X                     X                        1
62763          62764  S92000003              P                  0    1    2               1  ...             1         1                  6           7         2                     X                        2
62909          62910  S92000003              P                  0    1    2               1  ...             1         2                  6           9         5                     X                        2
62936          62937  S92000003              P                  0    1    2               1  ...             1         1                  6           8         8                     X                        2
62944          62945  S92000003              P                  1    1    2               1  ...             1         2                  6           X         X                     X                        2

[382 rows x 17 columns]
2024-12-02 19:02:56,699 - INFO - Rule 1: Found 382 rows to delete, saved to data/rule_1_deleted_data.csv
2024-12-02 19:02:56,703 - INFO - Rule 2: No rows to delete
2024-12-02 19:02:56,712 - INFO - Rule 3: Found 118 rows to delete, saved to data/rule_3_deleted_data.csv
2024-12-02 19:02:56,721 - INFO - Rule 4: Found 310 rows to delete, saved to data/rule_4_deleted_data.csv
2024-12-02 19:02:56,724 - INFO - Rule 5: No rows to delete
2024-12-02 19:02:56,732 - INFO - Rule 6: Found 118 rows to delete, saved to data/rule_6_deleted_data.csv
2024-12-02 19:02:56,735 - INFO - =====validate_data_ranges:=====
2024-12-02 19:02:56,808 - INFO - 
Unique categories and counts per column:
2024-12-02 19:02:56,808 - INFO - residence_type: ['C', 'P'] (Total unique: 2)
2024-12-02 19:02:56,808 - INFO - family_composition: ['1', '3', '0', '4', 'X', '5', '2'] (Total unique: 7)
2024-12-02 19:02:56,808 - INFO - sex: [1, 2] (Total unique: 2)
2024-12-02 19:02:56,808 - INFO - age: [1, 2, 3, 4, 5, 6, 7, 8] (Total unique: 8)
2024-12-02 19:02:56,809 - INFO - marital_status: [1, 2, 3, 4, 5] (Total unique: 5)
2024-12-02 19:02:56,809 - INFO - student: [1, 2] (Total unique: 2)
2024-12-02 19:02:56,809 - INFO - country_of_birth: [1, 2] (Total unique: 2)
2024-12-02 19:02:56,809 - INFO - health: [1, 2, 3, 4, 5] (Total unique: 5)
2024-12-02 19:02:56,809 - INFO - ethnic_group: [1, 2, 3, 4, 5, 6] (Total unique: 6)
2024-12-02 19:02:56,809 - INFO - religion: [1, 2, 3, 4, 5, 6, 7, 8, 9] (Total unique: 9)
2024-12-02 19:02:56,809 - INFO - economic_activity: ['1', '3', '6', '4', '8', '7', 'X', '9', '5', '2'] (Total unique: 10)
2024-12-02 19:02:56,809 - INFO - occupation: ['1', '3', '6', '4', '7', '8', 'X', '9', '5', '2'] (Total unique: 10)
2024-12-02 19:02:56,809 - INFO - industry: ['1', '3', '10', '6', '4', '8', '7', '12', 'X', '13', '9', '5', '2', '11'] (Total unique: 14)
2024-12-02 19:02:56,809 - INFO - hours_worked_per_week: ['1', '3', '4', 'X', '2'] (Total unique: 5)
2024-12-02 19:02:56,809 - INFO - approximate_social_grade: ['1', '3', '4', 'X', '2'] (Total unique: 5)
2024-12-02 19:02:56,809 - INFO - 
All data ranges validated.
2024-12-02 19:02:56,809 - INFO - =====Verifying 'record_number' uniqueness:=====
2024-12-02 19:02:56,809 - INFO - Columns in batch: ['record_number', 'region', 'residence_type', 'family_composition', 'sex', 'age', 'marital_status', 'student', 'country_of_birth', 'health', 'ethnic_group', 'religion', 'economic_activity', 'occupation', 'industry', 'hours_worked_per_week', 'approximate_social_grade']
2024-12-02 19:02:56,809 - INFO - Record_Number is unique.
2024-12-02 19:02:56,811 - INFO - 'record_number' column reset.
2024-12-02 19:02:56,838 - INFO - Batch 7 cleaned and saved.
2024-12-02 19:02:56,841 - INFO - Progress saved to /cs/home/sz92/Documents/CS5002/P3/code/progress.json.
2024-12-02 19:02:56,845 - INFO - Processing batch 8...
2024-12-02 19:02:56,845 - INFO - =====Checking for missing value:=====
2024-12-02 19:02:56,848 - INFO - No missing values detected.
2024-12-02 19:02:56,848 - INFO - =====Checking for duplicate rows:=====
2024-12-02 19:02:56,852 - INFO - No duplicate rows detected.
2024-12-02 19:02:56,873 - INFO -        record_number     region residence_type family_composition  sex  age  marital_status  ...  ethnic_group  religion  economic_activity  occupation  industry hours_worked_per_week approximate_social_grade
63092          63093  S92000003              P                  1    1    2               1  ...             1         1                  6           X         X                     X                        2
63106          63107  S92000003              P                  1    2    4               2  ...             1         2                  6           3         7                     X                        1
63112          63113  S92000003              P                  4    1    2               1  ...             1         1                  6           X         X                     X                        1
63124          63125  S92000003              P                  0    2    2               1  ...             1         1                  6           X         X                     X                        2
63127          63128  S92000003              P                  0    2    3               1  ...             1         2                  6           2        10                     X                        2
63129          63130  S92000003              P                  0    2    2               1  ...             1         2                  6           9        12                     X                        1
63139          63140  S92000003              P                  1    2    4               2  ...             1         1                  6           6        10                     X                        2
63140          63141  S92000003              P                  2    1    2               1  ...             1         1                  6           X         X                     X                        1
63142          63143  S92000003              P                  1    1    3               2  ...             1         2                  6           2         6                     X                        2
63152          63153  S92000003              P                  1    2    2               1  ...             1         2                  6           7         4                     X                        2
63159          63160  S92000003              P                  0    1    2               1  ...             1         1                  6           9         4                     X                        2
63163          63164  S92000003              P                  1    1    2               1  ...             1         1                  6           9         5                     X                        1
63168          63169  S92000003              P                  0    1    4               1  ...             4         2                  6           7         8                     X                        2
63171          63172  S92000003              P                  1    2    2               1  ...             1         2                  6           X         X                     X                        2
63235          63236  S92000003              P                  4    2    2               1  ...             1         1                  6           X         X                     X                        4
63241          63242  S92000003              P                  1    2    2               1  ...             1         2                  6           X         X                     X                        3
63295          63296  S92000003              P                  1    1    2               1  ...             1         2                  6           7         4                     X                        2
63317          63318  S92000003              P                  0    2    2               1  ...             3         1                  6           X         X                     X                        2
63350          63351  S92000003              P                  1    1    2               1  ...             1         1                  6           X         X                     X                        4
63366          63367  S92000003              P                  4    2    2               1  ...             1         1                  6           X         X                     X                        2
63383          63384  S92000003              P                  1    1    2               1  ...             1         2                  6           X         X                     X                        3

[21 rows x 17 columns]
2024-12-02 19:02:56,877 - INFO - Rule 1: Found 21 rows to delete, saved to data/rule_1_deleted_data.csv
2024-12-02 19:02:56,877 - INFO - Rule 2: No rows to delete
2024-12-02 19:02:56,881 - INFO - Rule 3: Found 8 rows to delete, saved to data/rule_3_deleted_data.csv
2024-12-02 19:02:56,886 - INFO - Rule 4: Found 16 rows to delete, saved to data/rule_4_deleted_data.csv
2024-12-02 19:02:56,887 - INFO - Rule 5: No rows to delete
2024-12-02 19:02:56,891 - INFO - Rule 6: Found 8 rows to delete, saved to data/rule_6_deleted_data.csv
2024-12-02 19:02:56,892 - INFO - =====validate_data_ranges:=====
2024-12-02 19:02:56,908 - INFO - 
Unique categories and counts per column:
2024-12-02 19:02:56,908 - INFO - residence_type: ['C', 'P'] (Total unique: 2)
2024-12-02 19:02:56,908 - INFO - family_composition: ['1', '3', '0', '4', 'X', '5', '2'] (Total unique: 7)
2024-12-02 19:02:56,908 - INFO - sex: [1, 2] (Total unique: 2)
2024-12-02 19:02:56,908 - INFO - age: [1, 2, 3, 4, 5, 6, 7, 8] (Total unique: 8)
2024-12-02 19:02:56,908 - INFO - marital_status: [1, 2, 3, 4, 5] (Total unique: 5)
2024-12-02 19:02:56,908 - INFO - student: [1, 2] (Total unique: 2)
2024-12-02 19:02:56,908 - INFO - country_of_birth: [1, 2] (Total unique: 2)
2024-12-02 19:02:56,908 - INFO - health: [1, 2, 3, 4] (Total unique: 4)
2024-12-02 19:02:56,908 - INFO - ethnic_group: [1, 3, 4] (Total unique: 3)
2024-12-02 19:02:56,908 - INFO - religion: [1, 2, 3, 4, 5, 6, 8, 9] (Total unique: 8)
2024-12-02 19:02:56,908 - INFO - economic_activity: ['1', '3', '6', '4', '7', '8', 'X', '9', '5', '2'] (Total unique: 10)
2024-12-02 19:02:56,908 - INFO - occupation: ['1', '3', '6', '4', '7', '8', 'X', '9', '5', '2'] (Total unique: 10)
2024-12-02 19:02:56,908 - INFO - industry: ['1', '3', '10', '6', '4', '8', '7', '12', 'X', '13', '9', '5', '2', '11'] (Total unique: 14)
2024-12-02 19:02:56,908 - INFO - hours_worked_per_week: ['1', '3', '4', 'X', '2'] (Total unique: 5)
2024-12-02 19:02:56,908 - INFO - approximate_social_grade: ['1', '3', '4', 'X', '2'] (Total unique: 5)
2024-12-02 19:02:56,908 - INFO - 
All data ranges validated.
2024-12-02 19:02:56,908 - INFO - =====Verifying 'record_number' uniqueness:=====
2024-12-02 19:02:56,908 - INFO - Columns in batch: ['record_number', 'region', 'residence_type', 'family_composition', 'sex', 'age', 'marital_status', 'student', 'country_of_birth', 'health', 'ethnic_group', 'religion', 'economic_activity', 'occupation', 'industry', 'hours_worked_per_week', 'approximate_social_grade']
2024-12-02 19:02:56,909 - INFO - Record_Number is unique.
2024-12-02 19:02:56,910 - INFO - 'record_number' column reset.
2024-12-02 19:02:56,913 - INFO - Batch 8 cleaned and saved.
2024-12-02 19:02:56,915 - INFO - Progress saved to /cs/home/sz92/Documents/CS5002/P3/code/progress.json.
2024-12-02 19:02:56,916 - INFO - Data cleaning process completed. Total rows processed: 63388
2024-12-02 19:02:56,916 - INFO - Rows to drop: 5297
2024-12-02 19:02:56,916 - INFO - Cleaned data saved to ../data/output.csv
2024-12-02 19:02:56,916 - INFO - Progress file removed. Data processing complete.
2024-12-02 19:02:57,462 - INFO - Data clean code test passed. Congratulations! Result deatils in log/data_cleaning.log
2024-12-02 19:02:57,494 - INFO - =====Checking data types:=====
2024-12-02 19:02:57,503 - INFO - Batch info:
None
2024-12-02 19:02:57,537 - INFO - =====Checking for missing value:=====
2024-12-02 19:02:57,540 - INFO - No missing values detected.
2024-12-02 19:02:57,540 - INFO - =====Checking for duplicate rows:=====
2024-12-02 19:02:57,544 - INFO - No duplicate rows detected.
2024-12-02 19:02:57,544 - INFO - =====Verifying 'record_number' uniqueness:=====
2024-12-02 19:02:57,544 - INFO - Columns in batch: ['record_number', 'region', 'residence_type', 'family_composition', 'sex', 'age', 'marital_status', 'student', 'country_of_birth', 'health', 'ethnic_group', 'religion', 'economic_activity', 'occupation', 'industry', 'hours_worked_per_week', 'approximate_social_grade']
2024-12-02 19:02:57,545 - INFO - Record_Number is unique.
2024-12-02 19:02:57,545 - INFO - =====validate_data_ranges:=====
2024-12-02 19:02:57,615 - INFO - 
Unique categories and counts per column:
2024-12-02 19:02:57,615 - INFO - residence_type: ['C', 'P'] (Total unique: 2)
2024-12-02 19:02:57,615 - INFO - family_composition: ['1', '3', '0', '4', 'X', '5', '2'] (Total unique: 7)
2024-12-02 19:02:57,615 - INFO - sex: [1, 2] (Total unique: 2)
2024-12-02 19:02:57,615 - INFO - age: [1, 2, 3, 4, 5, 6, 7, 8] (Total unique: 8)
2024-12-02 19:02:57,615 - INFO - marital_status: [1, 2, 3, 4, 5] (Total unique: 5)
2024-12-02 19:02:57,615 - INFO - student: [1, 2] (Total unique: 2)
2024-12-02 19:02:57,615 - INFO - country_of_birth: [1, 2] (Total unique: 2)
2024-12-02 19:02:57,615 - INFO - health: [1, 2, 3, 4, 5] (Total unique: 5)
2024-12-02 19:02:57,615 - INFO - ethnic_group: [1, 2, 3, 4, 5, 6] (Total unique: 6)
2024-12-02 19:02:57,615 - INFO - religion: [1, 2, 3, 4, 5, 6, 7, 8, 9] (Total unique: 9)
2024-12-02 19:02:57,615 - INFO - economic_activity: ['1', '3', '6', '4', '7', '8', 'X', '9', '5', '2'] (Total unique: 10)
2024-12-02 19:02:57,615 - INFO - occupation: ['1', '3', '6', '4', '8', '7', 'X', '9', '5', '2'] (Total unique: 10)
2024-12-02 19:02:57,615 - INFO - industry: ['1', '10', '3', '6', '4', '8', '7', '12', 'X', '13', '9', '5', '2', '11'] (Total unique: 14)
2024-12-02 19:02:57,615 - INFO - hours_worked_per_week: ['1', '3', '4', 'X', '2'] (Total unique: 5)
2024-12-02 19:02:57,615 - INFO - approximate_social_grade: ['1', '3', '4', 'X', '2'] (Total unique: 5)
2024-12-02 19:02:57,615 - INFO - 
All data ranges validated.
2024-12-02 19:02:57,616 - INFO - Starting data cleaning process...
2024-12-02 19:02:57,638 - INFO - Processing batch 1...
2024-12-02 19:02:57,638 - INFO - =====Checking for missing value:=====
2024-12-02 19:02:57,639 - INFO - No missing values detected.
2024-12-02 19:02:57,639 - INFO - =====Checking for duplicate rows:=====
2024-12-02 19:02:57,639 - INFO - No duplicate rows detected.
2024-12-02 19:05:34,666 - WARNING - Progress file progress.json not found. Starting from the beginning.
2024-12-02 19:05:34,733 - INFO - Loaded data from row 0.
2024-12-02 19:05:34,733 - INFO - Columns in DataFrame: ['record_number', 'region', 'residence_type', 'family_composition', 'sex', 'age', 'marital_status', 'student', 'country_of_birth', 'health', 'ethnic_group', 'religion', 'economic_activity', 'occupation', 'industry', 'hours_worked_per_week', 'approximate_social_grade']
2024-12-02 19:05:34,733 - WARNING - Progress file progress.json not found. Starting from the beginning.
2024-12-02 19:05:34,788 - INFO - =====Checking data types:=====
2024-12-02 19:05:34,809 - INFO - Batch info:
None
2024-12-02 19:05:35,071 - INFO - =====Checking for missing value:=====
2024-12-02 19:05:35,088 - INFO - No missing values detected.
2024-12-02 19:05:35,088 - INFO - =====Checking for duplicate rows:=====
2024-12-02 19:05:35,111 - INFO - No duplicate rows detected.
2024-12-02 19:05:35,111 - INFO - =====Verifying 'record_number' uniqueness:=====
2024-12-02 19:05:35,111 - INFO - Columns in batch: ['record_number', 'region', 'residence_type', 'family_composition', 'sex', 'age', 'marital_status', 'student', 'country_of_birth', 'health', 'ethnic_group', 'religion', 'economic_activity', 'occupation', 'industry', 'hours_worked_per_week', 'approximate_social_grade']
2024-12-02 19:05:35,112 - INFO - Record_Number is unique.
2024-12-02 19:05:35,113 - INFO - =====validate_data_ranges:=====
2024-12-02 19:05:35,599 - INFO - 
Unique categories and counts per column:
2024-12-02 19:05:35,599 - INFO - residence_type: ['P', 'C'] (Total unique: 2)
2024-12-02 19:05:35,599 - INFO - family_composition: ['1', '0', '4', 'X', '5', '3', '2'] (Total unique: 7)
2024-12-02 19:05:35,599 - INFO - sex: [1, 2] (Total unique: 2)
2024-12-02 19:05:35,599 - INFO - age: [1, 2, 3, 4, 5, 6, 7, 8] (Total unique: 8)
2024-12-02 19:05:35,599 - INFO - marital_status: [1, 2, 3, 4, 5] (Total unique: 5)
2024-12-02 19:05:35,599 - INFO - student: [1, 2] (Total unique: 2)
2024-12-02 19:05:35,599 - INFO - country_of_birth: [1, 2] (Total unique: 2)
2024-12-02 19:05:35,599 - INFO - health: [1, 2, 3, 4, 5] (Total unique: 5)
2024-12-02 19:05:35,599 - INFO - ethnic_group: [1, 2, 3, 4, 5, 6] (Total unique: 6)
2024-12-02 19:05:35,599 - INFO - religion: [1, 2, 3, 4, 5, 6, 7, 8, 9] (Total unique: 9)
2024-12-02 19:05:35,600 - INFO - economic_activity: ['2', '7', '1', '4', 'X', '6', '5', '3', '8', '9'] (Total unique: 10)
2024-12-02 19:05:35,600 - INFO - occupation: ['7', '1', '9', '4', 'X', '6', '5', '3', '8', '2'] (Total unique: 10)
2024-12-02 19:05:35,600 - INFO - industry: ['2', '7', '1', '11', '12', '4', 'X', '10', '6', '5', '3', '8', '13', '9'] (Total unique: 14)
2024-12-02 19:05:35,600 - INFO - hours_worked_per_week: ['1', '4', 'X', '3', '2'] (Total unique: 5)
2024-12-02 19:05:35,600 - INFO - approximate_social_grade: ['1', '4', 'X', '3', '2'] (Total unique: 5)
2024-12-02 19:05:35,600 - INFO - 
All data ranges validated.
2024-12-02 19:05:35,600 - INFO - Starting data cleaning process...
2024-12-02 19:05:35,654 - INFO - Processing batch 1...
2024-12-02 19:05:35,655 - INFO - =====Checking for missing value:=====
2024-12-02 19:05:35,672 - INFO - No missing values detected.
2024-12-02 19:05:35,672 - INFO - =====Checking for duplicate rows:=====
2024-12-02 19:05:35,695 - INFO - No duplicate rows detected.
2024-12-02 19:05:35,712 - INFO -        record_number     region residence_type family_composition  sex  age  marital_status  ...  ethnic_group  religion  economic_activity  occupation  industry hours_worked_per_week approximate_social_grade
20                21  S92000003              P                  5    2    2               1  ...             1         2                  6           X         X                     X                        2
47                48  S92000003              P                  0    1    2               1  ...             1         1                  6           X         X                     X                        2
48                49  S92000003              P                  0    1    3               2  ...             4         2                  6           2         8                     X                        2
85                86  S92000003              P                  1    1    2               1  ...             1         2                  6           X         X                     X                        1
88                89  S92000003              P                  1    1    3               2  ...             1         2                  6           2        10                     X                        2
...              ...        ...            ...                ...  ...  ...             ...  ...           ...       ...                ...         ...       ...                   ...                      ...
63295          63296  S92000003              P                  1    1    2               1  ...             1         2                  6           7         4                     X                        2
63317          63318  S92000003              P                  0    2    2               1  ...             3         1                  6           X         X                     X                        2
63350          63351  S92000003              P                  1    1    2               1  ...             1         1                  6           X         X                     X                        4
63366          63367  S92000003              P                  4    2    2               1  ...             1         1                  6           X         X                     X                        2
63383          63384  S92000003              P                  1    1    2               1  ...             1         2                  6           X         X                     X                        3

[2598 rows x 17 columns]
2024-12-02 19:05:35,723 - INFO - Rule 1: Found 2598 rows to delete, saved to data/rule_1_deleted_data.csv
2024-12-02 19:05:35,729 - INFO - Rule 2: No rows to delete
2024-12-02 19:05:35,740 - INFO - Rule 3: Found 843 rows to delete, saved to data/rule_3_deleted_data.csv
2024-12-02 19:05:35,756 - INFO - Rule 4: Found 2362 rows to delete, saved to data/rule_4_deleted_data.csv
2024-12-02 19:05:35,762 - INFO - Rule 5: No rows to delete
2024-12-02 19:05:35,774 - INFO - Rule 6: Found 843 rows to delete, saved to data/rule_6_deleted_data.csv
2024-12-02 19:05:35,779 - INFO - =====validate_data_ranges:=====
2024-12-02 19:05:36,231 - INFO - 
Unique categories and counts per column:
2024-12-02 19:05:36,231 - INFO - residence_type: ['P', 'C'] (Total unique: 2)
2024-12-02 19:05:36,231 - INFO - family_composition: ['1', '0', '4', 'X', '5', '3', '2'] (Total unique: 7)
2024-12-02 19:05:36,231 - INFO - sex: [1, 2] (Total unique: 2)
2024-12-02 19:05:36,231 - INFO - age: [1, 2, 3, 4, 5, 6, 7, 8] (Total unique: 8)
2024-12-02 19:05:36,231 - INFO - marital_status: [1, 2, 3, 4, 5] (Total unique: 5)
2024-12-02 19:05:36,231 - INFO - student: [1, 2] (Total unique: 2)
2024-12-02 19:05:36,232 - INFO - country_of_birth: [1, 2] (Total unique: 2)
2024-12-02 19:05:36,232 - INFO - health: [1, 2, 3, 4, 5] (Total unique: 5)
2024-12-02 19:05:36,232 - INFO - ethnic_group: [1, 2, 3, 4, 5, 6] (Total unique: 6)
2024-12-02 19:05:36,232 - INFO - religion: [1, 2, 3, 4, 5, 6, 7, 8, 9] (Total unique: 9)
2024-12-02 19:05:36,232 - INFO - economic_activity: ['2', '7', '1', '4', 'X', '6', '5', '3', '8', '9'] (Total unique: 10)
2024-12-02 19:05:36,232 - INFO - occupation: ['7', '1', '9', '4', 'X', '6', '5', '3', '8', '2'] (Total unique: 10)
2024-12-02 19:05:36,232 - INFO - industry: ['2', '7', '1', '11', '12', '4', 'X', '10', '6', '5', '3', '8', '13', '9'] (Total unique: 14)
2024-12-02 19:05:36,232 - INFO - hours_worked_per_week: ['1', '4', 'X', '3', '2'] (Total unique: 5)
2024-12-02 19:05:36,232 - INFO - approximate_social_grade: ['1', '4', 'X', '3', '2'] (Total unique: 5)
2024-12-02 19:05:36,232 - INFO - 
All data ranges validated.
2024-12-02 19:05:36,232 - INFO - =====Verifying 'record_number' uniqueness:=====
2024-12-02 19:05:36,232 - INFO - Columns in batch: ['record_number', 'region', 'residence_type', 'family_composition', 'sex', 'age', 'marital_status', 'student', 'country_of_birth', 'health', 'ethnic_group', 'religion', 'economic_activity', 'occupation', 'industry', 'hours_worked_per_week', 'approximate_social_grade']
2024-12-02 19:05:36,234 - INFO - Record_Number is unique.
2024-12-02 19:05:36,246 - INFO - 'record_number' column reset.
2024-12-02 19:05:36,424 - INFO - Batch 1 cleaned and saved.
2024-12-02 19:05:36,427 - INFO - Progress saved to /cs/home/sz92/Documents/CS5002/P3/code/progress.json.
2024-12-02 19:05:36,427 - INFO - Data cleaning process completed. Total rows processed: 63388
2024-12-02 19:05:36,427 - INFO - Rows to drop: 5297
2024-12-02 19:05:36,427 - INFO - Cleaned data saved to ../data/output.csv
2024-12-02 19:05:36,428 - INFO - Progress file removed. Data processing complete.
2024-12-02 19:05:36,988 - INFO - Data clean code test passed. Congratulations! Result deatils in log/data_cleaning.log
2024-12-02 19:06:37,786 - WARNING - Progress file progress.json not found. Starting from the beginning.
2024-12-02 19:06:37,853 - INFO - Loaded data from row 0.
2024-12-02 19:06:37,853 - INFO - Columns in DataFrame: ['record_number', 'region', 'residence_type', 'family_composition', 'sex', 'age', 'marital_status', 'student', 'country_of_birth', 'health', 'ethnic_group', 'religion', 'economic_activity', 'occupation', 'industry', 'hours_worked_per_week', 'approximate_social_grade']
2024-12-02 19:06:37,853 - WARNING - Progress file progress.json not found. Starting from the beginning.
2024-12-02 19:06:37,908 - INFO - =====Checking data types:=====
2024-12-02 19:06:37,930 - INFO - Batch info:
None
2024-12-02 19:06:38,190 - INFO - =====Checking for missing value:=====
2024-12-02 19:06:38,209 - WARNING - Missing values detected:
Record_Number               0
Region                      0
RESIDENCE_TYPE              0
Family_Composition          0
sex                         0
age                         0
Marital_Status              0
student                     0
Country_Of_Birth            0
health                      0
Ethnic_Group                0
religion                    0
Economic_Activity           0
Occupation                  0
industry                    0
Hours_Worked_Per_Week       0
Approximate_Social_Grade    5
dtype: int64
2024-12-02 19:06:38,229 - WARNING - Column 'approximate_social_grade': missing values at indices [1, 27, 29, 42273, 42441]
2024-12-02 19:06:38,248 - INFO - Rows to drop:
       record_number     region residence_type family_composition  sex  age  marital_status  student  country_of_birth  health  ethnic_group  religion economic_activity occupation industry hours_worked_per_week approximate_social_grade
1                  2  S92000003              P                  0    1    3               1        2                 1       2             1         1                 1          1        8                     3                      NaN
27                27  S92000003              P                  1    2    4               2        2                 1       2             2         2                 1          6       11                     4                      NaN
29                29  S92000003              P                  2    6    2               2        1                 2       1             2         1                 6          4        2                     3                      NaN
42273          42273  S92000003              C                  X    1    6               1        2                 1       3             1         2                 X          X        X                     X                      NaN
42441          42441  S92000003              C                  X    2    8               5        1                 2       1             9         5                 X          X        X                     X                      NaN
2024-12-02 19:06:38,248 - INFO - =====Checking for duplicate rows:=====
2024-12-02 19:06:38,271 - ERROR - Failed! 1 duplicate rows detected.
2024-12-02 19:06:38,271 - INFO - 
Duplicate rows:
2024-12-02 19:06:38,296 - INFO -    record_number     region residence_type family_composition  sex  age  marital_status  student  country_of_birth  health  ethnic_group  religion economic_activity occupation industry hours_worked_per_week approximate_social_grade
5              5  S92000003              P                  4    2    4               4        2                 1       2             1         1                 1          3       11                     3                        2
2024-12-02 19:06:38,296 - INFO - =====Verifying 'record_number' uniqueness:=====
2024-12-02 19:06:38,296 - INFO - Columns in batch: ['record_number', 'region', 'residence_type', 'family_composition', 'sex', 'age', 'marital_status', 'student', 'country_of_birth', 'health', 'ethnic_group', 'religion', 'economic_activity', 'occupation', 'industry', 'hours_worked_per_week', 'approximate_social_grade']
2024-12-02 19:06:38,298 - ERROR - Failed! 'record_number' is not unique. Duplicate record numbers: [5]
2024-12-02 19:06:38,298 - INFO - 
Duplicate rows:
2024-12-02 19:06:38,300 - INFO -    record_number     region residence_type family_composition  sex  age  marital_status  student  country_of_birth  health  ethnic_group  religion economic_activity occupation industry hours_worked_per_week approximate_social_grade
5              5  S92000003              P                  4    2    4               4        2                 1       2             1         1                 1          3       11                     3                        2
2024-12-02 19:06:38,301 - INFO - =====validate_data_ranges:=====
2024-12-02 19:06:38,384 - INFO - 
Broken records in column 'sex':
2024-12-02 19:06:38,384 - INFO -     sex
29    6
2024-12-02 19:06:38,385 - ERROR - Failed! Column 'sex' contains invalid values: [6]
2024-12-02 19:06:38,630 - INFO - 
Broken records in column 'ethnic_group':
2024-12-02 19:06:38,631 - INFO -        ethnic_group
42441             9
2024-12-02 19:06:38,631 - ERROR - Failed! Column 'ethnic_group' contains invalid values: [9]
2024-12-02 19:06:38,780 - INFO - 
Broken records in column 'approximate_social_grade':
2024-12-02 19:06:38,781 - INFO -       approximate_social_grade
0                           11
1                          NaN
27                         NaN
29                         NaN
42273                      NaN
42441                      NaN
2024-12-02 19:06:38,781 - ERROR - Failed! Column 'approximate_social_grade' contains invalid values: ['11', nan]
2024-12-02 19:06:38,781 - INFO - 
Unique categories and counts per column:
2024-12-02 19:06:38,781 - INFO - residence_type: ['C', 'P'] (Total unique: 2)
2024-12-02 19:06:38,782 - INFO - family_composition: ['2', '0', '5', '3', '1', 'X', '4'] (Total unique: 7)
2024-12-02 19:06:38,782 - INFO - sex: [1, 2, 6] (Total unique: 3)
2024-12-02 19:06:38,782 - INFO - age: [1, 2, 3, 4, 5, 6, 7, 8] (Total unique: 8)
2024-12-02 19:06:38,782 - INFO - marital_status: [1, 2, 3, 4, 5] (Total unique: 5)
2024-12-02 19:06:38,782 - INFO - student: [1, 2] (Total unique: 2)
2024-12-02 19:06:38,782 - INFO - country_of_birth: [1, 2] (Total unique: 2)
2024-12-02 19:06:38,782 - INFO - health: [1, 2, 3, 4, 5] (Total unique: 5)
2024-12-02 19:06:38,782 - INFO - ethnic_group: [1, 2, 3, 4, 5, 6, 9] (Total unique: 7)
2024-12-02 19:06:38,782 - INFO - religion: [1, 2, 3, 4, 5, 6, 7, 8, 9] (Total unique: 9)
2024-12-02 19:06:38,782 - INFO - economic_activity: ['2', '6', '7', '5', '8', '3', '1', 'X', '4', '9'] (Total unique: 10)
2024-12-02 19:06:38,782 - INFO - occupation: ['2', '6', '7', '5', '8', '3', '1', 'X', '4', '9'] (Total unique: 10)
2024-12-02 19:06:38,782 - INFO - industry: ['2', '6', '12', '7', '5', '8', '13', '11', '3', '1', 'X', '4', '9', '10'] (Total unique: 14)
2024-12-02 19:06:38,782 - INFO - hours_worked_per_week: ['2', '3', '1', 'X', '4'] (Total unique: 5)
2024-12-02 19:06:38,782 - INFO - approximate_social_grade: ['2', '11', '3', '1', 'X', '4'] (Total unique: 6)
2024-12-02 19:06:38,782 - INFO - Starting data cleaning process...
2024-12-02 19:06:38,838 - INFO - Processing batch 1...
2024-12-02 19:06:38,839 - INFO - =====Checking for missing value:=====
2024-12-02 19:06:38,855 - WARNING - Missing values detected:
Record_Number               0
Region                      0
RESIDENCE_TYPE              0
Family_Composition          0
sex                         0
age                         0
Marital_Status              0
student                     0
Country_Of_Birth            0
health                      0
Ethnic_Group                0
religion                    0
Economic_Activity           0
Occupation                  0
industry                    0
Hours_Worked_Per_Week       0
Approximate_Social_Grade    5
dtype: int64
2024-12-02 19:06:38,882 - WARNING - Column 'approximate_social_grade': missing values at indices [1, 27, 29, 42273, 42441]
2024-12-02 19:06:38,901 - INFO - Rows to drop:
       record_number     region residence_type family_composition  sex  age  marital_status  student  country_of_birth  health  ethnic_group  religion economic_activity occupation industry hours_worked_per_week approximate_social_grade
1                  2  S92000003              P                  0    1    3               1        2                 1       2             1         1                 1          1        8                     3                      NaN
27                27  S92000003              P                  1    2    4               2        2                 1       2             2         2                 1          6       11                     4                      NaN
29                29  S92000003              P                  2    6    2               2        1                 2       1             2         1                 6          4        2                     3                      NaN
42273          42273  S92000003              C                  X    1    6               1        2                 1       3             1         2                 X          X        X                     X                      NaN
42441          42441  S92000003              C                  X    2    8               5        1                 2       1             9         5                 X          X        X                     X                      NaN
2024-12-02 19:06:38,901 - INFO - =====Checking for duplicate rows:=====
2024-12-02 19:06:38,924 - ERROR - Failed! 1 duplicate rows detected.
2024-12-02 19:06:38,924 - INFO - 
Duplicate rows:
2024-12-02 19:06:38,949 - INFO -    record_number     region residence_type family_composition  sex  age  marital_status  student  country_of_birth  health  ethnic_group  religion economic_activity occupation industry hours_worked_per_week approximate_social_grade
5              5  S92000003              P                  4    2    4               4        2                 1       2             1         1                 1          3       11                     3                        2
2024-12-02 19:06:38,964 - INFO -        record_number     region residence_type family_composition  sex  age  marital_status  ...  ethnic_group  religion  economic_activity  occupation  industry hours_worked_per_week approximate_social_grade
21                21  S92000003              P                  5    2    2               1  ...             1         2                  6           X         X                     X                        2
29                29  S92000003              P                  2    6    2               2  ...             2         1                  6           4         2                     3                      NaN
48                48  S92000003              P                  0    1    2               1  ...             1         1                  6           X         X                     X                        2
49                49  S92000003              P                  0    1    3               2  ...             4         2                  6           2         8                     X                        2
86                86  S92000003              P                  1    1    2               1  ...             1         2                  6           X         X                     X                        1
...              ...        ...            ...                ...  ...  ...             ...  ...           ...       ...                ...         ...       ...                   ...                      ...
63296          63296  S92000003              P                  1    1    2               1  ...             1         2                  6           7         4                     X                        2
63318          63318  S92000003              P                  0    2    2               1  ...             3         1                  6           X         X                     X                        2
63351          63351  S92000003              P                  1    1    2               1  ...             1         1                  6           X         X                     X                        4
63367          63367  S92000003              P                  4    2    2               1  ...             1         1                  6           X         X                     X                        2
63384          63384  S92000003              P                  1    1    2               1  ...             1         2                  6           X         X                     X                        3

[2600 rows x 17 columns]
2024-12-02 19:06:38,975 - INFO - Rule 1: Found 2600 rows to delete, saved to data/rule_1_deleted_data.csv
2024-12-02 19:06:38,981 - INFO - Rule 2: No rows to delete
2024-12-02 19:06:38,993 - INFO - Rule 3: Found 842 rows to delete, saved to data/rule_3_deleted_data.csv
2024-12-02 19:06:39,011 - INFO - Rule 4: Found 2362 rows to delete, saved to data/rule_4_deleted_data.csv
2024-12-02 19:06:39,017 - INFO - Rule 5: No rows to delete
2024-12-02 19:06:39,030 - INFO - Rule 6: Found 842 rows to delete, saved to data/rule_6_deleted_data.csv
2024-12-02 19:06:39,035 - INFO - =====validate_data_ranges:=====
2024-12-02 19:06:39,110 - INFO - 
Broken records in column 'sex':
2024-12-02 19:06:39,111 - INFO -     sex
29    6
2024-12-02 19:06:39,111 - ERROR - Failed! Column 'sex' contains invalid values: [6]
2024-12-02 19:06:39,336 - INFO - 
Broken records in column 'ethnic_group':
2024-12-02 19:06:39,337 - INFO -        ethnic_group
42441             9
2024-12-02 19:06:39,338 - ERROR - Failed! Column 'ethnic_group' contains invalid values: [9]
2024-12-02 19:06:39,486 - INFO - 
Broken records in column 'approximate_social_grade':
2024-12-02 19:06:39,487 - INFO -       approximate_social_grade
0                           11
1                          NaN
27                         NaN
29                         NaN
42273                      NaN
42441                      NaN
2024-12-02 19:06:39,487 - ERROR - Failed! Column 'approximate_social_grade' contains invalid values: ['11', nan]
2024-12-02 19:06:39,487 - INFO - 
Unique categories and counts per column:
2024-12-02 19:06:39,487 - INFO - residence_type: ['C', 'P'] (Total unique: 2)
2024-12-02 19:06:39,487 - INFO - family_composition: ['2', '0', '5', '3', '1', 'X', '4'] (Total unique: 7)
2024-12-02 19:06:39,487 - INFO - sex: [1, 2, 6] (Total unique: 3)
2024-12-02 19:06:39,487 - INFO - age: [1, 2, 3, 4, 5, 6, 7, 8] (Total unique: 8)
2024-12-02 19:06:39,487 - INFO - marital_status: [1, 2, 3, 4, 5] (Total unique: 5)
2024-12-02 19:06:39,487 - INFO - student: [1, 2] (Total unique: 2)
2024-12-02 19:06:39,487 - INFO - country_of_birth: [1, 2] (Total unique: 2)
2024-12-02 19:06:39,487 - INFO - health: [1, 2, 3, 4, 5] (Total unique: 5)
2024-12-02 19:06:39,487 - INFO - ethnic_group: [1, 2, 3, 4, 5, 6, 9] (Total unique: 7)
2024-12-02 19:06:39,487 - INFO - religion: [1, 2, 3, 4, 5, 6, 7, 8, 9] (Total unique: 9)
2024-12-02 19:06:39,487 - INFO - economic_activity: ['2', '6', '7', '5', '8', '3', '1', 'X', '4', '9'] (Total unique: 10)
2024-12-02 19:06:39,487 - INFO - occupation: ['2', '6', '7', '5', '8', '3', '1', 'X', '4', '9'] (Total unique: 10)
2024-12-02 19:06:39,487 - INFO - industry: ['2', '6', '12', '7', '5', '8', '13', '11', '3', '1', 'X', '4', '9', '10'] (Total unique: 14)
2024-12-02 19:06:39,488 - INFO - hours_worked_per_week: ['2', '3', '1', 'X', '4'] (Total unique: 5)
2024-12-02 19:06:39,488 - INFO - approximate_social_grade: ['2', '11', '3', '1', 'X', '4'] (Total unique: 6)
2024-12-02 19:06:39,488 - INFO - =====Verifying 'record_number' uniqueness:=====
2024-12-02 19:06:39,488 - INFO - Columns in batch: ['record_number', 'region', 'residence_type', 'family_composition', 'sex', 'age', 'marital_status', 'student', 'country_of_birth', 'health', 'ethnic_group', 'religion', 'economic_activity', 'occupation', 'industry', 'hours_worked_per_week', 'approximate_social_grade']
2024-12-02 19:06:39,490 - ERROR - Failed! 'record_number' is not unique. Duplicate record numbers: [5]
2024-12-02 19:06:39,490 - INFO - 
Duplicate rows:
2024-12-02 19:06:39,493 - INFO -    record_number     region residence_type family_composition  sex  age  marital_status  student  country_of_birth  health  ethnic_group  religion economic_activity occupation industry hours_worked_per_week approximate_social_grade
5              5  S92000003              P                  4    2    4               4        2                 1       2             1         1                 1          3       11                     3                        2
2024-12-02 19:06:39,504 - INFO - 'record_number' column reset.
2024-12-02 19:06:39,708 - INFO - Batch 1 cleaned and saved.
2024-12-02 19:06:39,711 - INFO - Progress saved to /cs/home/sz92/Documents/CS5002/P3/code/progress.json.
2024-12-02 19:06:39,712 - INFO - Data cleaning process completed. Total rows processed: 63389
2024-12-02 19:06:39,712 - INFO - Rows to drop: 5303
2024-12-02 19:06:39,712 - INFO - Cleaned data saved to ../data/output.csv
2024-12-02 19:06:39,713 - INFO - Progress file removed. Data processing complete.
2024-12-02 19:06:40,308 - INFO - Data clean code test passed. Congratulations! Result deatils in log/data_cleaning.log
2024-12-02 19:21:53,523 - WARNING - Progress file progress.json not found. Starting from the beginning.
2024-12-02 19:21:53,591 - INFO - Loaded data from row 0.
2024-12-02 19:21:53,592 - INFO - Columns in DataFrame: ['record_number', 'region', 'residence_type', 'family_composition', 'sex', 'age', 'marital_status', 'student', 'country_of_birth', 'health', 'ethnic_group', 'religion', 'economic_activity', 'occupation', 'industry', 'hours_worked_per_week', 'approximate_social_grade']
2024-12-02 19:21:53,592 - WARNING - Progress file progress.json not found. Starting from the beginning.
2024-12-02 19:21:53,600 - INFO - =====Checking data types:=====
2024-12-02 19:21:53,607 - INFO - Batch info:
None
2024-12-02 19:21:53,648 - INFO - =====Checking for missing value:=====
2024-12-02 19:21:53,652 - INFO - No missing values detected.
2024-12-02 19:21:53,652 - INFO - =====Checking for duplicate rows:=====
2024-12-02 19:21:53,656 - INFO - No duplicate rows detected.
2024-12-02 19:21:53,657 - INFO - =====Verifying 'record_number' uniqueness:=====
2024-12-02 19:21:53,657 - INFO - Columns in batch: ['record_number', 'region', 'residence_type', 'family_composition', 'sex', 'age', 'marital_status', 'student', 'country_of_birth', 'health', 'ethnic_group', 'religion', 'economic_activity', 'occupation', 'industry', 'hours_worked_per_week', 'approximate_social_grade']
2024-12-02 19:21:53,657 - INFO - Record_Number is unique.
2024-12-02 19:21:53,657 - INFO - =====validate_data_ranges:=====
2024-12-02 19:21:53,760 - INFO - 
Unique categories and counts per column:
2024-12-02 19:21:53,760 - INFO - residence_type: ['P', 'C'] (Total unique: 2)
2024-12-02 19:21:53,760 - INFO - family_composition: ['4', '3', '0', '2', '1', '5', 'X'] (Total unique: 7)
2024-12-02 19:21:53,760 - INFO - sex: [1, 2] (Total unique: 2)
2024-12-02 19:21:53,760 - INFO - age: [1, 2, 3, 4, 5, 6, 7, 8] (Total unique: 8)
2024-12-02 19:21:53,760 - INFO - marital_status: [1, 2, 3, 4, 5] (Total unique: 5)
2024-12-02 19:21:53,760 - INFO - student: [1, 2] (Total unique: 2)
2024-12-02 19:21:53,760 - INFO - country_of_birth: [1, 2] (Total unique: 2)
2024-12-02 19:21:53,760 - INFO - health: [1, 2, 3, 4, 5] (Total unique: 5)
2024-12-02 19:21:53,760 - INFO - ethnic_group: [1, 2, 3, 4, 5, 6] (Total unique: 6)
2024-12-02 19:21:53,760 - INFO - religion: [1, 2, 3, 4, 5, 6, 7, 8, 9] (Total unique: 9)
2024-12-02 19:21:53,761 - INFO - economic_activity: ['4', '7', '3', '2', 'X', '1', '8', '6', '5', '9'] (Total unique: 10)
2024-12-02 19:21:53,761 - INFO - occupation: ['3', '4', '7', '2', 'X', '1', '8', '6', '5', '9'] (Total unique: 10)
2024-12-02 19:21:53,761 - INFO - industry: ['4', '7', '3', '13', '2', '1', '8', '6', '5', 'X', '12', '10', '11', '9'] (Total unique: 14)
2024-12-02 19:21:53,761 - INFO - hours_worked_per_week: ['4', '3', '2', '1', 'X'] (Total unique: 5)
2024-12-02 19:21:53,761 - INFO - approximate_social_grade: ['3', '4', '2', '1', 'X'] (Total unique: 5)
2024-12-02 19:21:53,761 - INFO - 
All data ranges validated.
2024-12-02 19:21:53,761 - INFO - Starting data cleaning process...
2024-12-02 19:21:53,772 - INFO - Processing batch 1...
2024-12-02 19:21:53,772 - INFO - =====Checking for missing value:=====
2024-12-02 19:21:53,775 - INFO - No missing values detected.
2024-12-02 19:21:53,775 - INFO - =====Checking for duplicate rows:=====
2024-12-02 19:21:53,779 - INFO - No duplicate rows detected.
2024-12-02 19:21:53,792 - INFO -       record_number     region residence_type family_composition  sex  age  marital_status  ...  ethnic_group  religion  economic_activity  occupation  industry hours_worked_per_week approximate_social_grade
20               21  S92000003              P                  5    2    2               1  ...             1         2                  6           X         X                     X                        2
47               48  S92000003              P                  0    1    2               1  ...             1         1                  6           X         X                     X                        2
48               49  S92000003              P                  0    1    3               2  ...             4         2                  6           2         8                     X                        2
85               86  S92000003              P                  1    1    2               1  ...             1         2                  6           X         X                     X                        1
88               89  S92000003              P                  1    1    3               2  ...             1         2                  6           2        10                     X                        2
...             ...        ...            ...                ...  ...  ...             ...  ...           ...       ...                ...         ...       ...                   ...                      ...
8818           8819  S92000003              P                  1    2    2               1  ...             1         2                  6           X         X                     X                        4
8875           8876  S92000003              P                  1    2    2               1  ...             1         1                  6           X         X                     X                        2
8886           8887  S92000003              P                  4    2    2               1  ...             1         1                  6           X         X                     X                        1
8906           8907  S92000003              P                  4    1    2               1  ...             1         2                  6           X         X                     X                        4
8930           8931  S92000003              P                  1    1    2               1  ...             1         1                  6           7         4                     X                        2

[372 rows x 17 columns]
2024-12-02 19:21:53,797 - INFO - Rule 1: Found 372 rows to delete, saved to data/rule_1_deleted_data.csv
2024-12-02 19:21:53,798 - INFO - Rule 2: No rows to delete
2024-12-02 19:21:53,802 - INFO - Rule 3: Found 123 rows to delete, saved to data/rule_3_deleted_data.csv
2024-12-02 19:21:53,807 - INFO - Rule 4: Found 327 rows to delete, saved to data/rule_4_deleted_data.csv
2024-12-02 19:21:53,809 - INFO - Rule 5: No rows to delete
2024-12-02 19:21:53,813 - INFO - Rule 6: Found 123 rows to delete, saved to data/rule_6_deleted_data.csv
2024-12-02 19:21:53,815 - INFO - =====validate_data_ranges:=====
2024-12-02 19:21:53,886 - INFO - 
Unique categories and counts per column:
2024-12-02 19:21:53,886 - INFO - residence_type: ['P', 'C'] (Total unique: 2)
2024-12-02 19:21:53,886 - INFO - family_composition: ['4', '3', '0', '2', '1', '5', 'X'] (Total unique: 7)
2024-12-02 19:21:53,887 - INFO - sex: [1, 2] (Total unique: 2)
2024-12-02 19:21:53,887 - INFO - age: [1, 2, 3, 4, 5, 6, 7, 8] (Total unique: 8)
2024-12-02 19:21:53,887 - INFO - marital_status: [1, 2, 3, 4, 5] (Total unique: 5)
2024-12-02 19:21:53,887 - INFO - student: [1, 2] (Total unique: 2)
2024-12-02 19:21:53,887 - INFO - country_of_birth: [1, 2] (Total unique: 2)
2024-12-02 19:21:53,887 - INFO - health: [1, 2, 3, 4, 5] (Total unique: 5)
2024-12-02 19:21:53,887 - INFO - ethnic_group: [1, 2, 3, 4, 5, 6] (Total unique: 6)
2024-12-02 19:21:53,887 - INFO - religion: [1, 2, 3, 4, 5, 6, 7, 8, 9] (Total unique: 9)
2024-12-02 19:21:53,887 - INFO - economic_activity: ['4', '7', '3', '2', 'X', '1', '8', '6', '5', '9'] (Total unique: 10)
2024-12-02 19:21:53,887 - INFO - occupation: ['3', '4', '7', '2', 'X', '1', '8', '6', '5', '9'] (Total unique: 10)
2024-12-02 19:21:53,887 - INFO - industry: ['4', '7', '3', '13', '2', '1', '8', '6', '5', 'X', '12', '10', '11', '9'] (Total unique: 14)
2024-12-02 19:21:53,887 - INFO - hours_worked_per_week: ['4', '3', '2', '1', 'X'] (Total unique: 5)
2024-12-02 19:21:53,887 - INFO - approximate_social_grade: ['3', '4', '2', '1', 'X'] (Total unique: 5)
2024-12-02 19:21:53,887 - INFO - 
All data ranges validated.
2024-12-02 19:21:53,887 - INFO - =====Verifying 'record_number' uniqueness:=====
2024-12-02 19:21:53,887 - INFO - Columns in batch: ['record_number', 'region', 'residence_type', 'family_composition', 'sex', 'age', 'marital_status', 'student', 'country_of_birth', 'health', 'ethnic_group', 'religion', 'economic_activity', 'occupation', 'industry', 'hours_worked_per_week', 'approximate_social_grade']
2024-12-02 19:21:53,887 - INFO - Record_Number is unique.
2024-12-02 19:21:53,889 - INFO - 'record_number' column reset.
2024-12-02 19:21:53,917 - INFO - Batch 1 cleaned and saved.
2024-12-02 19:21:53,920 - INFO - Progress saved to /cs/home/sz92/Documents/CS5002/P3/code/progress.json.
2024-12-02 19:21:53,932 - INFO - Processing batch 2...
2024-12-02 19:21:53,932 - INFO - =====Checking for missing value:=====
2024-12-02 19:21:53,936 - INFO - No missing values detected.
2024-12-02 19:21:53,936 - INFO - =====Checking for duplicate rows:=====
2024-12-02 19:21:53,940 - INFO - No duplicate rows detected.
2024-12-02 19:21:53,953 - INFO -        record_number     region residence_type family_composition  sex  age  marital_status  ...  ethnic_group  religion  economic_activity  occupation  industry hours_worked_per_week approximate_social_grade
9004            9005  S92000003              P                  0    2    2               1  ...             1         9                  6           8         4                     X                        2
9007            9008  S92000003              P                  0    1    3               1  ...             1         1                  6           X         X                     X                        2
9010            9011  S92000003              P                  0    2    2               1  ...             3         1                  6           9         5                     X                        2
9014            9015  S92000003              P                  0    1    2               1  ...             1         1                  6           2         6                     X                        2
9026            9027  S92000003              P                  2    2    3               1  ...             1         1                  6           9         5                     X                        2
...              ...        ...            ...                ...  ...  ...             ...  ...           ...       ...                ...         ...       ...                   ...                      ...
17904          17905  S92000003              P                  4    2    2               1  ...             1         1                  6           X         X                     X                        2
17952          17953  S92000003              P                  1    2    2               1  ...             1         1                  6           X         X                     X                        2
17968          17969  S92000003              P                  1    1    2               1  ...             1         2                  6           3         8                     X                        1
17976          17977  S92000003              P                  1    1    2               1  ...             1         2                  6           X         X                     X                        2
17981          17982  S92000003              P                  4    2    2               1  ...             1         1                  6           X         X                     X                        3

[340 rows x 17 columns]
2024-12-02 19:21:53,959 - INFO - Rule 1: Found 340 rows to delete, saved to data/rule_1_deleted_data.csv
2024-12-02 19:21:53,960 - INFO - Rule 2: No rows to delete
2024-12-02 19:21:53,965 - INFO - Rule 3: Found 115 rows to delete, saved to data/rule_3_deleted_data.csv
2024-12-02 19:21:53,981 - INFO - Rule 4: Found 344 rows to delete, saved to data/rule_4_deleted_data.csv
2024-12-02 19:21:53,986 - INFO - Rule 5: No rows to delete
2024-12-02 19:21:53,995 - INFO - Rule 6: Found 115 rows to delete, saved to data/rule_6_deleted_data.csv
2024-12-02 19:21:54,000 - INFO - =====validate_data_ranges:=====
2024-12-02 19:21:54,088 - INFO - 
Unique categories and counts per column:
2024-12-02 19:21:54,088 - INFO - residence_type: ['P', 'C'] (Total unique: 2)
2024-12-02 19:21:54,088 - INFO - family_composition: ['4', '3', '0', '2', '1', '5', 'X'] (Total unique: 7)
2024-12-02 19:21:54,088 - INFO - sex: [1, 2] (Total unique: 2)
2024-12-02 19:21:54,089 - INFO - age: [1, 2, 3, 4, 5, 6, 7, 8] (Total unique: 8)
2024-12-02 19:21:54,089 - INFO - marital_status: [1, 2, 3, 4, 5] (Total unique: 5)
2024-12-02 19:21:54,089 - INFO - student: [1, 2] (Total unique: 2)
2024-12-02 19:21:54,089 - INFO - country_of_birth: [1, 2] (Total unique: 2)
2024-12-02 19:21:54,089 - INFO - health: [1, 2, 3, 4, 5] (Total unique: 5)
2024-12-02 19:21:54,089 - INFO - ethnic_group: [1, 2, 3, 4, 5, 6] (Total unique: 6)
2024-12-02 19:21:54,089 - INFO - religion: [1, 2, 3, 4, 5, 6, 7, 8, 9] (Total unique: 9)
2024-12-02 19:21:54,089 - INFO - economic_activity: ['7', '4', '3', '2', '1', '8', '6', '5', 'X', '9'] (Total unique: 10)
2024-12-02 19:21:54,089 - INFO - occupation: ['7', '3', '4', '2', '1', '8', '6', '5', 'X', '9'] (Total unique: 10)
2024-12-02 19:21:54,089 - INFO - industry: ['4', '3', '7', '2', 'X', '1', '8', '6', '5', '13', '12', '10', '11', '9'] (Total unique: 14)
2024-12-02 19:21:54,089 - INFO - hours_worked_per_week: ['4', '3', '2', '1', 'X'] (Total unique: 5)
2024-12-02 19:21:54,089 - INFO - approximate_social_grade: ['4', '3', '2', '1', 'X'] (Total unique: 5)
2024-12-02 19:21:54,089 - INFO - 
All data ranges validated.
2024-12-02 19:21:54,089 - INFO - =====Verifying 'record_number' uniqueness:=====
2024-12-02 19:21:54,089 - INFO - Columns in batch: ['record_number', 'region', 'residence_type', 'family_composition', 'sex', 'age', 'marital_status', 'student', 'country_of_birth', 'health', 'ethnic_group', 'religion', 'economic_activity', 'occupation', 'industry', 'hours_worked_per_week', 'approximate_social_grade']
2024-12-02 19:21:54,090 - INFO - Record_Number is unique.
2024-12-02 19:21:54,092 - INFO - 'record_number' column reset.
2024-12-02 19:21:54,120 - INFO - Batch 2 cleaned and saved.
2024-12-02 19:21:54,123 - INFO - Progress saved to /cs/home/sz92/Documents/CS5002/P3/code/progress.json.
2024-12-02 19:21:54,136 - INFO - Processing batch 3...
2024-12-02 19:21:54,136 - INFO - =====Checking for missing value:=====
2024-12-02 19:21:54,140 - INFO - No missing values detected.
2024-12-02 19:21:54,140 - INFO - =====Checking for duplicate rows:=====
2024-12-02 19:21:54,145 - INFO - No duplicate rows detected.
2024-12-02 19:21:54,160 - INFO -        record_number     region residence_type family_composition  sex  age  marital_status  ...  ethnic_group  religion  economic_activity  occupation  industry hours_worked_per_week approximate_social_grade
18012          18013  S92000003              P                  2    1    2               1  ...             1         2                  6           X         X                     X                        3
18032          18033  S92000003              P                  1    1    3               1  ...             1         1                  6           9         4                     X                        3
18058          18059  S92000003              P                  1    1    2               1  ...             1         2                  6           X         X                     X                        4
18131          18132  S92000003              P                  1    1    2               1  ...             1         9                  6           X         X                     X                        1
18142          18143  S92000003              P                  0    2    5               1  ...             1         2                  6           3        13                     X                        2
...              ...        ...            ...                ...  ...  ...             ...  ...           ...       ...                ...         ...       ...                   ...                      ...
26889          26890  S92000003              P                  1    1    2               1  ...             1         2                  6           9        12                     X                        2
26905          26906  S92000003              P                  4    2    2               1  ...             1         1                  6           X         X                     X                        2
26919          26920  S92000003              P                  1    1    2               1  ...             1         2                  6           X         X                     X                        3
26928          26929  S92000003              P                  1    1    2               1  ...             1         2                  6           X         X                     X                        3
26982          26983  S92000003              P                  4    2    6               5  ...             1         9                  6           5         3                     X                        2

[371 rows x 17 columns]
2024-12-02 19:21:54,164 - INFO - Rule 1: Found 371 rows to delete, saved to data/rule_1_deleted_data.csv
2024-12-02 19:21:54,165 - INFO - Rule 2: No rows to delete
2024-12-02 19:21:54,170 - INFO - Rule 3: Found 124 rows to delete, saved to data/rule_3_deleted_data.csv
2024-12-02 19:21:54,177 - INFO - Rule 4: Found 359 rows to delete, saved to data/rule_4_deleted_data.csv
2024-12-02 19:21:54,182 - INFO - Rule 5: No rows to delete
2024-12-02 19:21:54,191 - INFO - Rule 6: Found 124 rows to delete, saved to data/rule_6_deleted_data.csv
2024-12-02 19:21:54,195 - INFO - =====validate_data_ranges:=====
2024-12-02 19:21:54,274 - INFO - 
Unique categories and counts per column:
2024-12-02 19:21:54,274 - INFO - residence_type: ['P', 'C'] (Total unique: 2)
2024-12-02 19:21:54,274 - INFO - family_composition: ['4', '3', '0', '2', '1', '5', 'X'] (Total unique: 7)
2024-12-02 19:21:54,274 - INFO - sex: [1, 2] (Total unique: 2)
2024-12-02 19:21:54,274 - INFO - age: [1, 2, 3, 4, 5, 6, 7, 8] (Total unique: 8)
2024-12-02 19:21:54,274 - INFO - marital_status: [1, 2, 3, 4, 5] (Total unique: 5)
2024-12-02 19:21:54,274 - INFO - student: [1, 2] (Total unique: 2)
2024-12-02 19:21:54,274 - INFO - country_of_birth: [1, 2] (Total unique: 2)
2024-12-02 19:21:54,274 - INFO - health: [1, 2, 3, 4, 5] (Total unique: 5)
2024-12-02 19:21:54,274 - INFO - ethnic_group: [1, 2, 3, 4, 5, 6] (Total unique: 6)
2024-12-02 19:21:54,274 - INFO - religion: [1, 2, 3, 4, 5, 6, 7, 8, 9] (Total unique: 9)
2024-12-02 19:21:54,274 - INFO - economic_activity: ['7', '3', '4', '2', '1', '8', '6', '5', 'X', '9'] (Total unique: 10)
2024-12-02 19:21:54,274 - INFO - occupation: ['7', '4', '3', '2', 'X', '1', '8', '6', '5', '9'] (Total unique: 10)
2024-12-02 19:21:54,274 - INFO - industry: ['7', '4', '3', '13', '2', 'X', '1', '8', '6', '5', '9', '11', '10', '12'] (Total unique: 14)
2024-12-02 19:21:54,274 - INFO - hours_worked_per_week: ['4', '3', '2', '1', 'X'] (Total unique: 5)
2024-12-02 19:21:54,274 - INFO - approximate_social_grade: ['3', '4', '2', '1', 'X'] (Total unique: 5)
2024-12-02 19:21:54,274 - INFO - 
All data ranges validated.
2024-12-02 19:21:54,274 - INFO - =====Verifying 'record_number' uniqueness:=====
2024-12-02 19:21:54,274 - INFO - Columns in batch: ['record_number', 'region', 'residence_type', 'family_composition', 'sex', 'age', 'marital_status', 'student', 'country_of_birth', 'health', 'ethnic_group', 'religion', 'economic_activity', 'occupation', 'industry', 'hours_worked_per_week', 'approximate_social_grade']
2024-12-02 19:21:54,275 - INFO - Record_Number is unique.
2024-12-02 19:21:54,277 - INFO - 'record_number' column reset.
2024-12-02 19:21:54,303 - INFO - Batch 3 cleaned and saved.
2024-12-02 19:21:54,306 - INFO - Progress saved to /cs/home/sz92/Documents/CS5002/P3/code/progress.json.
2024-12-02 19:21:54,316 - INFO - Processing batch 4...
2024-12-02 19:21:54,316 - INFO - =====Checking for missing value:=====
2024-12-02 19:21:54,320 - INFO - No missing values detected.
2024-12-02 19:21:54,320 - INFO - =====Checking for duplicate rows:=====
2024-12-02 19:21:54,324 - INFO - No duplicate rows detected.
2024-12-02 19:21:54,338 - INFO -        record_number     region residence_type family_composition  sex  age  marital_status  ...  ethnic_group  religion  economic_activity  occupation  industry hours_worked_per_week approximate_social_grade
27017          27018  S92000003              P                  1    1    2               1  ...             1         1                  6           7         4                     X                        1
27085          27086  S92000003              P                  2    2    3               1  ...             1         1                  6           2        11                     X                        4
27104          27105  S92000003              P                  4    2    3               1  ...             1         2                  6           7         4                     X                        2
27187          27188  S92000003              P                  1    2    2               1  ...             1         2                  6           7         4                     X                        2
27206          27207  S92000003              P                  1    2    4               2  ...             1         2                  6           4        10                     X                        1
...              ...        ...            ...                ...  ...  ...             ...  ...           ...       ...                ...         ...       ...                   ...                      ...
35871          35872  S92000003              P                  4    1    2               1  ...             1         9                  6           X         X                     X                        2
35927          35928  S92000003              P                  1    2    2               1  ...             1         2                  6           X         X                     X                        2
35944          35945  S92000003              P                  1    2    2               1  ...             1         2                  6           X         X                     X                        1
35947          35948  S92000003              P                  1    2    2               1  ...             1         2                  6           X         X                     X                        1
35989          35990  S92000003              P                  4    2    2               1  ...             1         1                  6           1         4                     X                        2

[327 rows x 17 columns]
2024-12-02 19:21:54,342 - INFO - Rule 1: Found 327 rows to delete, saved to data/rule_1_deleted_data.csv
2024-12-02 19:21:54,344 - INFO - Rule 2: No rows to delete
2024-12-02 19:21:54,348 - INFO - Rule 3: Found 118 rows to delete, saved to data/rule_3_deleted_data.csv
2024-12-02 19:21:54,354 - INFO - Rule 4: Found 317 rows to delete, saved to data/rule_4_deleted_data.csv
2024-12-02 19:21:54,356 - INFO - Rule 5: No rows to delete
2024-12-02 19:21:54,361 - INFO - Rule 6: Found 118 rows to delete, saved to data/rule_6_deleted_data.csv
2024-12-02 19:21:54,362 - INFO - =====validate_data_ranges:=====
2024-12-02 19:21:54,434 - INFO - 
Unique categories and counts per column:
2024-12-02 19:21:54,434 - INFO - residence_type: ['P', 'C'] (Total unique: 2)
2024-12-02 19:21:54,435 - INFO - family_composition: ['4', '3', '0', '2', '1', '5', 'X'] (Total unique: 7)
2024-12-02 19:21:54,435 - INFO - sex: [1, 2] (Total unique: 2)
2024-12-02 19:21:54,435 - INFO - age: [1, 2, 3, 4, 5, 6, 7, 8] (Total unique: 8)
2024-12-02 19:21:54,435 - INFO - marital_status: [1, 2, 3, 4, 5] (Total unique: 5)
2024-12-02 19:21:54,435 - INFO - student: [1, 2] (Total unique: 2)
2024-12-02 19:21:54,435 - INFO - country_of_birth: [1, 2] (Total unique: 2)
2024-12-02 19:21:54,435 - INFO - health: [1, 2, 3, 4, 5] (Total unique: 5)
2024-12-02 19:21:54,435 - INFO - ethnic_group: [1, 2, 3, 4, 5, 6] (Total unique: 6)
2024-12-02 19:21:54,435 - INFO - religion: [1, 2, 3, 4, 5, 6, 7, 8, 9] (Total unique: 9)
2024-12-02 19:21:54,435 - INFO - economic_activity: ['4', '3', '7', '2', '1', '8', '6', '5', 'X', '9'] (Total unique: 10)
2024-12-02 19:21:54,435 - INFO - occupation: ['3', '4', '7', '2', 'X', '1', '8', '6', '5', '9'] (Total unique: 10)
2024-12-02 19:21:54,435 - INFO - industry: ['4', '7', '3', '13', '2', 'X', '1', '8', '6', '5', '9', '12', '10', '11'] (Total unique: 14)
2024-12-02 19:21:54,435 - INFO - hours_worked_per_week: ['4', '3', '2', '1', 'X'] (Total unique: 5)
2024-12-02 19:21:54,435 - INFO - approximate_social_grade: ['4', '3', '2', '1', 'X'] (Total unique: 5)
2024-12-02 19:21:54,435 - INFO - 
All data ranges validated.
2024-12-02 19:21:54,435 - INFO - =====Verifying 'record_number' uniqueness:=====
2024-12-02 19:21:54,435 - INFO - Columns in batch: ['record_number', 'region', 'residence_type', 'family_composition', 'sex', 'age', 'marital_status', 'student', 'country_of_birth', 'health', 'ethnic_group', 'religion', 'economic_activity', 'occupation', 'industry', 'hours_worked_per_week', 'approximate_social_grade']
2024-12-02 19:21:54,435 - INFO - Record_Number is unique.
2024-12-02 19:21:54,438 - INFO - 'record_number' column reset.
2024-12-02 19:21:54,465 - INFO - Batch 4 cleaned and saved.
2024-12-02 19:21:54,468 - INFO - Progress saved to /cs/home/sz92/Documents/CS5002/P3/code/progress.json.
2024-12-02 19:21:54,479 - INFO - Processing batch 5...
2024-12-02 19:21:54,479 - INFO - =====Checking for missing value:=====
2024-12-02 19:21:54,482 - INFO - No missing values detected.
2024-12-02 19:21:54,482 - INFO - =====Checking for duplicate rows:=====
2024-12-02 19:21:54,487 - INFO - No duplicate rows detected.
2024-12-02 19:21:54,498 - INFO -        record_number     region residence_type family_composition  sex  age  marital_status  ...  ethnic_group  religion  economic_activity  occupation  industry hours_worked_per_week approximate_social_grade
36006          36007  S92000003              P                  1    2    2               1  ...             1         1                  6           X         X                     X                        2
36017          36018  S92000003              P                  1    2    2               1  ...             1         1                  6           X         X                     X                        4
36074          36075  S92000003              P                  4    1    2               1  ...             1         2                  6           X         X                     X                        2
36124          36125  S92000003              P                  4    2    2               1  ...             1         1                  6           9         5                     X                        2
36127          36128  S92000003              P                  1    1    2               1  ...             1         2                  6           X         X                     X                        2
...              ...        ...            ...                ...  ...  ...             ...  ...           ...       ...                ...         ...       ...                   ...                      ...
44863          44864  S92000003              P                  0    1    3               1  ...             1         1                  6           9         5                     X                        2
44870          44871  S92000003              P                  2    2    2               1  ...             1         2                  6           7         4                     X                        3
44937          44938  S92000003              P                  4    2    2               1  ...             1         9                  6           X         X                     X                        2
44986          44987  S92000003              P                  4    1    2               1  ...             1         2                  6           X         X                     X                        2
44996          44997  S92000003              P                  1    1    2               1  ...             1         2                  6           X         X                     X                        3

[377 rows x 17 columns]
2024-12-02 19:21:54,503 - INFO - Rule 1: Found 377 rows to delete, saved to data/rule_1_deleted_data.csv
2024-12-02 19:21:54,504 - INFO - Rule 2: No rows to delete
2024-12-02 19:21:54,510 - INFO - Rule 3: Found 124 rows to delete, saved to data/rule_3_deleted_data.csv
2024-12-02 19:21:54,523 - INFO - Rule 4: Found 354 rows to delete, saved to data/rule_4_deleted_data.csv
2024-12-02 19:21:54,526 - INFO - Rule 5: No rows to delete
2024-12-02 19:21:54,534 - INFO - Rule 6: Found 124 rows to delete, saved to data/rule_6_deleted_data.csv
2024-12-02 19:21:54,538 - INFO - =====validate_data_ranges:=====
2024-12-02 19:21:54,614 - INFO - 
Unique categories and counts per column:
2024-12-02 19:21:54,614 - INFO - residence_type: ['P', 'C'] (Total unique: 2)
2024-12-02 19:21:54,614 - INFO - family_composition: ['3', '4', '0', '2', '1', '5', 'X'] (Total unique: 7)
2024-12-02 19:21:54,614 - INFO - sex: [1, 2] (Total unique: 2)
2024-12-02 19:21:54,614 - INFO - age: [1, 2, 3, 4, 5, 6, 7, 8] (Total unique: 8)
2024-12-02 19:21:54,614 - INFO - marital_status: [1, 2, 3, 4, 5] (Total unique: 5)
2024-12-02 19:21:54,614 - INFO - student: [1, 2] (Total unique: 2)
2024-12-02 19:21:54,614 - INFO - country_of_birth: [1, 2] (Total unique: 2)
2024-12-02 19:21:54,614 - INFO - health: [1, 2, 3, 4, 5] (Total unique: 5)
2024-12-02 19:21:54,614 - INFO - ethnic_group: [1, 2, 3, 4, 5, 6] (Total unique: 6)
2024-12-02 19:21:54,614 - INFO - religion: [1, 2, 3, 4, 5, 6, 7, 8, 9] (Total unique: 9)
2024-12-02 19:21:54,614 - INFO - economic_activity: ['3', '4', '7', '2', '1', '8', '6', '5', 'X', '9'] (Total unique: 10)
2024-12-02 19:21:54,614 - INFO - occupation: ['3', '4', '7', '2', 'X', '1', '8', '6', '5', '9'] (Total unique: 10)
2024-12-02 19:21:54,614 - INFO - industry: ['4', '3', '7', '13', '2', '1', '8', '6', '5', 'X', '12', '10', '11', '9'] (Total unique: 14)
2024-12-02 19:21:54,614 - INFO - hours_worked_per_week: ['4', '3', '2', '1', 'X'] (Total unique: 5)
2024-12-02 19:21:54,614 - INFO - approximate_social_grade: ['4', '3', '2', '1', 'X'] (Total unique: 5)
2024-12-02 19:21:54,614 - INFO - 
All data ranges validated.
2024-12-02 19:21:54,615 - INFO - =====Verifying 'record_number' uniqueness:=====
2024-12-02 19:21:54,615 - INFO - Columns in batch: ['record_number', 'region', 'residence_type', 'family_composition', 'sex', 'age', 'marital_status', 'student', 'country_of_birth', 'health', 'ethnic_group', 'religion', 'economic_activity', 'occupation', 'industry', 'hours_worked_per_week', 'approximate_social_grade']
2024-12-02 19:21:54,615 - INFO - Record_Number is unique.
2024-12-02 19:21:54,617 - INFO - 'record_number' column reset.
2024-12-02 19:21:54,643 - INFO - Batch 5 cleaned and saved.
2024-12-02 19:21:54,646 - INFO - Progress saved to /cs/home/sz92/Documents/CS5002/P3/code/progress.json.
2024-12-02 19:21:54,654 - INFO - Processing batch 6...
2024-12-02 19:21:54,654 - INFO - =====Checking for missing value:=====
2024-12-02 19:21:54,657 - INFO - No missing values detected.
2024-12-02 19:21:54,657 - INFO - =====Checking for duplicate rows:=====
2024-12-02 19:21:54,661 - INFO - No duplicate rows detected.
2024-12-02 19:21:54,673 - INFO -        record_number     region residence_type family_composition  sex  age  marital_status  ...  ethnic_group  religion  economic_activity  occupation  industry hours_worked_per_week approximate_social_grade
45024          45025  S92000003              P                  1    2    2               1  ...             1         1                  6           X         X                     X                        2
45030          45031  S92000003              P                  4    1    2               1  ...             1         1                  6           X         X                     X                        4
45047          45048  S92000003              P                  1    2    3               2  ...             1         1                  6           6        10                     X                        3
45072          45073  S92000003              P                  2    1    2               1  ...             2         1                  6           7         8                     X                        3
45124          45125  S92000003              P                  3    1    2               1  ...             1         2                  6           X         X                     X                        1
...              ...        ...            ...                ...  ...  ...             ...  ...           ...       ...                ...         ...       ...                   ...                      ...
53900          53901  S92000003              P                  1    2    2               1  ...             1         2                  6           X         X                     X                        4
53923          53924  S92000003              P                  2    1    2               1  ...             1         2                  6           X         X                     X                        4
53960          53961  S92000003              P                  4    1    2               1  ...             1         2                  6           X         X                     X                        4
53979          53980  S92000003              P                  1    2    2               1  ...             1         9                  6           7         4                     X                        3
53983          53984  S92000003              P                  3    1    2               1  ...             1         2                  6           X         X                     X                        4

[408 rows x 17 columns]
2024-12-02 19:21:54,678 - INFO - Rule 1: Found 408 rows to delete, saved to data/rule_1_deleted_data.csv
2024-12-02 19:21:54,680 - INFO - Rule 2: No rows to delete
2024-12-02 19:21:54,685 - INFO - Rule 3: Found 113 rows to delete, saved to data/rule_3_deleted_data.csv
2024-12-02 19:21:54,691 - INFO - Rule 4: Found 335 rows to delete, saved to data/rule_4_deleted_data.csv
2024-12-02 19:21:54,693 - INFO - Rule 5: No rows to delete
2024-12-02 19:21:54,697 - INFO - Rule 6: Found 113 rows to delete, saved to data/rule_6_deleted_data.csv
2024-12-02 19:21:54,699 - INFO - =====validate_data_ranges:=====
2024-12-02 19:21:54,768 - INFO - 
Unique categories and counts per column:
2024-12-02 19:21:54,768 - INFO - residence_type: ['P', 'C'] (Total unique: 2)
2024-12-02 19:21:54,768 - INFO - family_composition: ['4', '3', '0', '2', '1', '5', 'X'] (Total unique: 7)
2024-12-02 19:21:54,768 - INFO - sex: [1, 2] (Total unique: 2)
2024-12-02 19:21:54,768 - INFO - age: [1, 2, 3, 4, 5, 6, 7, 8] (Total unique: 8)
2024-12-02 19:21:54,768 - INFO - marital_status: [1, 2, 3, 4, 5] (Total unique: 5)
2024-12-02 19:21:54,768 - INFO - student: [1, 2] (Total unique: 2)
2024-12-02 19:21:54,768 - INFO - country_of_birth: [1, 2] (Total unique: 2)
2024-12-02 19:21:54,768 - INFO - health: [1, 2, 3, 4, 5] (Total unique: 5)
2024-12-02 19:21:54,768 - INFO - ethnic_group: [1, 2, 3, 4, 5, 6] (Total unique: 6)
2024-12-02 19:21:54,768 - INFO - religion: [1, 2, 3, 4, 5, 6, 7, 8, 9] (Total unique: 9)
2024-12-02 19:21:54,768 - INFO - economic_activity: ['3', '7', '4', '2', 'X', '1', '8', '6', '5', '9'] (Total unique: 10)
2024-12-02 19:21:54,768 - INFO - occupation: ['4', '3', '7', '2', '1', '8', '6', '5', 'X', '9'] (Total unique: 10)
2024-12-02 19:21:54,768 - INFO - industry: ['3', '4', '7', '13', '2', '1', '8', '6', '5', 'X', '12', '10', '11', '9'] (Total unique: 14)
2024-12-02 19:21:54,768 - INFO - hours_worked_per_week: ['4', '3', '2', '1', 'X'] (Total unique: 5)
2024-12-02 19:21:54,768 - INFO - approximate_social_grade: ['4', '3', '2', '1', 'X'] (Total unique: 5)
2024-12-02 19:21:54,768 - INFO - 
All data ranges validated.
2024-12-02 19:21:54,768 - INFO - =====Verifying 'record_number' uniqueness:=====
2024-12-02 19:21:54,768 - INFO - Columns in batch: ['record_number', 'region', 'residence_type', 'family_composition', 'sex', 'age', 'marital_status', 'student', 'country_of_birth', 'health', 'ethnic_group', 'religion', 'economic_activity', 'occupation', 'industry', 'hours_worked_per_week', 'approximate_social_grade']
2024-12-02 19:21:54,769 - INFO - Record_Number is unique.
2024-12-02 19:21:54,770 - INFO - 'record_number' column reset.
2024-12-02 19:21:54,797 - INFO - Batch 6 cleaned and saved.
2024-12-02 19:21:54,799 - INFO - Progress saved to /cs/home/sz92/Documents/CS5002/P3/code/progress.json.
2024-12-02 19:21:54,807 - INFO - Processing batch 7...
2024-12-02 19:21:54,807 - INFO - =====Checking for missing value:=====
2024-12-02 19:21:54,810 - INFO - No missing values detected.
2024-12-02 19:21:54,811 - INFO - =====Checking for duplicate rows:=====
2024-12-02 19:21:54,815 - INFO - No duplicate rows detected.
2024-12-02 19:21:54,827 - INFO -        record_number     region residence_type family_composition  sex  age  marital_status  ...  ethnic_group  religion  economic_activity  occupation  industry hours_worked_per_week approximate_social_grade
54010          54011  S92000003              P                  1    1    2               1  ...             1         2                  6           X         X                     X                        4
54023          54024  S92000003              P                  5    2    2               1  ...             1         9                  6           X         X                     X                        4
54132          54133  S92000003              P                  1    1    2               1  ...             1         2                  6           X         X                     X                        2
54137          54138  S92000003              P                  1    1    2               1  ...             1         1                  6           X         X                     X                        4
54153          54154  S92000003              P                  1    2    2               1  ...             1         1                  6           X         X                     X                        1
...              ...        ...            ...                ...  ...  ...             ...  ...           ...       ...                ...         ...       ...                   ...                      ...
62748          62749  S92000003              P                  4    2    2               1  ...             1         9                  6           X         X                     X                        1
62763          62764  S92000003              P                  0    1    2               1  ...             1         1                  6           7         2                     X                        2
62909          62910  S92000003              P                  0    1    2               1  ...             1         2                  6           9         5                     X                        2
62936          62937  S92000003              P                  0    1    2               1  ...             1         1                  6           8         8                     X                        2
62944          62945  S92000003              P                  1    1    2               1  ...             1         2                  6           X         X                     X                        2

[382 rows x 17 columns]
2024-12-02 19:21:54,833 - INFO - Rule 1: Found 382 rows to delete, saved to data/rule_1_deleted_data.csv
2024-12-02 19:21:54,834 - INFO - Rule 2: No rows to delete
2024-12-02 19:21:54,839 - INFO - Rule 3: Found 118 rows to delete, saved to data/rule_3_deleted_data.csv
2024-12-02 19:21:54,845 - INFO - Rule 4: Found 310 rows to delete, saved to data/rule_4_deleted_data.csv
2024-12-02 19:21:54,846 - INFO - Rule 5: No rows to delete
2024-12-02 19:21:54,851 - INFO - Rule 6: Found 118 rows to delete, saved to data/rule_6_deleted_data.csv
2024-12-02 19:21:54,853 - INFO - =====validate_data_ranges:=====
2024-12-02 19:21:54,922 - INFO - 
Unique categories and counts per column:
2024-12-02 19:21:54,922 - INFO - residence_type: ['P', 'C'] (Total unique: 2)
2024-12-02 19:21:54,922 - INFO - family_composition: ['4', '3', '0', '2', '1', '5', 'X'] (Total unique: 7)
2024-12-02 19:21:54,922 - INFO - sex: [1, 2] (Total unique: 2)
2024-12-02 19:21:54,922 - INFO - age: [1, 2, 3, 4, 5, 6, 7, 8] (Total unique: 8)
2024-12-02 19:21:54,922 - INFO - marital_status: [1, 2, 3, 4, 5] (Total unique: 5)
2024-12-02 19:21:54,922 - INFO - student: [1, 2] (Total unique: 2)
2024-12-02 19:21:54,922 - INFO - country_of_birth: [1, 2] (Total unique: 2)
2024-12-02 19:21:54,922 - INFO - health: [1, 2, 3, 4, 5] (Total unique: 5)
2024-12-02 19:21:54,922 - INFO - ethnic_group: [1, 2, 3, 4, 5, 6] (Total unique: 6)
2024-12-02 19:21:54,922 - INFO - religion: [1, 2, 3, 4, 5, 6, 7, 8, 9] (Total unique: 9)
2024-12-02 19:21:54,922 - INFO - economic_activity: ['3', '7', '4', '2', '1', '8', '6', '5', 'X', '9'] (Total unique: 10)
2024-12-02 19:21:54,922 - INFO - occupation: ['7', '4', '3', '2', '1', '8', '6', '5', 'X', '9'] (Total unique: 10)
2024-12-02 19:21:54,922 - INFO - industry: ['4', '7', '3', '13', '2', '1', '8', '6', '5', 'X', '12', '10', '11', '9'] (Total unique: 14)
2024-12-02 19:21:54,922 - INFO - hours_worked_per_week: ['4', '3', '2', '1', 'X'] (Total unique: 5)
2024-12-02 19:21:54,922 - INFO - approximate_social_grade: ['3', '4', '2', '1', 'X'] (Total unique: 5)
2024-12-02 19:21:54,922 - INFO - 
All data ranges validated.
2024-12-02 19:21:54,922 - INFO - =====Verifying 'record_number' uniqueness:=====
2024-12-02 19:21:54,922 - INFO - Columns in batch: ['record_number', 'region', 'residence_type', 'family_composition', 'sex', 'age', 'marital_status', 'student', 'country_of_birth', 'health', 'ethnic_group', 'religion', 'economic_activity', 'occupation', 'industry', 'hours_worked_per_week', 'approximate_social_grade']
2024-12-02 19:21:54,923 - INFO - Record_Number is unique.
2024-12-02 19:21:54,924 - INFO - 'record_number' column reset.
2024-12-02 19:21:54,950 - INFO - Batch 7 cleaned and saved.
2024-12-02 19:21:54,953 - INFO - Progress saved to /cs/home/sz92/Documents/CS5002/P3/code/progress.json.
2024-12-02 19:21:54,954 - INFO - Processing batch 8...
2024-12-02 19:21:54,954 - INFO - =====Checking for missing value:=====
2024-12-02 19:21:54,955 - INFO - No missing values detected.
2024-12-02 19:21:54,955 - INFO - =====Checking for duplicate rows:=====
2024-12-02 19:21:54,957 - INFO - No duplicate rows detected.
2024-12-02 19:21:54,972 - INFO -        record_number     region residence_type family_composition  sex  age  marital_status  ...  ethnic_group  religion  economic_activity  occupation  industry hours_worked_per_week approximate_social_grade
63092          63093  S92000003              P                  1    1    2               1  ...             1         1                  6           X         X                     X                        2
63106          63107  S92000003              P                  1    2    4               2  ...             1         2                  6           3         7                     X                        1
63112          63113  S92000003              P                  4    1    2               1  ...             1         1                  6           X         X                     X                        1
63124          63125  S92000003              P                  0    2    2               1  ...             1         1                  6           X         X                     X                        2
63127          63128  S92000003              P                  0    2    3               1  ...             1         2                  6           2        10                     X                        2
63129          63130  S92000003              P                  0    2    2               1  ...             1         2                  6           9        12                     X                        1
63139          63140  S92000003              P                  1    2    4               2  ...             1         1                  6           6        10                     X                        2
63140          63141  S92000003              P                  2    1    2               1  ...             1         1                  6           X         X                     X                        1
63142          63143  S92000003              P                  1    1    3               2  ...             1         2                  6           2         6                     X                        2
63152          63153  S92000003              P                  1    2    2               1  ...             1         2                  6           7         4                     X                        2
63159          63160  S92000003              P                  0    1    2               1  ...             1         1                  6           9         4                     X                        2
63163          63164  S92000003              P                  1    1    2               1  ...             1         1                  6           9         5                     X                        1
63168          63169  S92000003              P                  0    1    4               1  ...             4         2                  6           7         8                     X                        2
63171          63172  S92000003              P                  1    2    2               1  ...             1         2                  6           X         X                     X                        2
63235          63236  S92000003              P                  4    2    2               1  ...             1         1                  6           X         X                     X                        4
63241          63242  S92000003              P                  1    2    2               1  ...             1         2                  6           X         X                     X                        3
63295          63296  S92000003              P                  1    1    2               1  ...             1         2                  6           7         4                     X                        2
63317          63318  S92000003              P                  0    2    2               1  ...             3         1                  6           X         X                     X                        2
63350          63351  S92000003              P                  1    1    2               1  ...             1         1                  6           X         X                     X                        4
63366          63367  S92000003              P                  4    2    2               1  ...             1         1                  6           X         X                     X                        2
63383          63384  S92000003              P                  1    1    2               1  ...             1         2                  6           X         X                     X                        3

[21 rows x 17 columns]
2024-12-02 19:21:54,975 - INFO - Rule 1: Found 21 rows to delete, saved to data/rule_1_deleted_data.csv
2024-12-02 19:21:54,976 - INFO - Rule 2: No rows to delete
2024-12-02 19:21:54,980 - INFO - Rule 3: Found 8 rows to delete, saved to data/rule_3_deleted_data.csv
2024-12-02 19:21:54,984 - INFO - Rule 4: Found 16 rows to delete, saved to data/rule_4_deleted_data.csv
2024-12-02 19:21:54,985 - INFO - Rule 5: No rows to delete
2024-12-02 19:21:54,989 - INFO - Rule 6: Found 8 rows to delete, saved to data/rule_6_deleted_data.csv
2024-12-02 19:21:54,991 - INFO - =====validate_data_ranges:=====
2024-12-02 19:21:55,004 - INFO - 
Unique categories and counts per column:
2024-12-02 19:21:55,004 - INFO - residence_type: ['P', 'C'] (Total unique: 2)
2024-12-02 19:21:55,004 - INFO - family_composition: ['4', '3', '0', '2', '1', '5', 'X'] (Total unique: 7)
2024-12-02 19:21:55,004 - INFO - sex: [1, 2] (Total unique: 2)
2024-12-02 19:21:55,004 - INFO - age: [1, 2, 3, 4, 5, 6, 7, 8] (Total unique: 8)
2024-12-02 19:21:55,004 - INFO - marital_status: [1, 2, 3, 4, 5] (Total unique: 5)
2024-12-02 19:21:55,004 - INFO - student: [1, 2] (Total unique: 2)
2024-12-02 19:21:55,004 - INFO - country_of_birth: [1, 2] (Total unique: 2)
2024-12-02 19:21:55,004 - INFO - health: [1, 2, 3, 4] (Total unique: 4)
2024-12-02 19:21:55,004 - INFO - ethnic_group: [1, 3, 4] (Total unique: 3)
2024-12-02 19:21:55,004 - INFO - religion: [1, 2, 3, 4, 5, 6, 8, 9] (Total unique: 8)
2024-12-02 19:21:55,004 - INFO - economic_activity: ['7', '3', '4', '2', '1', '8', '6', '5', 'X', '9'] (Total unique: 10)
2024-12-02 19:21:55,004 - INFO - occupation: ['7', '3', '4', '2', '1', '8', '6', '5', 'X', '9'] (Total unique: 10)
2024-12-02 19:21:55,004 - INFO - industry: ['4', '13', '3', '7', '2', '1', '8', '6', '5', 'X', '12', '10', '11', '9'] (Total unique: 14)
2024-12-02 19:21:55,004 - INFO - hours_worked_per_week: ['4', '3', '2', '1', 'X'] (Total unique: 5)
2024-12-02 19:21:55,004 - INFO - approximate_social_grade: ['4', '3', '2', '1', 'X'] (Total unique: 5)
2024-12-02 19:21:55,004 - INFO - 
All data ranges validated.
2024-12-02 19:21:55,004 - INFO - =====Verifying 'record_number' uniqueness:=====
2024-12-02 19:21:55,004 - INFO - Columns in batch: ['record_number', 'region', 'residence_type', 'family_composition', 'sex', 'age', 'marital_status', 'student', 'country_of_birth', 'health', 'ethnic_group', 'religion', 'economic_activity', 'occupation', 'industry', 'hours_worked_per_week', 'approximate_social_grade']
2024-12-02 19:21:55,005 - INFO - Record_Number is unique.
2024-12-02 19:21:55,006 - INFO - 'record_number' column reset.
2024-12-02 19:21:55,009 - INFO - Batch 8 cleaned and saved.
2024-12-02 19:21:55,012 - INFO - Progress saved to /cs/home/sz92/Documents/CS5002/P3/code/progress.json.
2024-12-02 19:21:55,012 - INFO - Data cleaning process completed. Total rows processed: 63388
2024-12-02 19:21:55,012 - INFO - Rows to drop: 5297
2024-12-02 19:21:55,012 - INFO - Cleaned data saved to ../data/output.csv
2024-12-02 19:21:55,012 - INFO - Progress file removed. Data processing complete.
2024-12-02 19:21:55,579 - INFO - Data clean code test passed. Congratulations! Result deatils in log/data_cleaning.log
2024-12-02 19:21:55,610 - INFO - =====Checking data types:=====
2024-12-02 19:21:55,619 - INFO - Batch info:
None
2024-12-02 19:21:55,658 - INFO - =====Checking for missing value:=====
2024-12-02 19:21:55,660 - INFO - No missing values detected.
2024-12-02 19:21:55,661 - INFO - =====Checking for duplicate rows:=====
2024-12-02 19:21:55,665 - INFO - No duplicate rows detected.
2024-12-02 19:21:55,665 - INFO - =====Verifying 'record_number' uniqueness:=====
2024-12-02 19:21:55,665 - INFO - Columns in batch: ['record_number', 'region', 'residence_type', 'family_composition', 'sex', 'age', 'marital_status', 'student', 'country_of_birth', 'health', 'ethnic_group', 'religion', 'economic_activity', 'occupation', 'industry', 'hours_worked_per_week', 'approximate_social_grade']
2024-12-02 19:21:55,665 - INFO - Record_Number is unique.
2024-12-02 19:21:55,665 - INFO - =====validate_data_ranges:=====
2024-12-02 19:21:55,734 - INFO - 
Unique categories and counts per column:
2024-12-02 19:21:55,734 - INFO - residence_type: ['P', 'C'] (Total unique: 2)
2024-12-02 19:21:55,734 - INFO - family_composition: ['4', '3', '0', '2', '1', '5', 'X'] (Total unique: 7)
2024-12-02 19:21:55,734 - INFO - sex: [1, 2] (Total unique: 2)
2024-12-02 19:21:55,734 - INFO - age: [1, 2, 3, 4, 5, 6, 7, 8] (Total unique: 8)
2024-12-02 19:21:55,734 - INFO - marital_status: [1, 2, 3, 4, 5] (Total unique: 5)
2024-12-02 19:21:55,734 - INFO - student: [1, 2] (Total unique: 2)
2024-12-02 19:21:55,734 - INFO - country_of_birth: [1, 2] (Total unique: 2)
2024-12-02 19:21:55,734 - INFO - health: [1, 2, 3, 4, 5] (Total unique: 5)
2024-12-02 19:21:55,734 - INFO - ethnic_group: [1, 2, 3, 4, 5, 6] (Total unique: 6)
2024-12-02 19:21:55,734 - INFO - religion: [1, 2, 3, 4, 5, 6, 7, 8, 9] (Total unique: 9)
2024-12-02 19:21:55,734 - INFO - economic_activity: ['7', '4', '3', '2', '1', '8', '6', '5', 'X', '9'] (Total unique: 10)
2024-12-02 19:21:55,734 - INFO - occupation: ['7', '3', '4', '2', '1', '8', '6', '5', 'X', '9'] (Total unique: 10)
2024-12-02 19:21:55,734 - INFO - industry: ['4', '3', '7', '2', 'X', '1', '8', '6', '5', '13', '12', '10', '11', '9'] (Total unique: 14)
2024-12-02 19:21:55,734 - INFO - hours_worked_per_week: ['4', '3', '2', '1', 'X'] (Total unique: 5)
2024-12-02 19:21:55,734 - INFO - approximate_social_grade: ['4', '3', '2', '1', 'X'] (Total unique: 5)
2024-12-02 19:21:55,734 - INFO - 
All data ranges validated.
2024-12-02 19:21:55,734 - INFO - Starting data cleaning process...
2024-12-02 19:21:55,757 - INFO - Processing batch 1...
2024-12-02 19:21:55,757 - INFO - =====Checking for missing value:=====
2024-12-02 19:21:55,758 - INFO - No missing values detected.
2024-12-02 19:21:55,758 - INFO - =====Checking for duplicate rows:=====
2024-12-02 19:21:55,758 - INFO - No duplicate rows detected.
2024-12-02 19:22:50,789 - WARNING - Progress file progress.json not found. Starting from the beginning.
2024-12-02 19:22:50,867 - INFO - Loaded data from row 0.
2024-12-02 19:22:50,867 - INFO - Columns in DataFrame: ['record_number', 'region', 'residence_type', 'family_composition', 'sex', 'age', 'marital_status', 'student', 'country_of_birth', 'health', 'ethnic_group', 'religion', 'economic_activity', 'occupation', 'industry', 'hours_worked_per_week', 'approximate_social_grade']
2024-12-02 19:22:50,867 - WARNING - Progress file progress.json not found. Starting from the beginning.
2024-12-02 19:22:50,922 - INFO - =====Checking data types:=====
2024-12-02 19:22:50,943 - INFO - Batch info:
None
2024-12-02 19:22:51,201 - INFO - =====Checking for missing value:=====
2024-12-02 19:22:51,218 - INFO - No missing values detected.
2024-12-02 19:22:51,218 - INFO - =====Checking for duplicate rows:=====
2024-12-02 19:22:51,241 - INFO - No duplicate rows detected.
2024-12-02 19:22:51,241 - INFO - =====Verifying 'record_number' uniqueness:=====
2024-12-02 19:22:51,241 - INFO - Columns in batch: ['record_number', 'region', 'residence_type', 'family_composition', 'sex', 'age', 'marital_status', 'student', 'country_of_birth', 'health', 'ethnic_group', 'religion', 'economic_activity', 'occupation', 'industry', 'hours_worked_per_week', 'approximate_social_grade']
2024-12-02 19:22:51,242 - INFO - Record_Number is unique.
2024-12-02 19:22:51,242 - INFO - =====validate_data_ranges:=====
2024-12-02 19:22:51,722 - INFO - 
Unique categories and counts per column:
2024-12-02 19:22:51,722 - INFO - residence_type: ['P', 'C'] (Total unique: 2)
2024-12-02 19:22:51,722 - INFO - family_composition: ['X', '2', '1', '3', '0', '4', '5'] (Total unique: 7)
2024-12-02 19:22:51,722 - INFO - sex: [1, 2] (Total unique: 2)
2024-12-02 19:22:51,722 - INFO - age: [1, 2, 3, 4, 5, 6, 7, 8] (Total unique: 8)
2024-12-02 19:22:51,722 - INFO - marital_status: [1, 2, 3, 4, 5] (Total unique: 5)
2024-12-02 19:22:51,722 - INFO - student: [1, 2] (Total unique: 2)
2024-12-02 19:22:51,722 - INFO - country_of_birth: [1, 2] (Total unique: 2)
2024-12-02 19:22:51,722 - INFO - health: [1, 2, 3, 4, 5] (Total unique: 5)
2024-12-02 19:22:51,722 - INFO - ethnic_group: [1, 2, 3, 4, 5, 6] (Total unique: 6)
2024-12-02 19:22:51,722 - INFO - religion: [1, 2, 3, 4, 5, 6, 7, 8, 9] (Total unique: 9)
2024-12-02 19:22:51,722 - INFO - economic_activity: ['9', 'X', '2', '1', '7', '3', '8', '4', '5', '6'] (Total unique: 10)
2024-12-02 19:22:51,722 - INFO - occupation: ['9', 'X', '2', '1', '7', '3', '8', '4', '5', '6'] (Total unique: 10)
2024-12-02 19:22:51,722 - INFO - industry: ['13', '9', 'X', '2', '1', '10', '12', '7', '11', '3', '8', '4', '5', '6'] (Total unique: 14)
2024-12-02 19:22:51,722 - INFO - hours_worked_per_week: ['X', '2', '1', '3', '4'] (Total unique: 5)
2024-12-02 19:22:51,722 - INFO - approximate_social_grade: ['X', '2', '1', '3', '4'] (Total unique: 5)
2024-12-02 19:22:51,722 - INFO - 
All data ranges validated.
2024-12-02 19:22:51,722 - INFO - Starting data cleaning process...
2024-12-02 19:22:51,775 - INFO - Processing batch 1...
2024-12-02 19:22:51,775 - INFO - =====Checking for missing value:=====
2024-12-02 19:22:51,792 - INFO - No missing values detected.
2024-12-02 19:22:51,792 - INFO - =====Checking for duplicate rows:=====
2024-12-02 19:22:51,813 - INFO - No duplicate rows detected.
2024-12-02 19:22:51,829 - INFO -        record_number     region residence_type family_composition  sex  age  marital_status  ...  ethnic_group  religion  economic_activity  occupation  industry hours_worked_per_week approximate_social_grade
20                21  S92000003              P                  5    2    2               1  ...             1         2                  6           X         X                     X                        2
47                48  S92000003              P                  0    1    2               1  ...             1         1                  6           X         X                     X                        2
48                49  S92000003              P                  0    1    3               2  ...             4         2                  6           2         8                     X                        2
85                86  S92000003              P                  1    1    2               1  ...             1         2                  6           X         X                     X                        1
88                89  S92000003              P                  1    1    3               2  ...             1         2                  6           2        10                     X                        2
...              ...        ...            ...                ...  ...  ...             ...  ...           ...       ...                ...         ...       ...                   ...                      ...
63295          63296  S92000003              P                  1    1    2               1  ...             1         2                  6           7         4                     X                        2
63317          63318  S92000003              P                  0    2    2               1  ...             3         1                  6           X         X                     X                        2
63350          63351  S92000003              P                  1    1    2               1  ...             1         1                  6           X         X                     X                        4
63366          63367  S92000003              P                  4    2    2               1  ...             1         1                  6           X         X                     X                        2
63383          63384  S92000003              P                  1    1    2               1  ...             1         2                  6           X         X                     X                        3

[2598 rows x 17 columns]
2024-12-02 19:22:51,839 - INFO - Rule 1: Found 2598 rows to delete, saved to data/rule_1_deleted_data.csv
2024-12-02 19:22:51,846 - INFO - Rule 2: No rows to delete
2024-12-02 19:22:51,857 - INFO - Rule 3: Found 843 rows to delete, saved to data/rule_3_deleted_data.csv
2024-12-02 19:22:51,872 - INFO - Rule 4: Found 2362 rows to delete, saved to data/rule_4_deleted_data.csv
2024-12-02 19:22:51,878 - INFO - Rule 5: No rows to delete
2024-12-02 19:22:51,889 - INFO - Rule 6: Found 843 rows to delete, saved to data/rule_6_deleted_data.csv
2024-12-02 19:22:51,893 - INFO - =====validate_data_ranges:=====
2024-12-02 19:22:52,340 - INFO - 
Unique categories and counts per column:
2024-12-02 19:22:52,341 - INFO - residence_type: ['P', 'C'] (Total unique: 2)
2024-12-02 19:22:52,341 - INFO - family_composition: ['X', '2', '1', '3', '0', '4', '5'] (Total unique: 7)
2024-12-02 19:22:52,341 - INFO - sex: [1, 2] (Total unique: 2)
2024-12-02 19:22:52,341 - INFO - age: [1, 2, 3, 4, 5, 6, 7, 8] (Total unique: 8)
2024-12-02 19:22:52,341 - INFO - marital_status: [1, 2, 3, 4, 5] (Total unique: 5)
2024-12-02 19:22:52,341 - INFO - student: [1, 2] (Total unique: 2)
2024-12-02 19:22:52,341 - INFO - country_of_birth: [1, 2] (Total unique: 2)
2024-12-02 19:22:52,341 - INFO - health: [1, 2, 3, 4, 5] (Total unique: 5)
2024-12-02 19:22:52,341 - INFO - ethnic_group: [1, 2, 3, 4, 5, 6] (Total unique: 6)
2024-12-02 19:22:52,341 - INFO - religion: [1, 2, 3, 4, 5, 6, 7, 8, 9] (Total unique: 9)
2024-12-02 19:22:52,341 - INFO - economic_activity: ['9', 'X', '2', '1', '7', '3', '8', '4', '5', '6'] (Total unique: 10)
2024-12-02 19:22:52,341 - INFO - occupation: ['9', 'X', '2', '1', '7', '3', '8', '4', '5', '6'] (Total unique: 10)
2024-12-02 19:22:52,341 - INFO - industry: ['13', '9', 'X', '2', '1', '10', '12', '7', '11', '3', '8', '4', '5', '6'] (Total unique: 14)
2024-12-02 19:22:52,341 - INFO - hours_worked_per_week: ['X', '2', '1', '3', '4'] (Total unique: 5)
2024-12-02 19:22:52,341 - INFO - approximate_social_grade: ['X', '2', '1', '3', '4'] (Total unique: 5)
2024-12-02 19:22:52,341 - INFO - 
All data ranges validated.
2024-12-02 19:22:52,341 - INFO - =====Verifying 'record_number' uniqueness:=====
2024-12-02 19:22:52,341 - INFO - Columns in batch: ['record_number', 'region', 'residence_type', 'family_composition', 'sex', 'age', 'marital_status', 'student', 'country_of_birth', 'health', 'ethnic_group', 'religion', 'economic_activity', 'occupation', 'industry', 'hours_worked_per_week', 'approximate_social_grade']
2024-12-02 19:22:52,343 - INFO - Record_Number is unique.
2024-12-02 19:22:52,353 - INFO - 'record_number' column reset.
2024-12-02 19:22:52,525 - INFO - Batch 1 cleaned and saved.
2024-12-02 19:22:52,527 - INFO - Progress saved to /cs/home/sz92/Documents/CS5002/P3/code/progress.json.
2024-12-02 19:22:52,528 - INFO - Data cleaning process completed. Total rows processed: 63388
2024-12-02 19:22:52,528 - INFO - Rows to drop: 5297
2024-12-02 19:22:52,528 - INFO - Cleaned data saved to ../data/output.csv
2024-12-02 19:22:52,528 - INFO - Progress file removed. Data processing complete.
2024-12-02 19:22:53,098 - INFO - Data clean code test passed. Congratulations! Result deatils in log/data_cleaning.log
2024-12-02 19:25:36,994 - WARNING - Progress file progress.json not found. Starting from the beginning.
2024-12-02 19:25:37,062 - INFO - Loaded data from row 0.
2024-12-02 19:25:37,062 - INFO - Columns in DataFrame: ['record_number', 'region', 'residence_type', 'family_composition', 'sex', 'age', 'marital_status', 'student', 'country_of_birth', 'health', 'ethnic_group', 'religion', 'economic_activity', 'occupation', 'industry', 'hours_worked_per_week', 'approximate_social_grade']
2024-12-02 19:25:37,062 - WARNING - Progress file progress.json not found. Starting from the beginning.
2024-12-02 19:25:37,115 - INFO - =====Checking data types:=====
2024-12-02 19:25:37,136 - INFO - Batch info:
None
2024-12-02 19:25:37,400 - INFO - =====Checking for missing value:=====
2024-12-02 19:25:37,418 - INFO - No missing values detected.
2024-12-02 19:25:37,418 - INFO - =====Checking for duplicate rows:=====
2024-12-02 19:25:37,440 - INFO - No duplicate rows detected.
2024-12-02 19:25:37,440 - INFO - =====Verifying 'record_number' uniqueness:=====
2024-12-02 19:25:37,440 - INFO - Columns in batch: ['record_number', 'region', 'residence_type', 'family_composition', 'sex', 'age', 'marital_status', 'student', 'country_of_birth', 'health', 'ethnic_group', 'religion', 'economic_activity', 'occupation', 'industry', 'hours_worked_per_week', 'approximate_social_grade']
2024-12-02 19:25:37,441 - INFO - Record_Number is unique.
2024-12-02 19:25:37,441 - INFO - =====validate_data_ranges:=====
2024-12-02 19:25:37,915 - INFO - 
Unique categories and counts per column:
2024-12-02 19:25:37,915 - INFO - residence_type: ['C', 'P'] (Total unique: 2)
2024-12-02 19:25:37,915 - INFO - family_composition: ['2', '0', '5', '3', 'X', '1', '4'] (Total unique: 7)
2024-12-02 19:25:37,915 - INFO - sex: [1, 2] (Total unique: 2)
2024-12-02 19:25:37,915 - INFO - age: [1, 2, 3, 4, 5, 6, 7, 8] (Total unique: 8)
2024-12-02 19:25:37,915 - INFO - marital_status: [1, 2, 3, 4, 5] (Total unique: 5)
2024-12-02 19:25:37,915 - INFO - student: [1, 2] (Total unique: 2)
2024-12-02 19:25:37,915 - INFO - country_of_birth: [1, 2] (Total unique: 2)
2024-12-02 19:25:37,915 - INFO - health: [1, 2, 3, 4, 5] (Total unique: 5)
2024-12-02 19:25:37,915 - INFO - ethnic_group: [1, 2, 3, 4, 5, 6] (Total unique: 6)
2024-12-02 19:25:37,915 - INFO - religion: [1, 2, 3, 4, 5, 6, 7, 8, 9] (Total unique: 9)
2024-12-02 19:25:37,915 - INFO - economic_activity: ['9', '2', '8', '5', '3', '7', '6', 'X', '1', '4'] (Total unique: 10)
2024-12-02 19:25:37,915 - INFO - occupation: ['9', '2', '8', '5', '3', '7', '6', 'X', '1', '4'] (Total unique: 10)
2024-12-02 19:25:37,915 - INFO - industry: ['9', '2', '13', '8', '5', '3', '7', '6', 'X', '12', '10', '1', '11', '4'] (Total unique: 14)
2024-12-02 19:25:37,915 - INFO - hours_worked_per_week: ['2', '3', 'X', '1', '4'] (Total unique: 5)
2024-12-02 19:25:37,915 - INFO - approximate_social_grade: ['2', '3', 'X', '1', '4'] (Total unique: 5)
2024-12-02 19:25:37,915 - INFO - 
All data ranges validated.
2024-12-02 19:25:37,915 - INFO - Starting data cleaning process...
2024-12-02 19:25:37,968 - INFO - Processing batch 1...
2024-12-02 19:25:37,968 - INFO - =====Checking for missing value:=====
2024-12-02 19:25:37,985 - INFO - No missing values detected.
2024-12-02 19:25:37,985 - INFO - =====Checking for duplicate rows:=====
2024-12-02 19:25:38,007 - INFO - No duplicate rows detected.
2024-12-02 19:25:38,023 - INFO -        record_number     region residence_type family_composition  sex  age  marital_status  ...  ethnic_group  religion  economic_activity  occupation  industry hours_worked_per_week approximate_social_grade
20                21  S92000003              P                  5    2    2               1  ...             1         2                  6           X         X                     X                        2
47                48  S92000003              P                  0    1    2               1  ...             1         1                  6           X         X                     X                        2
48                49  S92000003              P                  0    1    3               2  ...             4         2                  6           2         8                     X                        2
85                86  S92000003              P                  1    1    2               1  ...             1         2                  6           X         X                     X                        1
88                89  S92000003              P                  1    1    3               2  ...             1         2                  6           2        10                     X                        2
...              ...        ...            ...                ...  ...  ...             ...  ...           ...       ...                ...         ...       ...                   ...                      ...
63295          63296  S92000003              P                  1    1    2               1  ...             1         2                  6           7         4                     X                        2
63317          63318  S92000003              P                  0    2    2               1  ...             3         1                  6           X         X                     X                        2
63350          63351  S92000003              P                  1    1    2               1  ...             1         1                  6           X         X                     X                        4
63366          63367  S92000003              P                  4    2    2               1  ...             1         1                  6           X         X                     X                        2
63383          63384  S92000003              P                  1    1    2               1  ...             1         2                  6           X         X                     X                        3

[2598 rows x 17 columns]
2024-12-02 19:25:38,034 - INFO - Rule 1: Found 2598 rows to delete, saved to data/rule_1_deleted_data.csv
2024-12-02 19:25:38,040 - INFO - Rule 2: No rows to delete
2024-12-02 19:25:38,052 - INFO - Rule 3: Found 843 rows to delete, saved to data/rule_3_deleted_data.csv
2024-12-02 19:25:38,069 - INFO - Rule 4: Found 2362 rows to delete, saved to data/rule_4_deleted_data.csv
2024-12-02 19:25:38,075 - INFO - Rule 5: No rows to delete
2024-12-02 19:25:38,088 - INFO - Rule 6: Found 843 rows to delete, saved to data/rule_6_deleted_data.csv
2024-12-02 19:25:38,092 - INFO - =====validate_data_ranges:=====
2024-12-02 19:25:38,530 - INFO - 
Unique categories and counts per column:
2024-12-02 19:25:38,530 - INFO - residence_type: ['C', 'P'] (Total unique: 2)
2024-12-02 19:25:38,530 - INFO - family_composition: ['2', '0', '5', '3', 'X', '1', '4'] (Total unique: 7)
2024-12-02 19:25:38,530 - INFO - sex: [1, 2] (Total unique: 2)
2024-12-02 19:25:38,530 - INFO - age: [1, 2, 3, 4, 5, 6, 7, 8] (Total unique: 8)
2024-12-02 19:25:38,530 - INFO - marital_status: [1, 2, 3, 4, 5] (Total unique: 5)
2024-12-02 19:25:38,530 - INFO - student: [1, 2] (Total unique: 2)
2024-12-02 19:25:38,530 - INFO - country_of_birth: [1, 2] (Total unique: 2)
2024-12-02 19:25:38,530 - INFO - health: [1, 2, 3, 4, 5] (Total unique: 5)
2024-12-02 19:25:38,530 - INFO - ethnic_group: [1, 2, 3, 4, 5, 6] (Total unique: 6)
2024-12-02 19:25:38,530 - INFO - religion: [1, 2, 3, 4, 5, 6, 7, 8, 9] (Total unique: 9)
2024-12-02 19:25:38,530 - INFO - economic_activity: ['9', '2', '8', '5', '3', '7', '6', 'X', '1', '4'] (Total unique: 10)
2024-12-02 19:25:38,530 - INFO - occupation: ['9', '2', '8', '5', '3', '7', '6', 'X', '1', '4'] (Total unique: 10)
2024-12-02 19:25:38,530 - INFO - industry: ['9', '2', '13', '8', '5', '3', '7', '6', 'X', '12', '10', '1', '11', '4'] (Total unique: 14)
2024-12-02 19:25:38,530 - INFO - hours_worked_per_week: ['2', '3', 'X', '1', '4'] (Total unique: 5)
2024-12-02 19:25:38,530 - INFO - approximate_social_grade: ['2', '3', 'X', '1', '4'] (Total unique: 5)
2024-12-02 19:25:38,530 - INFO - 
All data ranges validated.
2024-12-02 19:25:38,530 - INFO - =====Verifying 'record_number' uniqueness:=====
2024-12-02 19:25:38,530 - INFO - Columns in batch: ['record_number', 'region', 'residence_type', 'family_composition', 'sex', 'age', 'marital_status', 'student', 'country_of_birth', 'health', 'ethnic_group', 'religion', 'economic_activity', 'occupation', 'industry', 'hours_worked_per_week', 'approximate_social_grade']
2024-12-02 19:25:38,532 - INFO - Record_Number is unique.
2024-12-02 19:25:38,543 - INFO - 'record_number' column reset.
2024-12-02 19:25:38,828 - INFO - Batch 1 cleaned and saved.
2024-12-02 19:25:38,835 - INFO - Progress saved to /cs/home/sz92/Documents/CS5002/P3/code/progress.json.
2024-12-02 19:25:38,836 - INFO - Data cleaning process completed. Total rows processed: 63388
2024-12-02 19:25:38,836 - INFO - Rows to drop: 5297
2024-12-02 19:25:38,836 - INFO - Cleaned data saved to ../data/output.csv
2024-12-02 19:25:38,837 - INFO - Progress file removed. Data processing complete.
2024-12-02 19:25:39,414 - INFO - Data clean code test passed. Congratulations! Result deatils in log/data_cleaning.log
2024-12-02 19:28:09,360 - WARNING - Progress file progress.json not found. Starting from the beginning.
2024-12-02 19:28:09,438 - INFO - Loaded data from row 0.
2024-12-02 19:28:09,438 - INFO - Columns in DataFrame: ['record_number', 'region', 'residence_type', 'family_composition', 'sex', 'age', 'marital_status', 'student', 'country_of_birth', 'health', 'ethnic_group', 'religion', 'economic_activity', 'occupation', 'industry', 'hours_worked_per_week', 'approximate_social_grade']
2024-12-02 19:28:09,439 - WARNING - Progress file progress.json not found. Starting from the beginning.
2024-12-02 19:28:09,492 - INFO - =====Checking data types:=====
2024-12-02 19:28:09,513 - INFO - Batch info:
None
2024-12-02 19:28:09,774 - INFO - =====Checking for missing value:=====
2024-12-02 19:28:09,792 - INFO - No missing values detected.
2024-12-02 19:28:09,792 - INFO - =====Checking for duplicate rows:=====
2024-12-02 19:28:09,815 - INFO - No duplicate rows detected.
2024-12-02 19:28:09,815 - INFO - =====Verifying 'record_number' uniqueness:=====
2024-12-02 19:28:09,815 - INFO - Columns in batch: ['record_number', 'region', 'residence_type', 'family_composition', 'sex', 'age', 'marital_status', 'student', 'country_of_birth', 'health', 'ethnic_group', 'religion', 'economic_activity', 'occupation', 'industry', 'hours_worked_per_week', 'approximate_social_grade']
2024-12-02 19:28:09,816 - INFO - Record_Number is unique.
2024-12-02 19:28:09,816 - INFO - =====validate_data_ranges:=====
2024-12-02 19:28:10,303 - INFO - 
Unique categories and counts per column:
2024-12-02 19:28:10,303 - INFO - residence_type: ['C', 'P'] (Total unique: 2)
2024-12-02 19:28:10,303 - INFO - family_composition: ['2', 'X', '1', '4', '3', '5', '0'] (Total unique: 7)
2024-12-02 19:28:10,303 - INFO - sex: [1, 2] (Total unique: 2)
2024-12-02 19:28:10,303 - INFO - age: [1, 2, 3, 4, 5, 6, 7, 8] (Total unique: 8)
2024-12-02 19:28:10,303 - INFO - marital_status: [1, 2, 3, 4, 5] (Total unique: 5)
2024-12-02 19:28:10,303 - INFO - student: [1, 2] (Total unique: 2)
2024-12-02 19:28:10,303 - INFO - country_of_birth: [1, 2] (Total unique: 2)
2024-12-02 19:28:10,303 - INFO - health: [1, 2, 3, 4, 5] (Total unique: 5)
2024-12-02 19:28:10,303 - INFO - ethnic_group: [1, 2, 3, 4, 5, 6] (Total unique: 6)
2024-12-02 19:28:10,303 - INFO - religion: [1, 2, 3, 4, 5, 6, 7, 8, 9] (Total unique: 9)
2024-12-02 19:28:10,303 - INFO - economic_activity: ['8', '2', 'X', '9', '1', '6', '4', '3', '7', '5'] (Total unique: 10)
2024-12-02 19:28:10,303 - INFO - occupation: ['8', '2', 'X', '9', '1', '6', '4', '3', '7', '5'] (Total unique: 10)
2024-12-02 19:28:10,303 - INFO - industry: ['8', '2', '10', 'X', '9', '11', '6', '4', '3', '12', '1', '7', '5', '13'] (Total unique: 14)
2024-12-02 19:28:10,303 - INFO - hours_worked_per_week: ['2', 'X', '1', '4', '3'] (Total unique: 5)
2024-12-02 19:28:10,303 - INFO - approximate_social_grade: ['2', 'X', '1', '4', '3'] (Total unique: 5)
2024-12-02 19:28:10,303 - INFO - 
All data ranges validated.
2024-12-02 19:28:10,303 - INFO - Starting data cleaning process...
2024-12-02 19:28:10,357 - INFO - Processing batch 1...
2024-12-02 19:28:10,357 - INFO - =====Checking for missing value:=====
2024-12-02 19:28:10,374 - INFO - No missing values detected.
2024-12-02 19:28:10,374 - INFO - =====Checking for duplicate rows:=====
2024-12-02 19:28:10,397 - INFO - No duplicate rows detected.
2024-12-02 19:28:10,413 - INFO -        record_number     region residence_type family_composition  sex  age  marital_status  ...  ethnic_group  religion  economic_activity  occupation  industry hours_worked_per_week approximate_social_grade
20                21  S92000003              P                  5    2    2               1  ...             1         2                  6           X         X                     X                        2
47                48  S92000003              P                  0    1    2               1  ...             1         1                  6           X         X                     X                        2
48                49  S92000003              P                  0    1    3               2  ...             4         2                  6           2         8                     X                        2
85                86  S92000003              P                  1    1    2               1  ...             1         2                  6           X         X                     X                        1
88                89  S92000003              P                  1    1    3               2  ...             1         2                  6           2        10                     X                        2
...              ...        ...            ...                ...  ...  ...             ...  ...           ...       ...                ...         ...       ...                   ...                      ...
63295          63296  S92000003              P                  1    1    2               1  ...             1         2                  6           7         4                     X                        2
63317          63318  S92000003              P                  0    2    2               1  ...             3         1                  6           X         X                     X                        2
63350          63351  S92000003              P                  1    1    2               1  ...             1         1                  6           X         X                     X                        4
63366          63367  S92000003              P                  4    2    2               1  ...             1         1                  6           X         X                     X                        2
63383          63384  S92000003              P                  1    1    2               1  ...             1         2                  6           X         X                     X                        3

[2598 rows x 17 columns]
2024-12-02 19:28:10,424 - INFO - Rule 1: Found 2598 rows to delete, saved to data/rule_1_deleted_data.csv
2024-12-02 19:28:10,430 - INFO - Rule 2: No rows to delete
2024-12-02 19:28:10,442 - INFO - Rule 3: Found 843 rows to delete, saved to data/rule_3_deleted_data.csv
2024-12-02 19:28:10,459 - INFO - Rule 4: Found 2362 rows to delete, saved to data/rule_4_deleted_data.csv
2024-12-02 19:28:10,465 - INFO - Rule 5: No rows to delete
2024-12-02 19:28:10,477 - INFO - Rule 6: Found 843 rows to delete, saved to data/rule_6_deleted_data.csv
2024-12-02 19:28:10,481 - INFO - =====validate_data_ranges:=====
2024-12-02 19:28:10,930 - INFO - 
Unique categories and counts per column:
2024-12-02 19:28:10,930 - INFO - residence_type: ['C', 'P'] (Total unique: 2)
2024-12-02 19:28:10,930 - INFO - family_composition: ['2', 'X', '1', '4', '3', '5', '0'] (Total unique: 7)
2024-12-02 19:28:10,930 - INFO - sex: [1, 2] (Total unique: 2)
2024-12-02 19:28:10,931 - INFO - age: [1, 2, 3, 4, 5, 6, 7, 8] (Total unique: 8)
2024-12-02 19:28:10,931 - INFO - marital_status: [1, 2, 3, 4, 5] (Total unique: 5)
2024-12-02 19:28:10,931 - INFO - student: [1, 2] (Total unique: 2)
2024-12-02 19:28:10,931 - INFO - country_of_birth: [1, 2] (Total unique: 2)
2024-12-02 19:28:10,931 - INFO - health: [1, 2, 3, 4, 5] (Total unique: 5)
2024-12-02 19:28:10,931 - INFO - ethnic_group: [1, 2, 3, 4, 5, 6] (Total unique: 6)
2024-12-02 19:28:10,931 - INFO - religion: [1, 2, 3, 4, 5, 6, 7, 8, 9] (Total unique: 9)
2024-12-02 19:28:10,931 - INFO - economic_activity: ['8', '2', 'X', '9', '1', '6', '4', '3', '7', '5'] (Total unique: 10)
2024-12-02 19:28:10,931 - INFO - occupation: ['8', '2', 'X', '9', '1', '6', '4', '3', '7', '5'] (Total unique: 10)
2024-12-02 19:28:10,931 - INFO - industry: ['8', '2', '10', 'X', '9', '11', '6', '4', '3', '12', '1', '7', '5', '13'] (Total unique: 14)
2024-12-02 19:28:10,931 - INFO - hours_worked_per_week: ['2', 'X', '1', '4', '3'] (Total unique: 5)
2024-12-02 19:28:10,931 - INFO - approximate_social_grade: ['2', 'X', '1', '4', '3'] (Total unique: 5)
2024-12-02 19:28:10,931 - INFO - 
All data ranges validated.
2024-12-02 19:28:10,931 - INFO - =====Verifying 'record_number' uniqueness:=====
2024-12-02 19:28:10,931 - INFO - Columns in batch: ['record_number', 'region', 'residence_type', 'family_composition', 'sex', 'age', 'marital_status', 'student', 'country_of_birth', 'health', 'ethnic_group', 'religion', 'economic_activity', 'occupation', 'industry', 'hours_worked_per_week', 'approximate_social_grade']
2024-12-02 19:28:10,933 - INFO - Record_Number is unique.
2024-12-02 19:28:10,943 - INFO - 'record_number' column reset.
2024-12-02 19:28:11,131 - INFO - Batch 1 cleaned and saved.
2024-12-02 19:28:11,134 - INFO - Progress saved to /cs/home/sz92/Documents/CS5002/P3/code/progress.json.
2024-12-02 19:28:11,134 - INFO - Data cleaning process completed. Total rows processed: 63388
2024-12-02 19:28:11,134 - INFO - Rows to drop: 5297
2024-12-02 19:28:11,134 - INFO - Cleaned data saved to ../data/output.csv
2024-12-02 19:28:11,135 - INFO - Progress file removed. Data processing complete.
2024-12-02 19:28:11,708 - INFO - Data clean code test passed. Congratulations! Result deatils in log/data_cleaning.log
2024-12-02 19:32:32,715 - WARNING - Progress file progress.json not found. Starting from the beginning.
2024-12-02 19:32:32,791 - INFO - Loaded data from row 0.
2024-12-02 19:32:32,792 - INFO - Columns in DataFrame: ['record_number', 'region', 'residence_type', 'family_composition', 'sex', 'age', 'marital_status', 'student', 'country_of_birth', 'health', 'ethnic_group', 'religion', 'economic_activity', 'occupation', 'industry', 'hours_worked_per_week', 'approximate_social_grade']
2024-12-02 19:32:32,792 - WARNING - Progress file progress.json not found. Starting from the beginning.
2024-12-02 19:32:32,845 - INFO - =====Checking data types:=====
2024-12-02 19:32:32,866 - INFO - Batch info:
None
2024-12-02 19:32:33,130 - INFO - =====Checking for missing value:=====
2024-12-02 19:32:33,149 - INFO - No missing values detected.
2024-12-02 19:32:33,149 - INFO - =====Checking for duplicate rows:=====
2024-12-02 19:32:33,172 - INFO - No duplicate rows detected.
2024-12-02 19:32:33,172 - INFO - =====Verifying 'record_number' uniqueness:=====
2024-12-02 19:32:33,172 - INFO - Columns in batch: ['record_number', 'region', 'residence_type', 'family_composition', 'sex', 'age', 'marital_status', 'student', 'country_of_birth', 'health', 'ethnic_group', 'religion', 'economic_activity', 'occupation', 'industry', 'hours_worked_per_week', 'approximate_social_grade']
2024-12-02 19:32:33,173 - INFO - Record_Number is unique.
2024-12-02 19:32:33,173 - INFO - =====validate_data_ranges:=====
2024-12-02 19:32:33,658 - INFO - 
Unique categories and counts per column:
2024-12-02 19:32:33,659 - INFO - residence_type: ['P', 'C'] (Total unique: 2)
2024-12-02 19:32:33,659 - INFO - family_composition: ['3', '1', '4', 'X', '2', '5', '0'] (Total unique: 7)
2024-12-02 19:32:33,659 - INFO - sex: [1, 2] (Total unique: 2)
2024-12-02 19:32:33,659 - INFO - age: [1, 2, 3, 4, 5, 6, 7, 8] (Total unique: 8)
2024-12-02 19:32:33,659 - INFO - marital_status: [1, 2, 3, 4, 5] (Total unique: 5)
2024-12-02 19:32:33,659 - INFO - student: [1, 2] (Total unique: 2)
2024-12-02 19:32:33,659 - INFO - country_of_birth: [1, 2] (Total unique: 2)
2024-12-02 19:32:33,659 - INFO - health: [1, 2, 3, 4, 5] (Total unique: 5)
2024-12-02 19:32:33,659 - INFO - ethnic_group: [1, 2, 3, 4, 5, 6] (Total unique: 6)
2024-12-02 19:32:33,659 - INFO - religion: [1, 2, 3, 4, 5, 6, 7, 8, 9] (Total unique: 9)
2024-12-02 19:32:33,659 - INFO - economic_activity: ['3', '1', '4', '8', '6', 'X', '9', '2', '7', '5'] (Total unique: 10)
2024-12-02 19:32:33,659 - INFO - occupation: ['3', '1', '4', '8', '6', 'X', '9', '2', '7', '5'] (Total unique: 10)
2024-12-02 19:32:33,659 - INFO - industry: ['3', '13', '11', '1', '8', '4', '6', 'X', '9', '12', '2', '7', '10', '5'] (Total unique: 14)
2024-12-02 19:32:33,659 - INFO - hours_worked_per_week: ['3', '1', '4', 'X', '2'] (Total unique: 5)
2024-12-02 19:32:33,659 - INFO - approximate_social_grade: ['3', '1', '4', 'X', '2'] (Total unique: 5)
2024-12-02 19:32:33,659 - INFO - 
All data ranges validated.
2024-12-02 19:32:33,659 - INFO - Starting data cleaning process...
2024-12-02 19:32:33,713 - INFO - Processing batch 1...
2024-12-02 19:32:33,713 - INFO - =====Checking for missing value:=====
2024-12-02 19:32:33,730 - INFO - No missing values detected.
2024-12-02 19:32:33,730 - INFO - =====Checking for duplicate rows:=====
2024-12-02 19:32:33,752 - INFO - No duplicate rows detected.
2024-12-02 19:32:33,769 - INFO -        record_number     region residence_type family_composition  sex  age  marital_status  ...  ethnic_group  religion  economic_activity  occupation  industry hours_worked_per_week approximate_social_grade
20                21  S92000003              P                  5    2    2               1  ...             1         2                  6           X         X                     X                        2
47                48  S92000003              P                  0    1    2               1  ...             1         1                  6           X         X                     X                        2
48                49  S92000003              P                  0    1    3               2  ...             4         2                  6           2         8                     X                        2
85                86  S92000003              P                  1    1    2               1  ...             1         2                  6           X         X                     X                        1
88                89  S92000003              P                  1    1    3               2  ...             1         2                  6           2        10                     X                        2
...              ...        ...            ...                ...  ...  ...             ...  ...           ...       ...                ...         ...       ...                   ...                      ...
63295          63296  S92000003              P                  1    1    2               1  ...             1         2                  6           7         4                     X                        2
63317          63318  S92000003              P                  0    2    2               1  ...             3         1                  6           X         X                     X                        2
63350          63351  S92000003              P                  1    1    2               1  ...             1         1                  6           X         X                     X                        4
63366          63367  S92000003              P                  4    2    2               1  ...             1         1                  6           X         X                     X                        2
63383          63384  S92000003              P                  1    1    2               1  ...             1         2                  6           X         X                     X                        3

[2598 rows x 17 columns]
2024-12-02 19:32:33,782 - INFO - Rule 1: Found 2598 rows to delete, saved to data/rule_1_deleted_data.csv
2024-12-02 19:32:33,789 - INFO - Rule 2: No rows to delete
2024-12-02 19:32:33,878 - INFO - Rule 3: Found 843 rows to delete, saved to data/rule_3_deleted_data.csv
2024-12-02 19:32:33,918 - INFO - Rule 4: Found 2362 rows to delete, saved to data/rule_4_deleted_data.csv
2024-12-02 19:32:33,925 - INFO - Rule 5: No rows to delete
2024-12-02 19:32:33,940 - INFO - Rule 6: Found 843 rows to delete, saved to data/rule_6_deleted_data.csv
2024-12-02 19:32:33,944 - INFO - =====validate_data_ranges:=====
2024-12-02 19:32:34,391 - INFO - 
Unique categories and counts per column:
2024-12-02 19:32:34,391 - INFO - residence_type: ['P', 'C'] (Total unique: 2)
2024-12-02 19:32:34,391 - INFO - family_composition: ['3', '1', '4', 'X', '2', '5', '0'] (Total unique: 7)
2024-12-02 19:32:34,391 - INFO - sex: [1, 2] (Total unique: 2)
2024-12-02 19:32:34,391 - INFO - age: [1, 2, 3, 4, 5, 6, 7, 8] (Total unique: 8)
2024-12-02 19:32:34,391 - INFO - marital_status: [1, 2, 3, 4, 5] (Total unique: 5)
2024-12-02 19:32:34,391 - INFO - student: [1, 2] (Total unique: 2)
2024-12-02 19:32:34,391 - INFO - country_of_birth: [1, 2] (Total unique: 2)
2024-12-02 19:32:34,391 - INFO - health: [1, 2, 3, 4, 5] (Total unique: 5)
2024-12-02 19:32:34,391 - INFO - ethnic_group: [1, 2, 3, 4, 5, 6] (Total unique: 6)
2024-12-02 19:32:34,391 - INFO - religion: [1, 2, 3, 4, 5, 6, 7, 8, 9] (Total unique: 9)
2024-12-02 19:32:34,391 - INFO - economic_activity: ['3', '1', '4', '8', '6', 'X', '9', '2', '7', '5'] (Total unique: 10)
2024-12-02 19:32:34,391 - INFO - occupation: ['3', '1', '4', '8', '6', 'X', '9', '2', '7', '5'] (Total unique: 10)
2024-12-02 19:32:34,391 - INFO - industry: ['3', '13', '11', '1', '8', '4', '6', 'X', '9', '12', '2', '7', '10', '5'] (Total unique: 14)
2024-12-02 19:32:34,391 - INFO - hours_worked_per_week: ['3', '1', '4', 'X', '2'] (Total unique: 5)
2024-12-02 19:32:34,391 - INFO - approximate_social_grade: ['3', '1', '4', 'X', '2'] (Total unique: 5)
2024-12-02 19:32:34,392 - INFO - 
All data ranges validated.
2024-12-02 19:32:34,392 - INFO - =====Verifying 'record_number' uniqueness:=====
2024-12-02 19:32:34,392 - INFO - Columns in batch: ['record_number', 'region', 'residence_type', 'family_composition', 'sex', 'age', 'marital_status', 'student', 'country_of_birth', 'health', 'ethnic_group', 'religion', 'economic_activity', 'occupation', 'industry', 'hours_worked_per_week', 'approximate_social_grade']
2024-12-02 19:32:34,393 - INFO - Record_Number is unique.
2024-12-02 19:32:34,405 - INFO - 'record_number' column reset.
2024-12-02 19:32:34,621 - INFO - Batch 1 cleaned and saved.
2024-12-02 19:32:34,690 - INFO - Progress saved to /cs/home/sz92/Documents/CS5002/P3/code/progress.json.
2024-12-02 19:32:34,691 - INFO - Data cleaning process completed. Total rows processed: 63388
2024-12-02 19:32:34,691 - INFO - Rows to drop: 5297
2024-12-02 19:32:34,691 - INFO - Cleaned data saved to ../data/output.csv
2024-12-02 19:32:34,692 - INFO - Progress file removed. Data processing complete.
2024-12-02 19:32:35,311 - INFO - Data clean code test passed. Congratulations! Result deatils in log/data_cleaning.log
2024-12-02 19:37:35,151 - WARNING - Progress file progress.json not found. Starting from the beginning.
2024-12-02 19:37:35,219 - INFO - Loaded data from row 0.
2024-12-02 19:37:35,219 - INFO - Columns in DataFrame: ['record_number', 'region', 'residence_type', 'family_composition', 'sex', 'age', 'marital_status', 'student', 'country_of_birth', 'health', 'ethnic_group', 'religion', 'economic_activity', 'occupation', 'industry', 'hours_worked_per_week', 'approximate_social_grade']
2024-12-02 19:37:35,220 - WARNING - Progress file progress.json not found. Starting from the beginning.
2024-12-02 19:37:35,273 - INFO - =====Checking data types:=====
2024-12-02 19:37:35,294 - INFO - Batch info:
None
2024-12-02 19:37:35,552 - INFO - =====Checking for missing value:=====
2024-12-02 19:37:35,570 - INFO - No missing values detected.
2024-12-02 19:37:35,570 - INFO - =====Checking for duplicate rows:=====
2024-12-02 19:37:35,593 - INFO - No duplicate rows detected.
2024-12-02 19:37:35,593 - INFO - =====Verifying 'record_number' uniqueness:=====
2024-12-02 19:37:35,594 - INFO - Columns in batch: ['record_number', 'region', 'residence_type', 'family_composition', 'sex', 'age', 'marital_status', 'student', 'country_of_birth', 'health', 'ethnic_group', 'religion', 'economic_activity', 'occupation', 'industry', 'hours_worked_per_week', 'approximate_social_grade']
2024-12-02 19:37:35,595 - INFO - Record_Number is unique.
2024-12-02 19:37:35,595 - INFO - =====validate_data_ranges:=====
2024-12-02 19:37:36,097 - INFO - 
Unique categories and counts per column:
2024-12-02 19:37:36,097 - INFO - residence_type: ['C', 'P'] (Total unique: 2)
2024-12-02 19:37:36,097 - INFO - family_composition: ['1', '5', 'X', '2', '0', '4', '3'] (Total unique: 7)
2024-12-02 19:37:36,097 - INFO - sex: [1, 2] (Total unique: 2)
2024-12-02 19:37:36,097 - INFO - age: [1, 2, 3, 4, 5, 6, 7, 8] (Total unique: 8)
2024-12-02 19:37:36,097 - INFO - marital_status: [1, 2, 3, 4, 5] (Total unique: 5)
2024-12-02 19:37:36,097 - INFO - student: [1, 2] (Total unique: 2)
2024-12-02 19:37:36,097 - INFO - country_of_birth: [1, 2] (Total unique: 2)
2024-12-02 19:37:36,097 - INFO - health: [1, 2, 3, 4, 5] (Total unique: 5)
2024-12-02 19:37:36,097 - INFO - ethnic_group: [1, 2, 3, 4, 5, 6] (Total unique: 6)
2024-12-02 19:37:36,097 - INFO - religion: [1, 2, 3, 4, 5, 6, 7, 8, 9] (Total unique: 9)
2024-12-02 19:37:36,098 - INFO - economic_activity: ['1', '5', 'X', '7', '6', '9', '2', '4', '8', '3'] (Total unique: 10)
2024-12-02 19:37:36,098 - INFO - occupation: ['1', '5', 'X', '7', '6', '9', '2', '4', '8', '3'] (Total unique: 10)
2024-12-02 19:37:36,098 - INFO - industry: ['11', '1', '5', 'X', '7', '6', '12', '9', '2', '10', '4', '8', '3', '13'] (Total unique: 14)
2024-12-02 19:37:36,098 - INFO - hours_worked_per_week: ['1', 'X', '2', '4', '3'] (Total unique: 5)
2024-12-02 19:37:36,098 - INFO - approximate_social_grade: ['1', 'X', '2', '4', '3'] (Total unique: 5)
2024-12-02 19:37:36,098 - INFO - 
All data ranges validated.
2024-12-02 19:37:36,098 - INFO - Starting data cleaning process...
2024-12-02 19:37:36,152 - INFO - Processing batch 1...
2024-12-02 19:37:36,152 - INFO - =====Checking for missing value:=====
2024-12-02 19:37:36,170 - INFO - No missing values detected.
2024-12-02 19:37:36,170 - INFO - =====Checking for duplicate rows:=====
2024-12-02 19:37:36,192 - INFO - No duplicate rows detected.
2024-12-02 19:37:36,208 - INFO -        record_number     region residence_type family_composition  sex  age  marital_status  ...  ethnic_group  religion  economic_activity  occupation  industry hours_worked_per_week approximate_social_grade
20                21  S92000003              P                  5    2    2               1  ...             1         2                  6           X         X                     X                        2
47                48  S92000003              P                  0    1    2               1  ...             1         1                  6           X         X                     X                        2
48                49  S92000003              P                  0    1    3               2  ...             4         2                  6           2         8                     X                        2
85                86  S92000003              P                  1    1    2               1  ...             1         2                  6           X         X                     X                        1
88                89  S92000003              P                  1    1    3               2  ...             1         2                  6           2        10                     X                        2
...              ...        ...            ...                ...  ...  ...             ...  ...           ...       ...                ...         ...       ...                   ...                      ...
63295          63296  S92000003              P                  1    1    2               1  ...             1         2                  6           7         4                     X                        2
63317          63318  S92000003              P                  0    2    2               1  ...             3         1                  6           X         X                     X                        2
63350          63351  S92000003              P                  1    1    2               1  ...             1         1                  6           X         X                     X                        4
63366          63367  S92000003              P                  4    2    2               1  ...             1         1                  6           X         X                     X                        2
63383          63384  S92000003              P                  1    1    2               1  ...             1         2                  6           X         X                     X                        3

[2598 rows x 17 columns]
2024-12-02 19:37:36,219 - INFO - Rule 1: Found 2598 rows to delete, saved to data/rule_1_deleted_data.csv
2024-12-02 19:37:36,225 - INFO - Rule 2: No rows to delete
2024-12-02 19:37:36,238 - INFO - Rule 3: Found 843 rows to delete, saved to data/rule_3_deleted_data.csv
2024-12-02 19:37:36,256 - INFO - Rule 4: Found 2362 rows to delete, saved to data/rule_4_deleted_data.csv
2024-12-02 19:37:36,262 - INFO - Rule 5: No rows to delete
2024-12-02 19:37:36,275 - INFO - Rule 6: Found 843 rows to delete, saved to data/rule_6_deleted_data.csv
2024-12-02 19:37:36,280 - INFO - =====validate_data_ranges:=====
2024-12-02 19:37:36,729 - INFO - 
Unique categories and counts per column:
2024-12-02 19:37:36,729 - INFO - residence_type: ['C', 'P'] (Total unique: 2)
2024-12-02 19:37:36,729 - INFO - family_composition: ['1', '5', 'X', '2', '0', '4', '3'] (Total unique: 7)
2024-12-02 19:37:36,730 - INFO - sex: [1, 2] (Total unique: 2)
2024-12-02 19:37:36,730 - INFO - age: [1, 2, 3, 4, 5, 6, 7, 8] (Total unique: 8)
2024-12-02 19:37:36,730 - INFO - marital_status: [1, 2, 3, 4, 5] (Total unique: 5)
2024-12-02 19:37:36,730 - INFO - student: [1, 2] (Total unique: 2)
2024-12-02 19:37:36,730 - INFO - country_of_birth: [1, 2] (Total unique: 2)
2024-12-02 19:37:36,730 - INFO - health: [1, 2, 3, 4, 5] (Total unique: 5)
2024-12-02 19:37:36,730 - INFO - ethnic_group: [1, 2, 3, 4, 5, 6] (Total unique: 6)
2024-12-02 19:37:36,730 - INFO - religion: [1, 2, 3, 4, 5, 6, 7, 8, 9] (Total unique: 9)
2024-12-02 19:37:36,730 - INFO - economic_activity: ['1', '5', 'X', '7', '6', '9', '2', '4', '8', '3'] (Total unique: 10)
2024-12-02 19:37:36,730 - INFO - occupation: ['1', '5', 'X', '7', '6', '9', '2', '4', '8', '3'] (Total unique: 10)
2024-12-02 19:37:36,730 - INFO - industry: ['11', '1', '5', 'X', '7', '6', '12', '9', '2', '10', '4', '8', '3', '13'] (Total unique: 14)
2024-12-02 19:37:36,730 - INFO - hours_worked_per_week: ['1', 'X', '2', '4', '3'] (Total unique: 5)
2024-12-02 19:37:36,730 - INFO - approximate_social_grade: ['1', 'X', '2', '4', '3'] (Total unique: 5)
2024-12-02 19:37:36,730 - INFO - 
All data ranges validated.
2024-12-02 19:37:36,730 - INFO - =====Verifying 'record_number' uniqueness:=====
2024-12-02 19:37:36,730 - INFO - Columns in batch: ['record_number', 'region', 'residence_type', 'family_composition', 'sex', 'age', 'marital_status', 'student', 'country_of_birth', 'health', 'ethnic_group', 'religion', 'economic_activity', 'occupation', 'industry', 'hours_worked_per_week', 'approximate_social_grade']
2024-12-02 19:37:36,732 - INFO - Record_Number is unique.
2024-12-02 19:37:36,743 - INFO - 'record_number' column reset.
2024-12-02 19:37:36,920 - INFO - Batch 1 cleaned and saved.
2024-12-02 19:37:36,922 - INFO - Progress saved to /cs/home/sz92/Documents/CS5002/P3/code/progress.json.
2024-12-02 19:37:36,923 - INFO - Data cleaning process completed. Total rows processed: 63388
2024-12-02 19:37:36,923 - INFO - Rows to drop: 5297
2024-12-02 19:37:36,923 - INFO - Cleaned data saved to ../data/output.csv
2024-12-02 19:37:36,923 - INFO - Progress file removed. Data processing complete.
2024-12-02 19:37:37,489 - INFO - Data clean code test passed. Congratulations! Result deatils in log/data_cleaning.log
2024-12-02 19:38:58,306 - WARNING - Progress file progress.json not found. Starting from the beginning.
2024-12-02 19:38:58,373 - INFO - Loaded data from row 0.
2024-12-02 19:38:58,373 - INFO - Columns in DataFrame: ['record_number', 'region', 'residence_type', 'family_composition', 'sex', 'age', 'marital_status', 'student', 'country_of_birth', 'health', 'ethnic_group', 'religion', 'economic_activity', 'occupation', 'industry', 'hours_worked_per_week', 'approximate_social_grade']
2024-12-02 19:38:58,373 - WARNING - Progress file progress.json not found. Starting from the beginning.
2024-12-02 19:38:58,427 - INFO - =====Checking data types:=====
2024-12-02 19:38:58,448 - INFO - Batch info:
None
2024-12-02 19:38:58,703 - INFO - =====Checking for missing value:=====
2024-12-02 19:38:58,721 - INFO - No missing values detected.
2024-12-02 19:38:58,721 - INFO - =====Checking for duplicate rows:=====
2024-12-02 19:38:58,744 - INFO - No duplicate rows detected.
2024-12-02 19:38:58,744 - INFO - =====Verifying 'record_number' uniqueness:=====
2024-12-02 19:38:58,744 - INFO - Columns in batch: ['record_number', 'region', 'residence_type', 'family_composition', 'sex', 'age', 'marital_status', 'student', 'country_of_birth', 'health', 'ethnic_group', 'religion', 'economic_activity', 'occupation', 'industry', 'hours_worked_per_week', 'approximate_social_grade']
2024-12-02 19:38:58,745 - INFO - Record_Number is unique.
2024-12-02 19:38:58,745 - INFO - =====validate_data_ranges:=====
2024-12-02 19:38:59,233 - INFO - 
Unique categories and counts per column:
2024-12-02 19:38:59,233 - INFO - residence_type: ['C', 'P'] (Total unique: 2)
2024-12-02 19:38:59,233 - INFO - family_composition: ['0', '1', '5', '3', 'X', '4', '2'] (Total unique: 7)
2024-12-02 19:38:59,233 - INFO - sex: [1, 2] (Total unique: 2)
2024-12-02 19:38:59,233 - INFO - age: [1, 2, 3, 4, 5, 6, 7, 8] (Total unique: 8)
2024-12-02 19:38:59,233 - INFO - marital_status: [1, 2, 3, 4, 5] (Total unique: 5)
2024-12-02 19:38:59,234 - INFO - student: [1, 2] (Total unique: 2)
2024-12-02 19:38:59,234 - INFO - country_of_birth: [1, 2] (Total unique: 2)
2024-12-02 19:38:59,234 - INFO - health: [1, 2, 3, 4, 5] (Total unique: 5)
2024-12-02 19:38:59,234 - INFO - ethnic_group: [1, 2, 3, 4, 5, 6] (Total unique: 6)
2024-12-02 19:38:59,234 - INFO - religion: [1, 2, 3, 4, 5, 6, 7, 8, 9] (Total unique: 9)
2024-12-02 19:38:59,234 - INFO - economic_activity: ['9', '1', '8', '5', '3', '6', 'X', '4', '2', '7'] (Total unique: 10)
2024-12-02 19:38:59,234 - INFO - occupation: ['9', '1', '8', '5', '3', '6', 'X', '4', '2', '7'] (Total unique: 10)
2024-12-02 19:38:59,234 - INFO - industry: ['9', '11', '1', '8', '5', '3', '6', 'X', '4', '12', '2', '10', '13', '7'] (Total unique: 14)
2024-12-02 19:38:59,234 - INFO - hours_worked_per_week: ['1', '3', 'X', '4', '2'] (Total unique: 5)
2024-12-02 19:38:59,234 - INFO - approximate_social_grade: ['1', '3', 'X', '4', '2'] (Total unique: 5)
2024-12-02 19:38:59,234 - INFO - 
All data ranges validated.
2024-12-02 19:38:59,234 - INFO - Starting data cleaning process...
2024-12-02 19:38:59,287 - INFO - Processing batch 1...
2024-12-02 19:38:59,287 - INFO - =====Checking for missing value:=====
2024-12-02 19:38:59,304 - INFO - No missing values detected.
2024-12-02 19:38:59,304 - INFO - =====Checking for duplicate rows:=====
2024-12-02 19:38:59,326 - INFO - No duplicate rows detected.
2024-12-02 19:38:59,342 - INFO -        record_number     region residence_type family_composition  sex  age  marital_status  ...  ethnic_group  religion  economic_activity  occupation  industry hours_worked_per_week approximate_social_grade
20                21  S92000003              P                  5    2    2               1  ...             1         2                  6           X         X                     X                        2
47                48  S92000003              P                  0    1    2               1  ...             1         1                  6           X         X                     X                        2
48                49  S92000003              P                  0    1    3               2  ...             4         2                  6           2         8                     X                        2
85                86  S92000003              P                  1    1    2               1  ...             1         2                  6           X         X                     X                        1
88                89  S92000003              P                  1    1    3               2  ...             1         2                  6           2        10                     X                        2
...              ...        ...            ...                ...  ...  ...             ...  ...           ...       ...                ...         ...       ...                   ...                      ...
63295          63296  S92000003              P                  1    1    2               1  ...             1         2                  6           7         4                     X                        2
63317          63318  S92000003              P                  0    2    2               1  ...             3         1                  6           X         X                     X                        2
63350          63351  S92000003              P                  1    1    2               1  ...             1         1                  6           X         X                     X                        4
63366          63367  S92000003              P                  4    2    2               1  ...             1         1                  6           X         X                     X                        2
63383          63384  S92000003              P                  1    1    2               1  ...             1         2                  6           X         X                     X                        3

[2598 rows x 17 columns]
2024-12-02 19:38:59,352 - INFO - Rule 1: Found 2598 rows to delete, saved to data/rule_1_deleted_data.csv
2024-12-02 19:38:59,359 - INFO - Rule 2: No rows to delete
2024-12-02 19:38:59,370 - INFO - Rule 3: Found 843 rows to delete, saved to data/rule_3_deleted_data.csv
2024-12-02 19:38:59,386 - INFO - Rule 4: Found 2362 rows to delete, saved to data/rule_4_deleted_data.csv
2024-12-02 19:38:59,392 - INFO - Rule 5: No rows to delete
2024-12-02 19:38:59,404 - INFO - Rule 6: Found 843 rows to delete, saved to data/rule_6_deleted_data.csv
2024-12-02 19:38:59,409 - INFO - =====validate_data_ranges:=====
2024-12-02 19:38:59,852 - INFO - 
Unique categories and counts per column:
2024-12-02 19:38:59,852 - INFO - residence_type: ['C', 'P'] (Total unique: 2)
2024-12-02 19:38:59,852 - INFO - family_composition: ['0', '1', '5', '3', 'X', '4', '2'] (Total unique: 7)
2024-12-02 19:38:59,852 - INFO - sex: [1, 2] (Total unique: 2)
2024-12-02 19:38:59,853 - INFO - age: [1, 2, 3, 4, 5, 6, 7, 8] (Total unique: 8)
2024-12-02 19:38:59,853 - INFO - marital_status: [1, 2, 3, 4, 5] (Total unique: 5)
2024-12-02 19:38:59,853 - INFO - student: [1, 2] (Total unique: 2)
2024-12-02 19:38:59,853 - INFO - country_of_birth: [1, 2] (Total unique: 2)
2024-12-02 19:38:59,853 - INFO - health: [1, 2, 3, 4, 5] (Total unique: 5)
2024-12-02 19:38:59,853 - INFO - ethnic_group: [1, 2, 3, 4, 5, 6] (Total unique: 6)
2024-12-02 19:38:59,853 - INFO - religion: [1, 2, 3, 4, 5, 6, 7, 8, 9] (Total unique: 9)
2024-12-02 19:38:59,853 - INFO - economic_activity: ['9', '1', '8', '5', '3', '6', 'X', '4', '2', '7'] (Total unique: 10)
2024-12-02 19:38:59,853 - INFO - occupation: ['9', '1', '8', '5', '3', '6', 'X', '4', '2', '7'] (Total unique: 10)
2024-12-02 19:38:59,853 - INFO - industry: ['9', '11', '1', '8', '5', '3', '6', 'X', '4', '12', '2', '10', '13', '7'] (Total unique: 14)
2024-12-02 19:38:59,853 - INFO - hours_worked_per_week: ['1', '3', 'X', '4', '2'] (Total unique: 5)
2024-12-02 19:38:59,853 - INFO - approximate_social_grade: ['1', '3', 'X', '4', '2'] (Total unique: 5)
2024-12-02 19:38:59,853 - INFO - 
All data ranges validated.
2024-12-02 19:38:59,853 - INFO - =====Verifying 'record_number' uniqueness:=====
2024-12-02 19:38:59,853 - INFO - Columns in batch: ['record_number', 'region', 'residence_type', 'family_composition', 'sex', 'age', 'marital_status', 'student', 'country_of_birth', 'health', 'ethnic_group', 'religion', 'economic_activity', 'occupation', 'industry', 'hours_worked_per_week', 'approximate_social_grade']
2024-12-02 19:38:59,855 - INFO - Record_Number is unique.
2024-12-02 19:38:59,865 - INFO - 'record_number' column reset.
2024-12-02 19:39:00,051 - INFO - Batch 1 cleaned and saved.
2024-12-02 19:39:00,054 - INFO - Progress saved to /cs/home/sz92/Documents/CS5002/P3/code/progress.json.
2024-12-02 19:39:00,054 - INFO - Data cleaning process completed. Total rows processed: 63388
2024-12-02 19:39:00,055 - INFO - Rows to drop: 5297
2024-12-02 19:39:00,055 - INFO - Cleaned data saved to ../data/output.csv
2024-12-02 19:39:00,055 - INFO - Progress file removed. Data processing complete.
2024-12-02 19:39:00,621 - INFO - Data clean code test passed. Congratulations! Result deatils in log/data_cleaning.log
2024-12-02 20:34:54,907 - WARNING - Progress file progress.json not found. Starting from the beginning.
2024-12-02 20:34:54,974 - INFO - Loaded data from row 0.
2024-12-02 20:34:54,974 - INFO - Columns in DataFrame: ['record_number', 'region', 'residence_type', 'family_composition', 'sex', 'age', 'marital_status', 'student', 'country_of_birth', 'health', 'ethnic_group', 'religion', 'economic_activity', 'occupation', 'industry', 'hours_worked_per_week', 'approximate_social_grade']
2024-12-02 20:34:54,974 - WARNING - Progress file progress.json not found. Starting from the beginning.
2024-12-02 20:34:55,027 - INFO - =====Checking data types:=====
2024-12-02 20:34:55,049 - INFO - Batch info:
None
2024-12-02 20:34:55,306 - INFO - =====Checking for missing value:=====
2024-12-02 20:34:55,323 - INFO - No missing values detected.
2024-12-02 20:34:55,323 - INFO - =====Checking for duplicate rows:=====
2024-12-02 20:34:55,345 - INFO - No duplicate rows detected.
2024-12-02 20:34:55,346 - INFO - =====Verifying 'record_number' uniqueness:=====
2024-12-02 20:34:55,346 - INFO - Columns in batch: ['record_number', 'region', 'residence_type', 'family_composition', 'sex', 'age', 'marital_status', 'student', 'country_of_birth', 'health', 'ethnic_group', 'religion', 'economic_activity', 'occupation', 'industry', 'hours_worked_per_week', 'approximate_social_grade']
2024-12-02 20:34:55,347 - INFO - Record_Number is unique.
2024-12-02 20:34:55,347 - INFO - =====validate_data_ranges:=====
2024-12-02 20:34:55,827 - INFO - 
Unique categories and counts per column:
2024-12-02 20:34:55,827 - INFO - residence_type: ['C', 'P'] (Total unique: 2)
2024-12-02 20:34:55,827 - INFO - family_composition: ['5', '0', '3', '1', 'X', '2', '4'] (Total unique: 7)
2024-12-02 20:34:55,827 - INFO - sex: [1, 2] (Total unique: 2)
2024-12-02 20:34:55,827 - INFO - age: [1, 2, 3, 4, 5, 6, 7, 8] (Total unique: 8)
2024-12-02 20:34:55,827 - INFO - marital_status: [1, 2, 3, 4, 5] (Total unique: 5)
2024-12-02 20:34:55,827 - INFO - student: [1, 2] (Total unique: 2)
2024-12-02 20:34:55,828 - INFO - country_of_birth: [1, 2] (Total unique: 2)
2024-12-02 20:34:55,828 - INFO - health: [1, 2, 3, 4, 5] (Total unique: 5)
2024-12-02 20:34:55,828 - INFO - ethnic_group: [1, 2, 3, 4, 5, 6] (Total unique: 6)
2024-12-02 20:34:55,828 - INFO - religion: [1, 2, 3, 4, 5, 6, 7, 8, 9] (Total unique: 9)
2024-12-02 20:34:55,828 - INFO - economic_activity: ['5', '7', '3', '1', '8', '9', 'X', '6', '2', '4'] (Total unique: 10)
2024-12-02 20:34:55,828 - INFO - occupation: ['5', '7', '3', '1', '8', '9', 'X', '6', '2', '4'] (Total unique: 10)
2024-12-02 20:34:55,828 - INFO - industry: ['10', '5', '7', '3', '1', '8', '11', '9', 'X', '6', '13', '12', '2', '4'] (Total unique: 14)
2024-12-02 20:34:55,828 - INFO - hours_worked_per_week: ['3', '1', 'X', '2', '4'] (Total unique: 5)
2024-12-02 20:34:55,828 - INFO - approximate_social_grade: ['3', '1', 'X', '2', '4'] (Total unique: 5)
2024-12-02 20:34:55,828 - INFO - 
All data ranges validated.
2024-12-02 20:34:55,828 - INFO - Starting data cleaning process...
2024-12-02 20:34:55,881 - INFO - Processing batch 1...
2024-12-02 20:34:55,881 - INFO - =====Checking for missing value:=====
2024-12-02 20:34:55,898 - INFO - No missing values detected.
2024-12-02 20:34:55,898 - INFO - =====Checking for duplicate rows:=====
2024-12-02 20:34:55,920 - INFO - No duplicate rows detected.
2024-12-02 20:34:55,936 - INFO -        record_number     region residence_type family_composition  sex  age  marital_status  ...  ethnic_group  religion  economic_activity  occupation  industry hours_worked_per_week approximate_social_grade
20                21  S92000003              P                  5    2    2               1  ...             1         2                  6           X         X                     X                        2
47                48  S92000003              P                  0    1    2               1  ...             1         1                  6           X         X                     X                        2
48                49  S92000003              P                  0    1    3               2  ...             4         2                  6           2         8                     X                        2
85                86  S92000003              P                  1    1    2               1  ...             1         2                  6           X         X                     X                        1
88                89  S92000003              P                  1    1    3               2  ...             1         2                  6           2        10                     X                        2
...              ...        ...            ...                ...  ...  ...             ...  ...           ...       ...                ...         ...       ...                   ...                      ...
63295          63296  S92000003              P                  1    1    2               1  ...             1         2                  6           7         4                     X                        2
63317          63318  S92000003              P                  0    2    2               1  ...             3         1                  6           X         X                     X                        2
63350          63351  S92000003              P                  1    1    2               1  ...             1         1                  6           X         X                     X                        4
63366          63367  S92000003              P                  4    2    2               1  ...             1         1                  6           X         X                     X                        2
63383          63384  S92000003              P                  1    1    2               1  ...             1         2                  6           X         X                     X                        3

[2598 rows x 17 columns]
2024-12-02 20:34:55,949 - INFO - Rule 1: Found 2598 rows to delete, saved to data/rule_1_deleted_data.csv
2024-12-02 20:34:55,956 - INFO - Rule 2: No rows to delete
2024-12-02 20:34:55,968 - INFO - Rule 3: Found 843 rows to delete, saved to data/rule_3_deleted_data.csv
2024-12-02 20:34:55,985 - INFO - Rule 4: Found 2362 rows to delete, saved to data/rule_4_deleted_data.csv
2024-12-02 20:34:55,991 - INFO - Rule 5: No rows to delete
2024-12-02 20:34:56,004 - INFO - Rule 6: Found 843 rows to delete, saved to data/rule_6_deleted_data.csv
2024-12-02 20:34:56,008 - INFO - =====validate_data_ranges:=====
2024-12-02 20:34:56,457 - INFO - 
Unique categories and counts per column:
2024-12-02 20:34:56,457 - INFO - residence_type: ['C', 'P'] (Total unique: 2)
2024-12-02 20:34:56,457 - INFO - family_composition: ['5', '0', '3', '1', 'X', '2', '4'] (Total unique: 7)
2024-12-02 20:34:56,457 - INFO - sex: [1, 2] (Total unique: 2)
2024-12-02 20:34:56,457 - INFO - age: [1, 2, 3, 4, 5, 6, 7, 8] (Total unique: 8)
2024-12-02 20:34:56,457 - INFO - marital_status: [1, 2, 3, 4, 5] (Total unique: 5)
2024-12-02 20:34:56,458 - INFO - student: [1, 2] (Total unique: 2)
2024-12-02 20:34:56,458 - INFO - country_of_birth: [1, 2] (Total unique: 2)
2024-12-02 20:34:56,458 - INFO - health: [1, 2, 3, 4, 5] (Total unique: 5)
2024-12-02 20:34:56,458 - INFO - ethnic_group: [1, 2, 3, 4, 5, 6] (Total unique: 6)
2024-12-02 20:34:56,458 - INFO - religion: [1, 2, 3, 4, 5, 6, 7, 8, 9] (Total unique: 9)
2024-12-02 20:34:56,458 - INFO - economic_activity: ['5', '7', '3', '1', '8', '9', 'X', '6', '2', '4'] (Total unique: 10)
2024-12-02 20:34:56,458 - INFO - occupation: ['5', '7', '3', '1', '8', '9', 'X', '6', '2', '4'] (Total unique: 10)
2024-12-02 20:34:56,458 - INFO - industry: ['10', '5', '7', '3', '1', '8', '11', '9', 'X', '6', '13', '12', '2', '4'] (Total unique: 14)
2024-12-02 20:34:56,458 - INFO - hours_worked_per_week: ['3', '1', 'X', '2', '4'] (Total unique: 5)
2024-12-02 20:34:56,458 - INFO - approximate_social_grade: ['3', '1', 'X', '2', '4'] (Total unique: 5)
2024-12-02 20:34:56,458 - INFO - 
All data ranges validated.
2024-12-02 20:34:56,458 - INFO - =====Verifying 'record_number' uniqueness:=====
2024-12-02 20:34:56,458 - INFO - Columns in batch: ['record_number', 'region', 'residence_type', 'family_composition', 'sex', 'age', 'marital_status', 'student', 'country_of_birth', 'health', 'ethnic_group', 'religion', 'economic_activity', 'occupation', 'industry', 'hours_worked_per_week', 'approximate_social_grade']
2024-12-02 20:34:56,460 - INFO - Record_Number is unique.
2024-12-02 20:34:56,471 - INFO - 'record_number' column reset.
2024-12-02 20:34:56,644 - INFO - Batch 1 cleaned and saved.
2024-12-02 20:34:56,647 - INFO - Progress saved to /cs/home/sz92/Documents/CS5002/P3/code/progress.json.
2024-12-02 20:34:56,647 - INFO - Data cleaning process completed. Total rows processed: 63388
2024-12-02 20:34:56,648 - INFO - Rows to drop: 5297
2024-12-02 20:34:56,648 - INFO - Cleaned data saved to ../data/output.csv
2024-12-02 20:34:56,648 - INFO - Progress file removed. Data processing complete.
2024-12-02 20:34:57,213 - INFO - Data clean code test passed. Congratulations! Result deatils in log/data_cleaning.log
